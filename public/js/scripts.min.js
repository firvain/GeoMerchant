var bing=new ol.layer.Tile({visible:!0,source:new ol.source.BingMaps({key:"Ak2Gq8VUfICsPpuf7LRANXmXt2sHWmSLPhohmVLFtFIEwYjs_5MCyAhAFwRSVpLj",imagerySet:"Aerial"}),maxZoom:19,crossOrigin:"anonymous",preload:1/0,nameEl:"Δορυφορική εικόνα",nameEn:"Satellite Image",id:"bing"}),mapbox=new ol.layer.Tile({source:new ol.source.XYZ({attributions:new ol.Attribution({html:'<a href="https://www.mapbox.com/about/maps/" target="_blank">&copy; Mapbox &copy; OpenStreetMap</a>'}),url:"https://api.mapbox.com/v4/mapbox.streets/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiZmlydmFpbiIsImEiOiJlOWYyYTM0NThiNWM0YjJjODJjNDE4ODQzNzA2MGQyNiJ9.-NVDO27Hzt-w_nQosUPfLA"})}),map=new ol.Map({target:"map",layers:[mapbox],loadTilesWhileAnimating:!0,loadTilesWhileInteracting:!0,renderer:"canvas",controls:ol.control.defaults({attributionOptions:{collapsible:!1,collapsed:!1}}).extend([new ol.control.ScaleLine({units:"metric"}),new ol.control.OverviewMap({className:"ol-overviewmap ol-custom-overviewmap",collapsible:!0,collapsed:!0,layers:[new ol.layer.Tile({source:new ol.source.OSM,visible:!0,preload:1/0,crossOrigin:"anonymous",nameEl:"Μικρός Χάρτης",nameEn:"MiniMap",id:"overviewOsm"})]})]),view:new ol.View({center:[3713616,4181258],extent:[3590094,4102833,3855483,4261211],projection:"EPSG:3857",zoom:14,maxZoom:19,minZoom:10})});
!function(){var e=new ol.Geolocation({projection:map.getView().getProjection(),trackingOptions:{maximumAge:1e4,enableHighAccuracy:!0,timeout:6e5}}),o=new ol.Feature;e.on("change:accuracyGeometry",function(){o.setGeometry(e.getAccuracyGeometry())});var t=new ol.Feature;t.setStyle(new ol.style.Style({image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:"#3399CC"}),stroke:new ol.style.Stroke({color:"#fff",width:2})})})),e.on("change:position",function(){var o=e.getPosition();t.setGeometry(o?new ol.geom.Point(o):null)}),featuresOverlaySource=new ol.source.Vector({});new ol.layer.Vector({map:map,source:featuresOverlaySource});$(".geolocation").on("change",function(r){r.preventDefault(),$(this).prop("checked")===!0?(e.setTracking(!0),featuresOverlaySource.addFeatures([t,o])):(e.setTracking(!1),featuresOverlaySource.clear())})}();
!function(){function e(e){e.preventDefault();var n=e.coordinate;o.innerHTML="<p>You clicked here:</p><code>"+n+"</code>",c.setPosition(n)}var n=document.getElementById("popup"),o=document.getElementById("popup-content"),t=document.getElementById("popup-closer");t.onclick=function(){return c.setPosition(void 0),t.blur(),!1};var c=new ol.Overlay({element:n,autoPan:!0,autoPanAnimation:{duration:250}});map.addOverlay(c),$(".info").on("change",function(n){n.preventDefault(),$(this).prop("checked")===!0?map.on("singleclick",e):map.un("singleclick",e)})}();
!function(){function e(e){e.preventDefault();var r=n.getSource().getFeatures().length,a=e.coordinate;if(0===r)t.setGeometry(new ol.geom.Point(a)),t.setId("first"),n.getSource().addFeature(t),c[0]=a[0],c[1]=a[1];else if(1===r){var i=t.clone();i.setGeometry(new ol.geom.Point(a)),i.setId("second"),n.getSource().addFeature(i),c[2]=a[0],c[3]=a[1],o(c)}else n.getSource().clear()}function o(e){var o=ol.proj.transform([e[0],e[1]],"EPSG:3857","EPSG:4326"),t=ol.proj.transform([e[2],e[3]],"EPSG:3857","EPSG:4326"),r=o[0],a=o[1],c=t[0],i=t[1];$.ajax({url:"https://api.mapbox.com/v4/directions/mapbox.driving/"+r+","+a+";"+c+","+i+".json?alternatives=false&access_token=pk.eyJ1IjoiZmlydmFpbiIsImEiOiJlOWYyYTM0NThiNWM0YjJjODJjNDE4ODQzNzA2MGQyNiJ9.-NVDO27Hzt-w_nQosUPfLA",type:"GET",dataType:"json"}).done(function(e){var o={};o.type="Feature",o.geometry=e.routes[0].geometry,n.getSource().addFeatures(geoJSONFormat.readFeatures(o,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})),map.getView().fit(n.getSource().getExtent(),map.getSize())}).fail(function(){console.log("error")}).always(function(){console.log("complete")})}var t=new ol.Feature,r=new ol.style.Style({image:new ol.style.Icon({anchor:[.5,1],anchorXUnits:"fraction",anchorYUnits:"fraction",opacity:1,scale:1,src:"../images/map-icons/pins/24/pin1.png",snapToPixel:!1}),zIndex:100});t.setStyle(r);var a=new ol.style.Style({stroke:new ol.style.Stroke({color:"#408080",width:5,lineDash:[4,4]})}),n=new ol.layer.Vector({map:map,source:new ol.source.Vector,style:a,id:"route",nameEl:"Διαδρομή",NameEn:"Route"}),c=[];geoJSONFormat=new ol.format.GeoJSON({defaultDataProjection:"EPSG:4326",geometryName:"geometry"}),$(".marker").on("change",function(o){o.preventDefault(),$(this).prop("checked")===!0?map.on("singleclick",e):(map.un("singleclick",e),n.getSource().clear())})}();
!function(){$(".weather").change(function(){if($(this).prop("checked")===!0){map.getOverlays().forEach(function(e){"weather"===e.get("name")&&($(e.getElement()).parent().remove(),$(e.getElement()).remove())});var e=ol.proj.transform(map.getView().getCenter(),"EPSG:3857","EPSG:4326"),t=e[1],a=e[0];$.ajax({url:"http://api.openweathermap.org/data/2.5/find?lat="+t+"&lon="+a+"&cnt=5&cluster=no&units=metric&type=accurate&APPID=f9cd9fa2c427c3b115e87e4862619c5c",type:"GET",dataType:"json"}).done(function(e){function t(e,t){var a=document.createElement("div");return a.setAttribute("class","weather-popup default-primary-color  paper-shadow-bottom-z-4"),a.setAttribute("id",t),a.setAttribute("data-name","weather"),new ol.Overlay({element:a,position:e})}var a,r,n=e.list;$.each(n,function(e,n){r=ol.proj.transform([n.coord.lon,n.coord.lat],"EPSG:4326","EPSG:3857"),a=t(r,e),map.addOverlay(a),a.set("name","weather"),weatherData={name:n.name,temp:n.main.temp,pressure:n.main.pressure,humidity:n.main.humidity},dust.render("weatherPopup.dust",weatherData,function(t,a){$("#"+e).html(a)})})}).fail(function(){})}else $(this).prop("checked")===!1&&map.getOverlays().forEach(function(e){"weather"===e.get("name")&&($(e.getElement()).parent().remove(),$(e.getElement()).remove())})})}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hcC5qcyIsImdlb2xvY2F0aW9uLmpzIiwiaW5mby5qcyIsInJvdXRpbmcuanMiLCJ3ZWF0aGVyLmpzIl0sIm5hbWVzIjpbImJpbmciLCJvbCIsImxheWVyIiwiVGlsZSIsInZpc2libGUiLCJzb3VyY2UiLCJCaW5nTWFwcyIsImtleSIsImltYWdlcnlTZXQiLCJtYXhab29tIiwiY3Jvc3NPcmlnaW4iLCJwcmVsb2FkIiwiSW5maW5pdHkiLCJuYW1lRWwiLCJuYW1lRW4iLCJpZCIsIm1hcGJveCIsIlhZWiIsImF0dHJpYnV0aW9ucyIsIkF0dHJpYnV0aW9uIiwiaHRtbCIsInVybCIsIm1hcCIsIk1hcCIsInRhcmdldCIsImxheWVycyIsImxvYWRUaWxlc1doaWxlQW5pbWF0aW5nIiwibG9hZFRpbGVzV2hpbGVJbnRlcmFjdGluZyIsInJlbmRlcmVyIiwiY29udHJvbHMiLCJjb250cm9sIiwiZGVmYXVsdHMiLCJhdHRyaWJ1dGlvbk9wdGlvbnMiLCJjb2xsYXBzaWJsZSIsImNvbGxhcHNlZCIsImV4dGVuZCIsIlNjYWxlTGluZSIsInVuaXRzIiwiT3ZlcnZpZXdNYXAiLCJjbGFzc05hbWUiLCJPU00iLCJ2aWV3IiwiVmlldyIsImNlbnRlciIsImV4dGVudCIsInByb2plY3Rpb24iLCJ6b29tIiwibWluWm9vbSIsImdlb2xvY2F0aW9uIiwiR2VvbG9jYXRpb24iLCJnZXRWaWV3IiwiZ2V0UHJvamVjdGlvbiIsInRyYWNraW5nT3B0aW9ucyIsIm1heGltdW1BZ2UiLCJlbmFibGVIaWdoQWNjdXJhY3kiLCJ0aW1lb3V0IiwiYWNjdXJhY3lGZWF0dXJlIiwiRmVhdHVyZSIsIm9uIiwic2V0R2VvbWV0cnkiLCJnZXRBY2N1cmFjeUdlb21ldHJ5IiwicG9zaXRpb25GZWF0dXJlIiwic2V0U3R5bGUiLCJzdHlsZSIsIlN0eWxlIiwiaW1hZ2UiLCJDaXJjbGUiLCJyYWRpdXMiLCJmaWxsIiwiRmlsbCIsImNvbG9yIiwic3Ryb2tlIiwiU3Ryb2tlIiwid2lkdGgiLCJjb29yZGluYXRlcyIsImdldFBvc2l0aW9uIiwiZ2VvbSIsIlBvaW50IiwiZmVhdHVyZXNPdmVybGF5U291cmNlIiwiVmVjdG9yIiwiJCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInRoaXMiLCJwcm9wIiwic2V0VHJhY2tpbmciLCJhZGRGZWF0dXJlcyIsImNsZWFyIiwiaGFuZGxlSW5mbyIsImV2dCIsImNvb3JkaW5hdGUiLCJjb250ZW50IiwiaW5uZXJIVE1MIiwiaW5mbyIsInNldFBvc2l0aW9uIiwiY29udGFpbmVyIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNsb3NlciIsIm9uY2xpY2siLCJ1bmRlZmluZWQiLCJibHVyIiwiT3ZlcmxheSIsImVsZW1lbnQiLCJhdXRvUGFuIiwiYXV0b1BhbkFuaW1hdGlvbiIsImR1cmF0aW9uIiwiYWRkT3ZlcmxheSIsInVuIiwiaGFuZGxlTWFya2VyIiwiZXZlbnQiLCJmZWF0dXJlQ291bnQiLCJmZWF0dXJlc092ZXJsYXkiLCJnZXRTb3VyY2UiLCJnZXRGZWF0dXJlcyIsImxlbmd0aCIsIm1hcmtlciIsInNldElkIiwiYWRkRmVhdHVyZSIsInJvdXRlQ29vcmRzIiwiY2xvbmUiLCJjYWxsUm91dGUiLCJmaXJzdCIsInByb2oiLCJ0cmFuc2Zvcm0iLCJzZWNvbmQiLCJ4MSIsInkxIiwieDIiLCJ5MiIsImFqYXgiLCJ0eXBlIiwiZGF0YVR5cGUiLCJkb25lIiwiZGF0YSIsInJvdXRlIiwiZ2VvbWV0cnkiLCJyb3V0ZXMiLCJnZW9KU09ORm9ybWF0IiwicmVhZEZlYXR1cmVzIiwiZGF0YVByb2plY3Rpb24iLCJmZWF0dXJlUHJvamVjdGlvbiIsImZpdCIsImdldEV4dGVudCIsImdldFNpemUiLCJmYWlsIiwiY29uc29sZSIsImxvZyIsImFsd2F5cyIsImljb25TdHlsZSIsIkljb24iLCJhbmNob3IiLCJhbmNob3JYVW5pdHMiLCJhbmNob3JZVW5pdHMiLCJvcGFjaXR5Iiwic2NhbGUiLCJzcmMiLCJzbmFwVG9QaXhlbCIsInpJbmRleCIsImZlYXR1cmVzT3ZlcmxheVN0eWxlIiwibGluZURhc2giLCJOYW1lRW4iLCJmb3JtYXQiLCJHZW9KU09OIiwiZGVmYXVsdERhdGFQcm9qZWN0aW9uIiwiZ2VvbWV0cnlOYW1lIiwiY2hhbmdlIiwiZ2V0T3ZlcmxheXMiLCJmb3JFYWNoIiwib3ZsIiwiZ2V0IiwiZ2V0RWxlbWVudCIsInBhcmVudCIsInJlbW92ZSIsImdldENlbnRlciIsImxhdCIsImxvbiIsImNyZWF0ZVdlYXRoZXJPdmVybGF5IiwicG9zaXRpb24iLCJpbmRleCIsImVsZW0iLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwib3ZlcmxheSIsIm9ianMiLCJsaXN0IiwiZWFjaCIsInZhbCIsImNvb3JkIiwic2V0Iiwid2VhdGhlckRhdGEiLCJuYW1lIiwidGVtcCIsIm1haW4iLCJwcmVzc3VyZSIsImh1bWlkaXR5IiwiZHVzdCIsInJlbmRlciIsImVyciIsIm91dCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBSUEsTUFBTyxHQUFJQyxJQUFHQyxNQUFNQyxNQUN0QkMsU0FBUyxFQUNUQyxPQUFRLEdBQUlKLElBQUdJLE9BQU9DLFVBQ3BCQyxJQUFLLG1FQUNMQyxXQUFZLFdBRWRDLFFBQVMsR0FDVEMsWUFBYSxZQUNiQyxRQUFTQyxFQUFBQSxFQUNUQyxPQUFRLG9CQUNSQyxPQUFRLGtCQUNSQyxHQUFJLFNBRUZDLE9BQVMsR0FBSWYsSUFBR0MsTUFBTUMsTUFDeEJFLE9BQVEsR0FBSUosSUFBR0ksT0FBT1ksS0FDcEJDLGFBQWMsR0FBSWpCLElBQUdrQixhQUNuQkMsS0FBTSx3R0FFUkMsSUFBSywrS0FHTEMsSUFBTSxHQUFJckIsSUFBR3NCLEtBQ2ZDLE9BQVEsTUFDUkMsUUFBU1QsUUFDVFUseUJBQXlCLEVBQ3pCQywyQkFBMkIsRUFDM0JDLFNBQVUsU0FDVkMsU0FBVTVCLEdBQUc2QixRQUFRQyxVQUNuQkMsb0JBQ0VDLGFBQWEsRUFDYkMsV0FBVyxLQUVaQyxRQUNELEdBQUlsQyxJQUFHNkIsUUFBUU0sV0FDYkMsTUFBTyxXQUNMLEdBQUlw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Q2hGN0MsS0FBTSxNQUNOQyxTQUFVLFNBQ1RDLEtBQUssU0FBU0MsR0FDZixRQUFTMkMsR0FBcUJDLEVBQVVDLEdBQ3RDLEdBQUlDLEdBQU9wRixTQUFTcUYsY0FBYyxNQUlsQyxPQUhBRCxHQUFLRSxhQUFhLFFBQVMsZ0VBQzNCRixFQUFLRSxhQUFhLEtBQU1ILEdBQ3hCQyxFQUFLRSxhQUFhLFlBQWEsV0FDeEIsR0FBSXJMLElBQUdxRyxTQUNaQyxRQUFTNkUsRUFDVEYsU0FBVUEsSUFHZCxHQUNJSyxHQUFTN0csRUFEVDhHLEVBQU9sRCxFQUFLbUQsSUFFaEJ6RyxHQUFFMEcsS0FBS0YsRUFBTSxTQUFTTCxFQUFPUSxHQUMzQmpILEVBQWN6RSxHQUFHMEgsS0FBS0MsV0FBVytELEVBQUlDLE1BQU1aLElBQUtXLEVBQUlDLE1BQU1iLEtBQU0sWUFBYSxhQUM3RVEsRUFBVU4sRUFBcUJ2RyxFQUFheUcsR0FDNUM3SixJQUFJcUYsV0FBVzRFLEdBQ2ZBLEVBQVFNLElBQUksT0FBUSxXQUNwQkMsYUFDRUMsS0FBUUosRUFBSUksS0FDWkMsS0FBUUwsRUFBSU0sS0FBS0QsS0FDakJFLFNBQVlQLEVBQUlNLEtBQUtDLFNBQ3JCQyxTQUFZUixFQUFJTSxLQUFLRSxVQUV2QkMsS0FBS0MsT0FBTyxvQkFBcUJQLFlBQWEsU0FBU1EsRUFBS0MsR0FDMUR2SCxFQUFFLElBQU1tRyxHQUFPL0osS0FBS21MLFNBR3ZCdEQsS0FBSyxrQkFHQ2pFLEdBQUVHLE1BQU1DLEtBQUssY0FBZSxHQUNyQzlELElBQUlpSixjQUFjQyxRQUFRLFNBQVNDLEdBQ1QsWUFBcEJBLEVBQUlDLElBQUksVUFDVDFGLEVBQUV5RixFQUFJRSxjQUFjQyxTQUFVQyxTQUMvQjdGLEVBQUV5RixFQUFJRSxjQUFjRSIsImZpbGUiOiJzY3JpcHRzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBiaW5nID0gbmV3IG9sLmxheWVyLlRpbGUoe1xyXG4gIHZpc2libGU6IHRydWUsXHJcbiAgc291cmNlOiBuZXcgb2wuc291cmNlLkJpbmdNYXBzKHtcclxuICAgIGtleTogJ0FrMkdxOFZVZklDc1BwdWY3TFJBTlhtWHQyc0hXbVNMUGhvaG1WTEZ0RklFd1lqc181TUN5QWhBRndSU1ZwTGonLFxyXG4gICAgaW1hZ2VyeVNldDogJ0FlcmlhbCdcclxuICB9KSxcclxuICBtYXhab29tOiAxOSxcclxuICBjcm9zc09yaWdpbjogJ2Fub255bW91cycsXHJcbiAgcHJlbG9hZDogSW5maW5pdHksXHJcbiAgbmFtZUVsOiAnzpTOv8+Bz4XPhs6/z4HOuc66zq4gzrXOuc66z4zOvc6xJyxcclxuICBuYW1lRW46ICdTYXRlbGxpdGUgSW1hZ2UnLFxyXG4gIGlkOiAnYmluZydcclxufSk7XHJcbnZhciBtYXBib3ggPSBuZXcgb2wubGF5ZXIuVGlsZSh7XHJcbiAgc291cmNlOiBuZXcgb2wuc291cmNlLlhZWih7XHJcbiAgICBhdHRyaWJ1dGlvbnM6IG5ldyBvbC5BdHRyaWJ1dGlvbih7XHJcbiAgICAgIGh0bWw6ICc8YSBocmVmPVxcXCJodHRwczovL3d3dy5tYXBib3guY29tL2Fib3V0L21hcHMvXFxcIiB0YXJnZXQ9XFxcIl9ibGFua1xcXCI+JmNvcHk7IE1hcGJveCAmY29weTsgT3BlblN0cmVldE1hcDwvYT4nXHJcbiAgICB9KSxcclxuICAgIHVybDogJ2h0dHBzOi8vYXBpLm1hcGJveC5jb20vdjQvbWFwYm94LnN0cmVldHMve3p9L3t4fS97eX0ucG5nP2FjY2Vzc190b2tlbj1way5leUoxSWpvaVptbHlkbUZwYmlJc0ltRWlPaUpsT1dZeVlUTTBOVGhpTldNMFlqSmpPREpqTkRFNE9EUXpOekEyTUdReU5pSjkuLU5WRE8yN0h6dC13X25Rb3NVUGZMQSdcclxuICB9KVxyXG59KTtcclxudmFyIG1hcCA9IG5ldyBvbC5NYXAoe1xyXG4gIHRhcmdldDogJ21hcCcsXHJcbiAgbGF5ZXJzOiBbbWFwYm94XSxcclxuICBsb2FkVGlsZXNXaGlsZUFuaW1hdGluZzogdHJ1ZSxcclxuICBsb2FkVGlsZXNXaGlsZUludGVyYWN0aW5nOiB0cnVlLFxyXG4gIHJlbmRlcmVyOiAnY2FudmFzJyxcclxuICBjb250cm9sczogb2wuY29udHJvbC5kZWZhdWx0cyh7XHJcbiAgICBhdHRyaWJ1dGlvbk9wdGlvbnM6IHtcclxuICAgICAgY29sbGFwc2libGU6IGZhbHNlLFxyXG4gICAgICBjb2xsYXBzZWQ6IGZhbHNlXHJcbiAgICB9XHJcbiAgfSkuZXh0ZW5kKFtcclxuICAgIG5ldyBvbC5jb250cm9sLlNjYWxlTGluZSh7XHJcbiAgICAgIHVuaXRzOiAnbWV0cmljJ1xyXG4gICAgfSksIG5ldyBvbC5jb250cm9sLk92ZXJ2aWV3TWFwKHtcclxuICAgICAgY2xhc3NOYW1lOiAnb2wtb3ZlcnZpZXdtYXAgb2wtY3VzdG9tLW92ZXJ2aWV3bWFwJyxcclxuICAgICAgY29sbGFwc2libGU6IHRydWUsXHJcbiAgICAgIGNvbGxhcHNlZDogdHJ1ZSxcclxuICAgICAgbGF5ZXJzOiBbbmV3IG9sLmxheWVyLlRpbGUoe1xyXG4gICAgICAgIHNvdXJjZTogbmV3IG9sLnNvdXJjZS5PU00oKSxcclxuICAgICAgICB2aXNpYmxlOiB0cnVlLFxyXG4gICAgICAgIHByZWxvYWQ6IEluZmluaXR5LFxyXG4gICAgICAgIGNyb3NzT3JpZ2luOiAnYW5vbnltb3VzJyxcclxuICAgICAgICBuYW1lRWw6ICfOnM65zrrPgc+Mz4IgzqfOrM+Bz4TOt8+CJyxcclxuICAgICAgICBuYW1lRW46ICdNaW5pTWFwJyxcclxuICAgICAgICBpZDogJ292ZXJ2aWV3T3NtJ1xyXG4gICAgICB9KV1cclxuICAgIH0pXHJcbiAgXSksXHJcbiAgdmlldzogbmV3IG9sLlZpZXcoe1xyXG4gICAgY2VudGVyOiBbMzcxMzYxNiwgNDE4MTI1OF0sXHJcbiAgICBleHRlbnQgOiBbMzU5MDA5NCw0MTAyODMzLDM4NTU0ODMsNDI2MTIxMV0sXHJcbiAgICBwcm9qZWN0aW9uOiAnRVBTRzozODU3JyxcclxuICAgIHpvb206IDE0LFxyXG4gICAgbWF4Wm9vbTogMTksXHJcbiAgICBtaW5ab29tOiAxMFxyXG4gIH0pLFxyXG59KTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gIHZhciBnZW9sb2NhdGlvbiA9IG5ldyBvbC5HZW9sb2NhdGlvbih7XHJcbiAgICAvLyB0YWtlIHRoZSBwcm9qZWN0aW9uIHRvIHVzZSBmcm9tIHRoZSBtYXAncyB2aWV3XHJcbiAgICBwcm9qZWN0aW9uOiBtYXAuZ2V0VmlldygpLmdldFByb2plY3Rpb24oKSxcclxuICAgIHRyYWNraW5nT3B0aW9uczoge1xyXG4gICAgICBtYXhpbXVtQWdlOiAxMDAwMCxcclxuICAgICAgZW5hYmxlSGlnaEFjY3VyYWN5OiB0cnVlLFxyXG4gICAgICB0aW1lb3V0OiA2MDAwMDBcclxuICAgIH1cclxuICB9KTtcclxuICB2YXIgYWNjdXJhY3lGZWF0dXJlID0gbmV3IG9sLkZlYXR1cmUoKTtcclxuICBnZW9sb2NhdGlvbi5vbignY2hhbmdlOmFjY3VyYWN5R2VvbWV0cnknLCBmdW5jdGlvbigpIHtcclxuICAgIGFjY3VyYWN5RmVhdHVyZS5zZXRHZW9tZXRyeShnZW9sb2NhdGlvbi5nZXRBY2N1cmFjeUdlb21ldHJ5KCkpO1xyXG4gIH0pO1xyXG4gIHZhciBwb3NpdGlvbkZlYXR1cmUgPSBuZXcgb2wuRmVhdHVyZSgpO1xyXG4gIHBvc2l0aW9uRmVhdHVyZS5zZXRTdHlsZShuZXcgb2wuc3R5bGUuU3R5bGUoe1xyXG4gICAgaW1hZ2U6IG5ldyBvbC5zdHlsZS5DaXJjbGUoe1xyXG4gICAgICByYWRpdXM6IDYsXHJcbiAgICAgIGZpbGw6IG5ldyBvbC5zdHlsZS5GaWxsKHtcclxuICAgICAgICBjb2xvcjogJyMzMzk5Q0MnXHJcbiAgICAgIH0pLFxyXG4gICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgIGNvbG9yOiAnI2ZmZicsXHJcbiAgICAgICAgd2lkdGg6IDJcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgfSkpO1xyXG4gIC8vIGxpc3RlbiB0byBjaGFuZ2VzIGluIHBvc2l0aW9uXHJcbiAgZ2VvbG9jYXRpb24ub24oJ2NoYW5nZTpwb3NpdGlvbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGNvb3JkaW5hdGVzID0gZ2VvbG9jYXRpb24uZ2V0UG9zaXRpb24oKTtcclxuICAgIHBvc2l0aW9uRmVhdHVyZS5zZXRHZW9tZXRyeShjb29yZGluYXRlcyA/IG5ldyBvbC5nZW9tLlBvaW50KGNvb3JkaW5hdGVzKSA6IG51bGwpO1xyXG4gIH0pO1xyXG4gIGZlYXR1cmVzT3ZlcmxheVNvdXJjZSA9IG5ldyBvbC5zb3VyY2UuVmVjdG9yKHt9KTtcclxuICB2YXIgZmVhdHVyZXNPdmVybGF5ID0gbmV3IG9sLmxheWVyLlZlY3Rvcih7XHJcbiAgICBtYXA6IG1hcCxcclxuICAgIHNvdXJjZTogZmVhdHVyZXNPdmVybGF5U291cmNlXHJcbiAgfSk7XHJcbiAgJCgnLmdlb2xvY2F0aW9uJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKGUpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGlmICgkKHRoaXMpLnByb3AoJ2NoZWNrZWQnKSA9PT0gdHJ1ZSkge1xyXG4gICAgICBnZW9sb2NhdGlvbi5zZXRUcmFja2luZyh0cnVlKTtcclxuICAgICAgZmVhdHVyZXNPdmVybGF5U291cmNlLmFkZEZlYXR1cmVzKFtwb3NpdGlvbkZlYXR1cmUsYWNjdXJhY3lGZWF0dXJlXSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBnZW9sb2NhdGlvbi5zZXRUcmFja2luZyhmYWxzZSk7XHJcbiAgICAgIGZlYXR1cmVzT3ZlcmxheVNvdXJjZS5jbGVhcigpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59KCkpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgdmFyIGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cCcpO1xyXG4gIHZhciBjb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwLWNvbnRlbnQnKTtcclxuICB2YXIgY2xvc2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwLWNsb3NlcicpO1xyXG4gIGNsb3Nlci5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XHJcbiAgICBpbmZvLnNldFBvc2l0aW9uKHVuZGVmaW5lZCk7XHJcbiAgICBjbG9zZXIuYmx1cigpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH07XHJcbiAgdmFyIGluZm8gPSBuZXcgb2wuT3ZlcmxheSggLyoqIEB0eXBlIHtvbHguT3ZlcmxheU9wdGlvbnN9ICovICh7XHJcbiAgICBlbGVtZW50OiBjb250YWluZXIsXHJcbiAgICBhdXRvUGFuOiB0cnVlLFxyXG4gICAgYXV0b1BhbkFuaW1hdGlvbjoge1xyXG4gICAgICBkdXJhdGlvbjogMjUwXHJcbiAgICB9XHJcbiAgfSkpO1xyXG4gIG1hcC5hZGRPdmVybGF5KGluZm8pO1xyXG5cclxuICBmdW5jdGlvbiBoYW5kbGVJbmZvKGV2dCkge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB2YXIgY29vcmRpbmF0ZSA9IGV2dC5jb29yZGluYXRlO1xyXG4gICAgY29udGVudC5pbm5lckhUTUwgPSAnPHA+WW91IGNsaWNrZWQgaGVyZTo8L3A+PGNvZGU+JyArIGNvb3JkaW5hdGUgKyAnPC9jb2RlPic7XHJcbiAgICBpbmZvLnNldFBvc2l0aW9uKGNvb3JkaW5hdGUpO1xyXG4gIH1cclxuICAkKCcuaW5mbycpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbihlKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBpZiAoJCh0aGlzKS5wcm9wKCdjaGVja2VkJykgPT09IHRydWUpIHtcclxuICAgICAgbWFwLm9uKCdzaW5nbGVjbGljaycsIGhhbmRsZUluZm8pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbWFwLnVuKCdzaW5nbGVjbGljaycsIGhhbmRsZUluZm8pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59KCkpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgdmFyIG1hcmtlciA9IG5ldyBvbC5GZWF0dXJlKCk7XHJcbiAgdmFyIGljb25TdHlsZSA9IG5ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICBpbWFnZTogbmV3IG9sLnN0eWxlLkljb24oIC8qKiBAdHlwZSB7b2x4LnN0eWxlLkljb25PcHRpb25zfSAqLyAoe1xyXG4gICAgICBhbmNob3I6IFswLjUsIDFdLFxyXG4gICAgICBhbmNob3JYVW5pdHM6ICdmcmFjdGlvbicsXHJcbiAgICAgIGFuY2hvcllVbml0czogJ2ZyYWN0aW9uJyxcclxuICAgICAgb3BhY2l0eTogMSxcclxuICAgICAgc2NhbGU6IDEsXHJcbiAgICAgIHNyYzogJy4uL2ltYWdlcy9tYXAtaWNvbnMvcGlucy8yNC9waW4xLnBuZycsXHJcbiAgICAgIHNuYXBUb1BpeGVsOiBmYWxzZVxyXG4gICAgfSkpLFxyXG4gICAgekluZGV4OiAxMDBcclxuICB9KTtcclxuICBtYXJrZXIuc2V0U3R5bGUoaWNvblN0eWxlKTtcclxuICB2YXIgZmVhdHVyZXNPdmVybGF5U3R5bGUgPSBuZXcgb2wuc3R5bGUuU3R5bGUoe1xyXG4gICAgc3Ryb2tlOiBuZXcgb2wuc3R5bGUuU3Ryb2tlKHtcclxuICAgICAgY29sb3I6ICcjNDA4MDgwJyxcclxuICAgICAgd2lkdGg6IDUsXHJcbiAgICAgIGxpbmVEYXNoOiBbNCwgNF1cclxuICAgIH0pXHJcbiAgfSk7XHJcbiAgdmFyIGZlYXR1cmVzT3ZlcmxheSA9IG5ldyBvbC5sYXllci5WZWN0b3Ioe1xyXG4gICAgbWFwOiBtYXAsXHJcbiAgICBzb3VyY2U6IG5ldyBvbC5zb3VyY2UuVmVjdG9yKCksXHJcbiAgICBzdHlsZTogZmVhdHVyZXNPdmVybGF5U3R5bGUsXHJcbiAgICBpZDogJ3JvdXRlJyxcclxuICAgIG5hbWVFbDogJ86UzrnOsc60z4HOv868zq4nLFxyXG4gICAgTmFtZUVuOiAnUm91dGUnXHJcbiAgfSk7XHJcbiAgdmFyIHJvdXRlQ29vcmRzID0gW107XHJcblxyXG4gIGZ1bmN0aW9uIGhhbmRsZU1hcmtlcihldmVudCkge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIHZhciBmZWF0dXJlQ291bnQgPSBmZWF0dXJlc092ZXJsYXkuZ2V0U291cmNlKCkuZ2V0RmVhdHVyZXMoKS5sZW5ndGg7XHJcbiAgICB2YXIgY29vcmRpbmF0ZXMgPSBldmVudC5jb29yZGluYXRlO1xyXG4gICAgaWYgKGZlYXR1cmVDb3VudCA9PT0gMCkge1xyXG4gICAgICBtYXJrZXIuc2V0R2VvbWV0cnkobmV3IG9sLmdlb20uUG9pbnQoY29vcmRpbmF0ZXMpKTtcclxuICAgICAgbWFya2VyLnNldElkKCdmaXJzdCcpO1xyXG4gICAgICBmZWF0dXJlc092ZXJsYXkuZ2V0U291cmNlKCkuYWRkRmVhdHVyZShtYXJrZXIpO1xyXG4gICAgICByb3V0ZUNvb3Jkc1swXSA9IGNvb3JkaW5hdGVzWzBdO1xyXG4gICAgICByb3V0ZUNvb3Jkc1sxXSA9IGNvb3JkaW5hdGVzWzFdO1xyXG4gICAgfSBlbHNlIGlmIChmZWF0dXJlQ291bnQgPT09IDEpIHtcclxuICAgICAgdmFyIGNsb25lID0gbWFya2VyLmNsb25lKCk7XHJcbiAgICAgIGNsb25lLnNldEdlb21ldHJ5KG5ldyBvbC5nZW9tLlBvaW50KGNvb3JkaW5hdGVzKSk7XHJcbiAgICAgIGNsb25lLnNldElkKCdzZWNvbmQnKTtcclxuICAgICAgZmVhdHVyZXNPdmVybGF5LmdldFNvdXJjZSgpLmFkZEZlYXR1cmUoY2xvbmUpO1xyXG4gICAgICByb3V0ZUNvb3Jkc1syXSA9IGNvb3JkaW5hdGVzWzBdO1xyXG4gICAgICByb3V0ZUNvb3Jkc1szXSA9IGNvb3JkaW5hdGVzWzFdO1xyXG4gICAgICBjYWxsUm91dGUocm91dGVDb29yZHMpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZmVhdHVyZXNPdmVybGF5LmdldFNvdXJjZSgpLmNsZWFyKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZW9KU09ORm9ybWF0ID0gbmV3IG9sLmZvcm1hdC5HZW9KU09OKHtcclxuICAgIGRlZmF1bHREYXRhUHJvamVjdGlvbjogJ0VQU0c6NDMyNicsXHJcbiAgICBnZW9tZXRyeU5hbWU6ICdnZW9tZXRyeSdcclxuICB9KTtcclxuXHJcbiAgZnVuY3Rpb24gY2FsbFJvdXRlKHJvdXRlQ29vcmRzKSB7XHJcbiAgICB2YXIgZmlyc3QgPSBvbC5wcm9qLnRyYW5zZm9ybShbcm91dGVDb29yZHNbMF0sIHJvdXRlQ29vcmRzWzFdXSwgJ0VQU0c6Mzg1NycsICdFUFNHOjQzMjYnKTtcclxuICAgIHZhciBzZWNvbmQgPSBvbC5wcm9qLnRyYW5zZm9ybShbcm91dGVDb29yZHNbMl0sIHJvdXRlQ29vcmRzWzNdXSwgJ0VQU0c6Mzg1NycsICdFUFNHOjQzMjYnKTtcclxuICAgIHZhciB4MSA9IGZpcnN0WzBdO1xyXG4gICAgdmFyIHkxID0gZmlyc3RbMV07XHJcbiAgICB2YXIgeDIgPSBzZWNvbmRbMF07XHJcbiAgICB2YXIgeTIgPSBzZWNvbmRbMV07XHJcbiAgICAkLmFqYXgoe1xyXG4gICAgICB1cmw6ICdodHRwczovL2FwaS5tYXBib3guY29tL3Y0L2RpcmVjdGlvbnMvbWFwYm94LmRyaXZpbmcvJyArIHgxICsgJywnICsgeTEgKyAnOycgKyB4MiArICcsJyArIHkyICsgJy5qc29uP2FsdGVybmF0aXZlcz1mYWxzZSZhY2Nlc3NfdG9rZW49cGsuZXlKMUlqb2labWx5ZG1GcGJpSXNJbUVpT2lKbE9XWXlZVE0wTlRoaU5XTTBZakpqT0RKak5ERTRPRFF6TnpBMk1HUXlOaUo5Li1OVkRPMjdIenQtd19uUW9zVVBmTEEnLFxyXG4gICAgICB0eXBlOiAnR0VUJyxcclxuICAgICAgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgfSkuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgIHZhciByb3V0ZT17fTtcclxuICAgICAgcm91dGUudHlwZSA9XCJGZWF0dXJlXCI7XHJcbiAgICAgIHJvdXRlLmdlb21ldHJ5ID0gZGF0YS5yb3V0ZXNbMF0uZ2VvbWV0cnk7XHJcbiAgICAgIGZlYXR1cmVzT3ZlcmxheS5nZXRTb3VyY2UoKS5hZGRGZWF0dXJlcyhnZW9KU09ORm9ybWF0LnJlYWRGZWF0dXJlcyhyb3V0ZSwge1xyXG4gICAgICAgIGRhdGFQcm9qZWN0aW9uOiAnRVBTRzo0MzI2JyxcclxuICAgICAgICBmZWF0dXJlUHJvamVjdGlvbjogJ0VQU0c6Mzg1NydcclxuICAgICAgfSkpO1xyXG4gICAgICBtYXAuZ2V0VmlldygpLmZpdChmZWF0dXJlc092ZXJsYXkuZ2V0U291cmNlKCkuZ2V0RXh0ZW50KCksIG1hcC5nZXRTaXplKCkpO1xyXG4gICAgfSkuZmFpbChmdW5jdGlvbigpIHtcclxuICAgICAgY29uc29sZS5sb2coXCJlcnJvclwiKTtcclxuICAgIH0pLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuICAgICAgY29uc29sZS5sb2coXCJjb21wbGV0ZVwiKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAkKCcubWFya2VyJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgLyogQWN0IG9uIHRoZSBldmVudCAqL1xyXG4gICAgaWYgKCQodGhpcykucHJvcCgnY2hlY2tlZCcpID09PSB0cnVlKSB7XHJcbiAgICAgIG1hcC5vbignc2luZ2xlY2xpY2snLCBoYW5kbGVNYXJrZXIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbWFwLnVuKCdzaW5nbGVjbGljaycsIGhhbmRsZU1hcmtlcik7XHJcbiAgICAgIGZlYXR1cmVzT3ZlcmxheS5nZXRTb3VyY2UoKS5jbGVhcigpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59KCkpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgJCgnLndlYXRoZXInKS5jaGFuZ2UoZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoJCh0aGlzKS5wcm9wKCdjaGVja2VkJykgPT09IHRydWUpIHtcclxuICAgICAgICBtYXAuZ2V0T3ZlcmxheXMoKS5mb3JFYWNoKGZ1bmN0aW9uKG92bCkge1xyXG4gICAgICAgIGlmIChvdmwuZ2V0KCduYW1lJykgPT09ICd3ZWF0aGVyJykge1xyXG4gICAgICAgICAgKCQob3ZsLmdldEVsZW1lbnQoKSkucGFyZW50KCkpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgJChvdmwuZ2V0RWxlbWVudCgpKS5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICB2YXIgY2VudGVyID0gb2wucHJvai50cmFuc2Zvcm0obWFwLmdldFZpZXcoKS5nZXRDZW50ZXIoKSwgJ0VQU0c6Mzg1NycsICdFUFNHOjQzMjYnKTtcclxuICAgICAgdmFyIGxhdCA9IGNlbnRlclsxXTtcclxuICAgICAgdmFyIGxvbiA9IGNlbnRlclswXTtcclxuICAgICAgJC5hamF4KHtcclxuICAgICAgICB1cmw6ICdodHRwOi8vYXBpLm9wZW53ZWF0aGVybWFwLm9yZy9kYXRhLzIuNS9maW5kP2xhdD0nICsgbGF0ICsgJyZsb249JyArIGxvbiArICcmY250PTUmY2x1c3Rlcj1ubyZ1bml0cz1tZXRyaWMmdHlwZT1hY2N1cmF0ZSZBUFBJRD1mOWNkOWZhMmM0MjdjM2IxMTVlODdlNDg2MjYxOWM1YycsXHJcbiAgICAgICAgdHlwZTogJ0dFVCcsXHJcbiAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgfSkuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlV2VhdGhlck92ZXJsYXkocG9zaXRpb24sIGluZGV4KSB7XHJcbiAgICAgICAgICB2YXIgZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3dlYXRoZXItcG9wdXAgZGVmYXVsdC1wcmltYXJ5LWNvbG9yICBwYXBlci1zaGFkb3ctYm90dG9tLXotNCcpO1xyXG4gICAgICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoJ2lkJywgaW5kZXgpO1xyXG4gICAgICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoJ2RhdGEtbmFtZScsICd3ZWF0aGVyJyk7XHJcbiAgICAgICAgICByZXR1cm4gbmV3IG9sLk92ZXJsYXkoe1xyXG4gICAgICAgICAgICBlbGVtZW50OiBlbGVtLFxyXG4gICAgICAgICAgICBwb3NpdGlvbjogcG9zaXRpb24sXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG9ianMgPSBkYXRhLmxpc3Q7XHJcbiAgICAgICAgdmFyIG92ZXJsYXksIGNvb3JkaW5hdGVzO1xyXG4gICAgICAgICQuZWFjaChvYmpzLCBmdW5jdGlvbihpbmRleCwgdmFsKSB7XHJcbiAgICAgICAgICBjb29yZGluYXRlcyA9IG9sLnByb2oudHJhbnNmb3JtKFt2YWwuY29vcmQubG9uLCB2YWwuY29vcmQubGF0XSwgJ0VQU0c6NDMyNicsICdFUFNHOjM4NTcnKTtcclxuICAgICAgICAgIG92ZXJsYXkgPSBjcmVhdGVXZWF0aGVyT3ZlcmxheShjb29yZGluYXRlcywgaW5kZXgpO1xyXG4gICAgICAgICAgbWFwLmFkZE92ZXJsYXkob3ZlcmxheSk7XHJcbiAgICAgICAgICBvdmVybGF5LnNldCgnbmFtZScsICd3ZWF0aGVyJyk7XHJcbiAgICAgICAgICB3ZWF0aGVyRGF0YSA9IHtcclxuICAgICAgICAgICAgJ25hbWUnOiB2YWwubmFtZSxcclxuICAgICAgICAgICAgJ3RlbXAnOiB2YWwubWFpbi50ZW1wLFxyXG4gICAgICAgICAgICAncHJlc3N1cmUnOiB2YWwubWFpbi5wcmVzc3VyZSxcclxuICAgICAgICAgICAgJ2h1bWlkaXR5JzogdmFsLm1haW4uaHVtaWRpdHlcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICBkdXN0LnJlbmRlcignd2VhdGhlclBvcHVwLmR1c3QnLCB3ZWF0aGVyRGF0YSwgZnVuY3Rpb24oZXJyLCBvdXQpIHtcclxuICAgICAgICAgICAgJChcIiNcIiArIGluZGV4KS5odG1sKG91dCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSkuZmFpbChmdW5jdGlvbigpIHtcclxuICAgICAgICAvLyB0b2FzdHIuZXJyb3IoXCLOlM61zr0gzrLPgc6tzrjOt866zrHOvSDPgM67zrfPgc6/z4bOv8+Bzq/Otc+CIM6zzrnOsSDPhM65z4IgzrrOsc65z4HOuc66zq3PgiDPg8+Fzr3OuM6uzrrOtc+CIVwiKTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2UgaWYgKCQodGhpcykucHJvcCgnY2hlY2tlZCcpID09PSBmYWxzZSkge1xyXG4gICAgICBtYXAuZ2V0T3ZlcmxheXMoKS5mb3JFYWNoKGZ1bmN0aW9uKG92bCkge1xyXG4gICAgICAgIGlmIChvdmwuZ2V0KCduYW1lJykgPT09ICd3ZWF0aGVyJykge1xyXG4gICAgICAgICAgKCQob3ZsLmdldEVsZW1lbnQoKSkucGFyZW50KCkpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgJChvdmwuZ2V0RWxlbWVudCgpKS5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59KCkpO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=