var geoJSONFormat=new ol.format.GeoJSON({defaultDataProjection:"EPSG:4326"}),styleCache={},bing=new ol.layer.Tile({visible:!0,source:new ol.source.BingMaps({key:"Ak2Gq8VUfICsPpuf7LRANXmXt2sHWmSLPhohmVLFtFIEwYjs_5MCyAhAFwRSVpLj",imagerySet:"Aerial"}),maxZoom:19,crossOrigin:"anonymous",preload:1/0,nameEl:"Δορυφορική εικόνα",nameEn:"Satellite Image",id:"bing"}),mapbox=new ol.layer.Tile({source:new ol.source.XYZ({attributions:new ol.Attribution({html:'<a href="https://www.mapbox.com/about/maps/" target="_blank">&copy; Mapbox &copy; OpenStreetMap</a>'}),url:"https://api.mapbox.com/v4/mapbox.streets/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiZmlydmFpbiIsImEiOiJlOWYyYTM0NThiNWM0YjJjODJjNDE4ODQzNzA2MGQyNiJ9.-NVDO27Hzt-w_nQosUPfLA"})}),propertyStyleFunction=function(e,o){var t=e.get("features").length,r=styleCache[t];return r||(r=[new ol.style.Style({image:new ol.style.Circle({radius:15,stroke:new ol.style.Stroke({color:[156,39,176,.8],width:5}),fill:new ol.style.Fill({color:[68,138,255,1]})}),text:new ol.style.Text({text:t.toString(),fill:new ol.style.Fill({color:"#FFFFFF"})}),zIndex:101})],styleCache[t]=r),r},propertySource=new ol.source.Vector({format:geoJSONFormat,loader:function(e,o,t){var r=ol.proj.transformExtent(e,"EPSG:3857","EPSG:4326"),l="http://www.geomerchant.eu:3000/db/property?bbox[x1]="+r[0]+"&bbox[y1]="+r[1]+"&bbox[x2]="+r[2]+"&bbox[y2]="+r[3],a=this;this.clear(),$.ajax({url:l,type:"GET",dataType:"json"}).done(function(e){var o=geoJSONFormat.readFeatures(e,{featureProjection:"EPSG:3857"});a.addFeatures(o)}).fail(function(){console.log("error")})},strategy:ol.loadingstrategy.bbox}),propertyClusterSource=new ol.source.Cluster({distance:40,source:propertySource,attributions:[new ol.Attribution({html:'All maps © <a href="http://www.terracognita.gr/">Terra Cognita</a>'})]}),property=new ol.layer.Vector({source:propertyClusterSource,nameEl:"Ιδιοκτησίες",nameEn:"Estates",id:"estates",visible:!0,style:propertyStyleFunction}),map=new ol.Map({target:"map",layers:[mapbox,property],loadTilesWhileAnimating:!0,loadTilesWhileInteracting:!0,renderer:"canvas",controls:ol.control.defaults({attributionOptions:{collapsible:!1,collapsed:!1}}).extend([new ol.control.ScaleLine({units:"metric"}),new ol.control.OverviewMap({className:"ol-overviewmap ol-custom-overviewmap",collapsible:!0,collapsed:!0,layers:[new ol.layer.Tile({source:new ol.source.OSM,visible:!0,preload:1/0,crossOrigin:"anonymous",nameEl:"Μικρός Χάρτης",nameEn:"MiniMap",id:"overviewOsm"})]})]),view:new ol.View({center:[3713616,4181258],extent:[3590094,4102833,3855483,4261211],projection:"EPSG:3857",zoom:14,maxZoom:19,minZoom:10})});
!function(){var e=new ol.Geolocation({projection:map.getView().getProjection(),trackingOptions:{maximumAge:1e4,enableHighAccuracy:!0,timeout:6e5}}),o=new ol.Feature;e.on("change:accuracyGeometry",function(){o.setGeometry(e.getAccuracyGeometry())});var t=new ol.Feature;t.setStyle(new ol.style.Style({image:new ol.style.Circle({radius:6,fill:new ol.style.Fill({color:"#3399CC"}),stroke:new ol.style.Stroke({color:"#fff",width:2})})})),e.on("change:position",function(){var o=e.getPosition();t.setGeometry(o?new ol.geom.Point(o):null)}),featuresOverlaySource=new ol.source.Vector({});new ol.layer.Vector({map:map,source:featuresOverlaySource});$(".geolocation").on("change",function(r){r.preventDefault(),$(this).prop("checked")===!0?(e.setTracking(!0),featuresOverlaySource.addFeatures([t,o])):(e.setTracking(!1),featuresOverlaySource.clear())})}();
!function(){function e(e){e.preventDefault();var t=e.coordinate,a={},r={},u=[];"el"===document.documentElement.lang?(r.type="Τύπος",r.area="Εμβαδό",r.address="Διευθυνση"):(r.type="Type",r.area="Size",r.address="Address"),a.title=r,clickedFeature=map.forEachFeatureAtPixel(e.pixel,function(e,t){return{feature:e,layer:t}},this,function(e){return"estates"===e.get("id")?!0:void 0},this),clickedFeature&&(clickedFeature.feature.get("features").forEach(function(e){var t={};e.get("gid");t.type=e.get("estatetype"),t.area=e.get("estatearea"),t.address=e.get("street")+" "+e.get("h_num"),u.push({feature:t}),a.features=u}),dust.render("estateInfo.dust",a,function(e,t){$("#popup-content").html(t)}),dust.render("estateCards.dust",a,function(e,t){$(".estate-cards").html(t),$(".estate-cards").removeClass("hidden")}),n.setPosition(t))}var t=document.getElementById("popup"),a=document.getElementById("popup-closer");a.onclick=function(){return n.setPosition(void 0),a.blur(),!1};var n=new ol.Overlay({element:t,autoPan:!0,autoPanAnimation:{duration:250}});map.addOverlay(n),$(".info").on("change",function(t){t.preventDefault(),$(this).prop("checked")===!0?map.on("singleclick",e):map.un("singleclick",e)})}();
!function(){function e(e){e.preventDefault();var r=n.getSource().getFeatures().length,a=e.coordinate;if(0===r)t.setGeometry(new ol.geom.Point(a)),t.setId("first"),n.getSource().addFeature(t),c[0]=a[0],c[1]=a[1];else if(1===r){var i=t.clone();i.setGeometry(new ol.geom.Point(a)),i.setId("second"),n.getSource().addFeature(i),c[2]=a[0],c[3]=a[1],o(c)}else n.getSource().clear()}function o(e){var o=ol.proj.transform([e[0],e[1]],"EPSG:3857","EPSG:4326"),t=ol.proj.transform([e[2],e[3]],"EPSG:3857","EPSG:4326"),r=o[0],a=o[1],c=t[0],i=t[1];$.ajax({url:"https://api.mapbox.com/v4/directions/mapbox.driving/"+r+","+a+";"+c+","+i+".json?alternatives=false&access_token=pk.eyJ1IjoiZmlydmFpbiIsImEiOiJlOWYyYTM0NThiNWM0YjJjODJjNDE4ODQzNzA2MGQyNiJ9.-NVDO27Hzt-w_nQosUPfLA",type:"GET",dataType:"json"}).done(function(e){var o={};o.type="Feature",o.geometry=e.routes[0].geometry,n.getSource().addFeatures(geoJSONFormat.readFeatures(o,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})),map.getView().fit(n.getSource().getExtent(),map.getSize())}).fail(function(){console.log("error")}).always(function(){console.log("complete")})}var t=new ol.Feature,r=new ol.style.Style({image:new ol.style.Icon({anchor:[.5,1],anchorXUnits:"fraction",anchorYUnits:"fraction",opacity:1,scale:1,src:"../images/map-icons/pins/24/pin1.png",snapToPixel:!1}),zIndex:100});t.setStyle(r);var a=new ol.style.Style({stroke:new ol.style.Stroke({color:"#408080",width:5,lineDash:[4,4]})}),n=new ol.layer.Vector({map:map,source:new ol.source.Vector,style:a,id:"route",nameEl:"Διαδρομή",NameEn:"Route"}),c=[];geoJSONFormat=new ol.format.GeoJSON({defaultDataProjection:"EPSG:4326",geometryName:"geometry"}),$(".marker").on("change",function(o){o.preventDefault(),$(this).prop("checked")===!0?map.on("singleclick",e):(map.un("singleclick",e),n.getSource().clear())})}();
!function(){$(".weather").change(function(){if($(this).prop("checked")===!0){map.getOverlays().forEach(function(e){"weather"===e.get("name")&&($(e.getElement()).parent().remove(),$(e.getElement()).remove())});var e=ol.proj.transform(map.getView().getCenter(),"EPSG:3857","EPSG:4326"),t=e[1],a=e[0];$.ajax({url:"http://api.openweathermap.org/data/2.5/find?lat="+t+"&lon="+a+"&cnt=5&cluster=no&units=metric&type=accurate&APPID=f9cd9fa2c427c3b115e87e4862619c5c",type:"GET",dataType:"json"}).done(function(e){function t(e,t){var a=document.createElement("div");return a.setAttribute("class","weather-popup default-primary-color mdl-shadow--6dp"),a.setAttribute("id",t),a.setAttribute("data-name","weather"),new ol.Overlay({element:a,position:e})}var a,r,n=e.list;$.each(n,function(e,n){r=ol.proj.transform([n.coord.lon,n.coord.lat],"EPSG:4326","EPSG:3857"),a=t(r,e),map.addOverlay(a),a.set("name","weather"),weatherData={name:n.name,temp:n.main.temp,pressure:n.main.pressure,humidity:n.main.humidity},dust.render("weatherPopup.dust",weatherData,function(t,a){$("#"+e).html(a)})})}).fail(function(){})}else $(this).prop("checked")===!1&&map.getOverlays().forEach(function(e){"weather"===e.get("name")&&($(e.getElement()).parent().remove(),$(e.getElement()).remove())})})}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hcC5qcyIsImdlb2xvY2F0aW9uLmpzIiwiaW5mby5qcyIsInJvdXRpbmcuanMiLCJ3ZWF0aGVyLmpzIl0sIm5hbWVzIjpbImdlb0pTT05Gb3JtYXQiLCJvbCIsImZvcm1hdCIsIkdlb0pTT04iLCJkZWZhdWx0RGF0YVByb2plY3Rpb24iLCJzdHlsZUNhY2hlIiwiYmluZyIsImxheWVyIiwiVGlsZSIsInZpc2libGUiLCJzb3VyY2UiLCJCaW5nTWFwcyIsImtleSIsImltYWdlcnlTZXQiLCJtYXhab29tIiwiY3Jvc3NPcmlnaW4iLCJwcmVsb2FkIiwiSW5maW5pdHkiLCJuYW1lRWwiLCJuYW1lRW4iLCJpZCIsIm1hcGJveCIsIlhZWiIsImF0dHJpYnV0aW9ucyIsIkF0dHJpYnV0aW9uIiwiaHRtbCIsInVybCIsInByb3BlcnR5U3R5bGVGdW5jdGlvbiIsImZlYXR1cmUiLCJyZXNvbHV0aW9uIiwic2l6ZSIsImdldCIsImxlbmd0aCIsInN0eWxlIiwiU3R5bGUiLCJpbWFnZSIsIkNpcmNsZSIsInJhZGl1cyIsInN0cm9rZSIsIlN0cm9rZSIsImNvbG9yIiwid2lkdGgiLCJmaWxsIiwiRmlsbCIsInRleHQiLCJUZXh0IiwidG9TdHJpbmciLCJ6SW5kZXgiLCJwcm9wZXJ0eVNvdXJjZSIsIlZlY3RvciIsImxvYWRlciIsImV4dGVudCIsInByb2plY3Rpb24iLCJlcHNnNDMyNkV4dGVudCIsInByb2oiLCJ0cmFuc2Zvcm1FeHRlbnQiLCJ0aGF0IiwidGhpcyIsImNsZWFyIiwiJCIsImFqYXgiLCJ0eXBlIiwiZGF0YVR5cGUiLCJkb25lIiwicmVzcG9uc2UiLCJmZWF0dXJlcyIsInJlYWRGZWF0dXJlcyIsImZlYXR1cmVQcm9qZWN0aW9uIiwiYWRkRmVhdHVyZXMiLCJmYWlsIiwiY29uc29sZSIsImxvZyIsInN0cmF0ZWd5IiwibG9hZGluZ3N0cmF0ZWd5IiwiYmJveCIsInByb3BlcnR5Q2x1c3RlclNvdXJjZSIsIkNsdXN0ZXIiLCJkaXN0YW5jZSIsInByb3BlcnR5IiwibWFwIiwiTWFwIiwidGFyZ2V0IiwibGF5ZXJzIiwibG9hZFRpbGVzV2hpbGVBbmltYXRpbmciLCJsb2FkVGlsZXNXaGlsZUludGVyYWN0aW5nIiwicmVuZGVyZXIiLCJjb250cm9scyIsImNvbnRyb2wiLCJkZWZhdWx0cyIsImF0dHJpYnV0aW9uT3B0aW9ucyIsImNvbGxhcHNpYmxlIiwiY29sbGFwc2VkIiwiZXh0ZW5kIiwiU2NhbGVMaW5lIiwidW5pdHMiLCJPdmVydmlld01hcCIsImNsYXNzTmFtZSIsIk9TTSIsInZpZXciLCJWaWV3IiwiY2VudGVyIiwiem9vbSIsIm1pblpvb20iLCJnZW9sb2NhdGlvbiIsIkdlb2xvY2F0aW9uIiwiZ2V0VmlldyIsImdldFByb2plY3Rpb24iLCJ0cmFja2luZ09wdGlvbnMiLCJtYXhpbXVtQWdlIiwiZW5hYmxlSGlnaEFjY3VyYWN5IiwidGltZW91dCIsImFjY3VyYWN5RmVhdHVyZSIsIkZlYXR1cmUiLCJvbiIsInNldEdlb21ldHJ5IiwiZ2V0QWNjdXJhY3lHZW9tZXRyeSIsInBvc2l0aW9uRmVhdHVyZSIsInNldFN0eWxlIiwiY29vcmRpbmF0ZXMiLCJnZXRQb3NpdGlvbiIsImdlb20iLCJQb2ludCIsImZlYXR1cmVzT3ZlcmxheVNvdXJjZSIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInByb3AiLCJzZXRUcmFja2luZyIsImhhbmRsZUluZm8iLCJldnQiLCJjb29yZGluYXRlIiwib2JqIiwidGl0bGUiLCJkb2N1bWVudCIsImRvY3VtZW50RWxlbWVudCIsImxhbmciLCJhcmVhIiwiYWRkcmVzcyIsImNsaWNrZWRGZWF0dXJlIiwiZm9yRWFjaEZlYXR1cmVBdFBpeGVsIiwicGl4ZWwiLCJmb3JFYWNoIiwiZiIsInB1c2giLCJkdXN0IiwicmVuZGVyIiwiZXJyIiwib3V0IiwicmVtb3ZlQ2xhc3MiLCJpbmZvIiwic2V0UG9zaXRpb24iLCJjb250YWluZXIiLCJnZXRFbGVtZW50QnlJZCIsImNsb3NlciIsIm9uY2xpY2siLCJ1bmRlZmluZWQiLCJibHVyIiwiT3ZlcmxheSIsImVsZW1lbnQiLCJhdXRvUGFuIiwiYXV0b1BhbkFuaW1hdGlvbiIsImR1cmF0aW9uIiwiYWRkT3ZlcmxheSIsInVuIiwiaGFuZGxlTWFya2VyIiwiZXZlbnQiLCJmZWF0dXJlQ291bnQiLCJmZWF0dXJlc092ZXJsYXkiLCJnZXRTb3VyY2UiLCJnZXRGZWF0dXJlcyIsIm1hcmtlciIsInNldElkIiwiYWRkRmVhdHVyZSIsInJvdXRlQ29vcmRzIiwiY2xvbmUiLCJjYWxsUm91dGUiLCJmaXJzdCIsInRyYW5zZm9ybSIsInNlY29uZCIsIngxIiwieTEiLCJ4MiIsInkyIiwiZGF0YSIsInJvdXRlIiwiZ2VvbWV0cnkiLCJyb3V0ZXMiLCJkYXRhUHJvamVjdGlvbiIsImZpdCIsImdldEV4dGVudCIsImdldFNpemUiLCJhbHdheXMiLCJpY29uU3R5bGUiLCJJY29uIiwiYW5jaG9yIiwiYW5jaG9yWFVuaXRzIiwiYW5jaG9yWVVuaXRzIiwib3BhY2l0eSIsInNjYWxlIiwic3JjIiwic25hcFRvUGl4ZWwiLCJmZWF0dXJlc092ZXJsYXlTdHlsZSIsImxpbmVEYXNoIiwiTmFtZUVuIiwiZ2VvbWV0cnlOYW1lIiwiY2hhbmdlIiwiZ2V0T3ZlcmxheXMiLCJvdmwiLCJnZXRFbGVtZW50IiwicGFyZW50IiwicmVtb3ZlIiwiZ2V0Q2VudGVyIiwibGF0IiwibG9uIiwiY3JlYXRlV2VhdGhlck92ZXJsYXkiLCJwb3NpdGlvbiIsImluZGV4IiwiZWxlbSIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJvdmVybGF5Iiwib2JqcyIsImxpc3QiLCJlYWNoIiwidmFsIiwiY29vcmQiLCJzZXQiLCJ3ZWF0aGVyRGF0YSIsIm5hbWUiLCJ0ZW1wIiwibWFpbiIsInByZXNzdXJlIiwiaHVtaWRpdHkiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUlBLGVBQWdCLEdBQUlDLElBQUdDLE9BQU9DLFNBQ2hDQyxzQkFBdUIsY0FFckJDLGNBQ0FDLEtBQU8sR0FBSUwsSUFBR00sTUFBTUMsTUFDdEJDLFNBQVMs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TCxFQUFJTSxLQUFLRCxLQUNqQkUsU0FBWVAsRUFBSU0sS0FBS0MsU0FDckJDLFNBQVlSLEVBQUlNLEtBQUtFLFVBRXZCeEYsS0FBS0MsT0FBTyxvQkFBcUJrRixZQUFhLFNBQVNqRixFQUFLQyxHQUMxRHZGLEVBQUUsSUFBTTRKLEdBQU85TCxLQUFLeUgsU0FHdkI3RSxLQUFLLGtCQUdDVixHQUFFRixNQUFNb0UsS0FBSyxjQUFlLEdBQ3JDOUMsSUFBSThILGNBQWNqRSxRQUFRLFNBQVNrRSxHQUNULFlBQXBCQSxFQUFJL0ssSUFBSSxVQUNUNEIsRUFBRW1KLEVBQUlDLGNBQWNDLFNBQVVDLFNBQy9CdEosRUFBRW1KLEVBQUlDLGNBQWNFIiwiZmlsZSI6InNjcmlwdHMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGdlb0pTT05Gb3JtYXQgPSBuZXcgb2wuZm9ybWF0Lkdlb0pTT04oe1xyXG4gIGRlZmF1bHREYXRhUHJvamVjdGlvbjogJ0VQU0c6NDMyNidcclxufSk7XHJcbnZhciBzdHlsZUNhY2hlID0ge307XHJcbnZhciBiaW5nID0gbmV3IG9sLmxheWVyLlRpbGUoe1xyXG4gIHZpc2libGU6IHRydWUsXHJcbiAgc291cmNlOiBuZXcgb2wuc291cmNlLkJpbmdNYXBzKHtcclxuICAgIGtleTogJ0FrMkdxOFZVZklDc1BwdWY3TFJBTlhtWHQyc0hXbVNMUGhvaG1WTEZ0RklFd1lqc181TUN5QWhBRndSU1ZwTGonLFxyXG4gICAgaW1hZ2VyeVNldDogJ0FlcmlhbCdcclxuICB9KSxcclxuICBtYXhab29tOiAxOSxcclxuICBjcm9zc09yaWdpbjogJ2Fub255bW91cycsXHJcbiAgcHJlbG9hZDogSW5maW5pdHksXHJcbiAgbmFtZUVsOiAnzpTOv8+Bz4XPhs6/z4HOuc66zq4gzrXOuc66z4zOvc6xJyxcclxuICBuYW1lRW46ICdTYXRlbGxpdGUgSW1hZ2UnLFxyXG4gIGlkOiAnYmluZydcclxufSk7XHJcbnZhciBtYXBib3ggPSBuZXcgb2wubGF5ZXIuVGlsZSh7XHJcbiAgc291cmNlOiBuZXcgb2wuc291cmNlLlhZWih7XHJcbiAgICBhdHRyaWJ1dGlvbnM6IG5ldyBvbC5BdHRyaWJ1dGlvbih7XHJcbiAgICAgIGh0bWw6ICc8YSBocmVmPVxcXCJodHRwczovL3d3dy5tYXBib3guY29tL2Fib3V0L21hcHMvXFxcIiB0YXJnZXQ9XFxcIl9ibGFua1xcXCI+JmNvcHk7IE1hcGJveCAmY29weTsgT3BlblN0cmVldE1hcDwvYT4nXHJcbiAgICB9KSxcclxuICAgIHVybDogJ2h0dHBzOi8vYXBpLm1hcGJveC5jb20vdjQvbWFwYm94LnN0cmVldHMve3p9L3t4fS97eX0ucG5nP2FjY2Vzc190b2tlbj1way5leUoxSWpvaVptbHlkbUZwYmlJc0ltRWlPaUpsT1dZeVlUTTBOVGhpTldNMFlqSmpPREpqTkRFNE9EUXpOekEyTUdReU5pSjkuLU5WRE8yN0h6dC13X25Rb3NVUGZMQSdcclxuICB9KVxyXG59KTtcclxudmFyIHByb3BlcnR5U3R5bGVGdW5jdGlvbiA9IGZ1bmN0aW9uKGZlYXR1cmUsIHJlc29sdXRpb24pIHtcclxuICB2YXIgc2l6ZSA9IGZlYXR1cmUuZ2V0KCdmZWF0dXJlcycpLmxlbmd0aDtcclxuICB2YXIgc3R5bGUgPSBzdHlsZUNhY2hlW3NpemVdO1xyXG4gIGlmICghc3R5bGUpIHtcclxuICAgIHN0eWxlID0gW25ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICAgIGltYWdlOiBuZXcgb2wuc3R5bGUuQ2lyY2xlKHtcclxuICAgICAgICByYWRpdXM6IDE1LFxyXG4gICAgICAgIHN0cm9rZTogbmV3IG9sLnN0eWxlLlN0cm9rZSh7XHJcbiAgICAgICAgICBjb2xvcjogWzE1NiwgMzksIDE3NiwgMC44XSxcclxuICAgICAgICAgIHdpZHRoIDogNVxyXG4gICAgICAgIH0pLFxyXG4gICAgICAgIGZpbGw6IG5ldyBvbC5zdHlsZS5GaWxsKHtcclxuICAgICAgICAgIGNvbG9yOiBbNjgsIDEzOCwgMjU1LCAxLjBdXHJcbiAgICAgICAgfSlcclxuICAgICAgfSksXHJcbiAgICAgIHRleHQ6IG5ldyBvbC5zdHlsZS5UZXh0KHtcclxuICAgICAgICB0ZXh0OiBzaXplLnRvU3RyaW5nKCksXHJcbiAgICAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xyXG4gICAgICAgICAgY29sb3I6ICcjRkZGRkZGJ1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pLFxyXG4gICAgICB6SW5kZXg6IDEwMVxyXG4gICAgfSldO1xyXG4gICAgc3R5bGVDYWNoZVtzaXplXSA9IHN0eWxlO1xyXG4gIH1cclxuICByZXR1cm4gc3R5bGU7XHJcbn07XHJcbnZhciBwcm9wZXJ0eVNvdXJjZSA9IG5ldyBvbC5zb3VyY2UuVmVjdG9yKHtcclxuICBmb3JtYXQ6IGdlb0pTT05Gb3JtYXQsXHJcbiAgbG9hZGVyOiBmdW5jdGlvbihleHRlbnQsIHJlc29sdXRpb24sIHByb2plY3Rpb24pIHtcclxuICAgIHZhciBlcHNnNDMyNkV4dGVudCA9IG9sLnByb2oudHJhbnNmb3JtRXh0ZW50KGV4dGVudCwgJ0VQU0c6Mzg1NycsICdFUFNHOjQzMjYnKTtcclxuICAgIHZhciB1cmwgPSAnaHR0cDovL3d3dy5nZW9tZXJjaGFudC5ldTozMDAwL2RiL3Byb3BlcnR5P2Jib3hbeDFdPScgKyBlcHNnNDMyNkV4dGVudFswXSArICcmYmJveFt5MV09JyArIGVwc2c0MzI2RXh0ZW50WzFdICsgJyZiYm94W3gyXT0nICsgZXBzZzQzMjZFeHRlbnRbMl0gKyAnJmJib3hbeTJdPScgKyBlcHNnNDMyNkV4dGVudFszXTtcclxuICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgIHRoaXMuY2xlYXIoKTtcclxuICAgICQuYWpheCh7XHJcbiAgICAgIHVybDogdXJsLFxyXG4gICAgICB0eXBlOiAnR0VUJyxcclxuICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgIH0pLmRvbmUoZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgdmFyIGZlYXR1cmVzID0gZ2VvSlNPTkZvcm1hdC5yZWFkRmVhdHVyZXMocmVzcG9uc2UsIHtcclxuICAgICAgICBmZWF0dXJlUHJvamVjdGlvbjogJ0VQU0c6Mzg1NydcclxuICAgICAgfSk7XHJcbiAgICAgIC8vIHRoYXQuY2xlYXIoKTtcclxuICAgICAgdGhhdC5hZGRGZWF0dXJlcyhmZWF0dXJlcyk7XHJcbiAgICB9KS5mYWlsKGZ1bmN0aW9uKCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhcImVycm9yXCIpO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuICBzdHJhdGVneTogb2wubG9hZGluZ3N0cmF0ZWd5LmJib3hcclxufSk7XHJcbnZhciBwcm9wZXJ0eUNsdXN0ZXJTb3VyY2UgPSBuZXcgb2wuc291cmNlLkNsdXN0ZXIoe1xyXG4gIGRpc3RhbmNlOiA0MCxcclxuICBzb3VyY2U6IHByb3BlcnR5U291cmNlLFxyXG4gIGF0dHJpYnV0aW9uczogW25ldyBvbC5BdHRyaWJ1dGlvbih7XHJcbiAgICBodG1sOiAnQWxsIG1hcHMgwqkgJyArICc8YSBocmVmPVwiaHR0cDovL3d3dy50ZXJyYWNvZ25pdGEuZ3IvXCI+VGVycmEgQ29nbml0YTwvYT4nXHJcbiAgfSldXHJcbn0pO1xyXG52YXIgcHJvcGVydHkgPSBuZXcgb2wubGF5ZXIuVmVjdG9yKHtcclxuICBzb3VyY2U6IHByb3BlcnR5Q2x1c3RlclNvdXJjZSxcclxuICBuYW1lRWw6ICfOmc60zrnOv866z4TOt8+Dzq/Otc+CJyxcclxuICBuYW1lRW46ICdFc3RhdGVzJyxcclxuICBpZDogJ2VzdGF0ZXMnLFxyXG4gIHZpc2libGU6IHRydWUsXHJcbiAgc3R5bGU6IHByb3BlcnR5U3R5bGVGdW5jdGlvblxyXG59KTtcclxuLy8gdmFyIGFkbWluaXN0cmF0aXZlU291cmNlID0gbmV3IG9sLnNvdXJjZS5WZWN0b3Ioe1xyXG4vLyAgIGZvcm1hdDogZ2VvSlNPTkZvcm1hdCxcclxuLy8gICBsb2FkZXI6IGZ1bmN0aW9uKGV4dGVudCwgcmVzb2x1dGlvbiwgcHJvamVjdGlvbikge1xyXG4vLyAgICAgdmFyIGVwc2c0MzI2RXh0ZW50ID0gb2wucHJvai50cmFuc2Zvcm1FeHRlbnQoZXh0ZW50LCAnRVBTRzozODU3JywgJ0VQU0c6NDMyNicpO1xyXG4vLyAgICAgdmFyIHVybCA9ICdodHRwOi8vbG9jYWxob3N0OjMwMDAvZGIvYWRtaW5pc3RyYXRpdmU/YmJveFt4MV09JyArIGVwc2c0MzI2RXh0ZW50WzBdICsgJyZiYm94W3kxXT0nICsgZXBzZzQzMjZFeHRlbnRbMV0gKyAnJmJib3hbeDJdPScgKyBlcHNnNDMyNkV4dGVudFsyXSArICcmYmJveFt5Ml09JyArIGVwc2c0MzI2RXh0ZW50WzNdO1xyXG4vLyAgICAgdmFyIHRoYXQgPSB0aGlzO1xyXG4vLyAgICAgdGhpcy5jbGVhcigpO1xyXG4vLyAgICAgJC5hamF4KHtcclxuLy8gICAgICAgdXJsOiB1cmwsXHJcbi8vICAgICAgIHR5cGU6ICdHRVQnLFxyXG4vLyAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxyXG4vLyAgICAgfSkuZG9uZShmdW5jdGlvbihyZXNwb25zZSkge1xyXG4vLyAgICAgICB2YXIgZmVhdHVyZXMgPSBnZW9KU09ORm9ybWF0LnJlYWRGZWF0dXJlcyhyZXNwb25zZSwge1xyXG4vLyAgICAgICAgIGZlYXR1cmVQcm9qZWN0aW9uOiAnRVBTRzozODU3J1xyXG4vLyAgICAgICB9KTtcclxuLy8gICAgICAgLy8gdGhhdC5jbGVhcigpO1xyXG4vLyAgICAgICB0aGF0LmFkZEZlYXR1cmVzKGZlYXR1cmVzKTtcclxuLy8gICAgIH0pLmZhaWwoZnVuY3Rpb24oKSB7XHJcbi8vICAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3JcIik7XHJcbi8vICAgICB9KTtcclxuLy8gICB9LFxyXG4vLyAgIHN0cmF0ZWd5OiBvbC5sb2FkaW5nc3RyYXRlZ3kuYmJveFxyXG4vLyB9KTtcclxuLy8gdmFyIGFkbWluaXN0cmF0aXZlID0gbmV3IG9sLmxheWVyLlZlY3Rvcih7XHJcbi8vICAgc291cmNlOiBhZG1pbmlzdHJhdGl2ZVNvdXJjZSxcclxuLy8gICBuYW1lRWw6ICfOnc6/z4POv866zr/OvM6tzrnOsScsXHJcbi8vICAgbmFtZUVuOiAnSG9zcGl0YWxzJyxcclxuLy8gICBpZDogJ2hvc3BpdGFscycsXHJcbi8vICAgdmlzaWJsZTogdHJ1ZVxyXG4vLyB9KTtcclxudmFyIG1hcCA9IG5ldyBvbC5NYXAoe1xyXG4gIHRhcmdldDogJ21hcCcsXHJcbiAgbGF5ZXJzOiBbbWFwYm94LCBwcm9wZXJ0eV0sXHJcbiAgbG9hZFRpbGVzV2hpbGVBbmltYXRpbmc6IHRydWUsXHJcbiAgbG9hZFRpbGVzV2hpbGVJbnRlcmFjdGluZzogdHJ1ZSxcclxuICByZW5kZXJlcjogJ2NhbnZhcycsXHJcbiAgY29udHJvbHM6IG9sLmNvbnRyb2wuZGVmYXVsdHMoe1xyXG4gICAgYXR0cmlidXRpb25PcHRpb25zOiB7XHJcbiAgICAgIGNvbGxhcHNpYmxlOiBmYWxzZSxcclxuICAgICAgY29sbGFwc2VkOiBmYWxzZVxyXG4gICAgfVxyXG4gIH0pLmV4dGVuZChbXHJcbiAgICBuZXcgb2wuY29udHJvbC5TY2FsZUxpbmUoe1xyXG4gICAgICB1bml0czogJ21ldHJpYydcclxuICAgIH0pLCBuZXcgb2wuY29udHJvbC5PdmVydmlld01hcCh7XHJcbiAgICAgIGNsYXNzTmFtZTogJ29sLW92ZXJ2aWV3bWFwIG9sLWN1c3RvbS1vdmVydmlld21hcCcsXHJcbiAgICAgIGNvbGxhcHNpYmxlOiB0cnVlLFxyXG4gICAgICBjb2xsYXBzZWQ6IHRydWUsXHJcbiAgICAgIGxheWVyczogW25ldyBvbC5sYXllci5UaWxlKHtcclxuICAgICAgICBzb3VyY2U6IG5ldyBvbC5zb3VyY2UuT1NNKCksXHJcbiAgICAgICAgdmlzaWJsZTogdHJ1ZSxcclxuICAgICAgICBwcmVsb2FkOiBJbmZpbml0eSxcclxuICAgICAgICBjcm9zc09yaWdpbjogJ2Fub255bW91cycsXHJcbiAgICAgICAgbmFtZUVsOiAnzpzOuc66z4HPjM+CIM6nzqzPgc+EzrfPgicsXHJcbiAgICAgICAgbmFtZUVuOiAnTWluaU1hcCcsXHJcbiAgICAgICAgaWQ6ICdvdmVydmlld09zbSdcclxuICAgICAgfSldXHJcbiAgICB9KVxyXG4gIF0pLFxyXG4gIHZpZXc6IG5ldyBvbC5WaWV3KHtcclxuICAgIGNlbnRlcjogWzM3MTM2MTYsIDQxODEyNThdLFxyXG4gICAgZXh0ZW50OiBbMzU5MDA5NCwgNDEwMjgzMywgMzg1NTQ4MywgNDI2MTIxMV0sXHJcbiAgICBwcm9qZWN0aW9uOiAnRVBTRzozODU3JyxcclxuICAgIHpvb206IDE0LFxyXG4gICAgbWF4Wm9vbTogMTksXHJcbiAgICBtaW5ab29tOiAxMFxyXG4gIH0pLFxyXG59KTtcclxuIiwiKGZ1bmN0aW9uKCkge1xyXG4gIHZhciBnZW9sb2NhdGlvbiA9IG5ldyBvbC5HZW9sb2NhdGlvbih7XHJcbiAgICAvLyB0YWtlIHRoZSBwcm9qZWN0aW9uIHRvIHVzZSBmcm9tIHRoZSBtYXAncyB2aWV3XHJcbiAgICBwcm9qZWN0aW9uOiBtYXAuZ2V0VmlldygpLmdldFByb2plY3Rpb24oKSxcclxuICAgIHRyYWNraW5nT3B0aW9uczoge1xyXG4gICAgICBtYXhpbXVtQWdlOiAxMDAwMCxcclxuICAgICAgZW5hYmxlSGlnaEFjY3VyYWN5OiB0cnVlLFxyXG4gICAgICB0aW1lb3V0OiA2MDAwMDBcclxuICAgIH1cclxuICB9KTtcclxuICB2YXIgYWNjdXJhY3lGZWF0dXJlID0gbmV3IG9sLkZlYXR1cmUoKTtcclxuICBnZW9sb2NhdGlvbi5vbignY2hhbmdlOmFjY3VyYWN5R2VvbWV0cnknLCBmdW5jdGlvbigpIHtcclxuICAgIGFjY3VyYWN5RmVhdHVyZS5zZXRHZW9tZXRyeShnZW9sb2NhdGlvbi5nZXRBY2N1cmFjeUdlb21ldHJ5KCkpO1xyXG4gIH0pO1xyXG4gIHZhciBwb3NpdGlvbkZlYXR1cmUgPSBuZXcgb2wuRmVhdHVyZSgpO1xyXG4gIHBvc2l0aW9uRmVhdHVyZS5zZXRTdHlsZShuZXcgb2wuc3R5bGUuU3R5bGUoe1xyXG4gICAgaW1hZ2U6IG5ldyBvbC5zdHlsZS5DaXJjbGUoe1xyXG4gICAgICByYWRpdXM6IDYsXHJcbiAgICAgIGZpbGw6IG5ldyBvbC5zdHlsZS5GaWxsKHtcclxuICAgICAgICBjb2xvcjogJyMzMzk5Q0MnXHJcbiAgICAgIH0pLFxyXG4gICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgIGNvbG9yOiAnI2ZmZicsXHJcbiAgICAgICAgd2lkdGg6IDJcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgfSkpO1xyXG4gIC8vIGxpc3RlbiB0byBjaGFuZ2VzIGluIHBvc2l0aW9uXHJcbiAgZ2VvbG9jYXRpb24ub24oJ2NoYW5nZTpwb3NpdGlvbicsIGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGNvb3JkaW5hdGVzID0gZ2VvbG9jYXRpb24uZ2V0UG9zaXRpb24oKTtcclxuICAgIHBvc2l0aW9uRmVhdHVyZS5zZXRHZW9tZXRyeShjb29yZGluYXRlcyA/IG5ldyBvbC5nZW9tLlBvaW50KGNvb3JkaW5hdGVzKSA6IG51bGwpO1xyXG4gIH0pO1xyXG4gIGZlYXR1cmVzT3ZlcmxheVNvdXJjZSA9IG5ldyBvbC5zb3VyY2UuVmVjdG9yKHt9KTtcclxuICB2YXIgZmVhdHVyZXNPdmVybGF5ID0gbmV3IG9sLmxheWVyLlZlY3Rvcih7XHJcbiAgICBtYXA6IG1hcCxcclxuICAgIHNvdXJjZTogZmVhdHVyZXNPdmVybGF5U291cmNlXHJcbiAgfSk7XHJcbiAgJCgnLmdlb2xvY2F0aW9uJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKGUpIHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGlmICgkKHRoaXMpLnByb3AoJ2NoZWNrZWQnKSA9PT0gdHJ1ZSkge1xyXG4gICAgICBnZW9sb2NhdGlvbi5zZXRUcmFja2luZyh0cnVlKTtcclxuICAgICAgZmVhdHVyZXNPdmVybGF5U291cmNlLmFkZEZlYXR1cmVzKFtwb3NpdGlvbkZlYXR1cmUsYWNjdXJhY3lGZWF0dXJlXSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBnZW9sb2NhdGlvbi5zZXRUcmFja2luZyhmYWxzZSk7XHJcbiAgICAgIGZlYXR1cmVzT3ZlcmxheVNvdXJjZS5jbGVhcigpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59KCkpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgdmFyIGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwb3B1cCcpO1xyXG4gIC8vIHZhciBjb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwLWNvbnRlbnQnKTtcclxuICB2YXIgY2xvc2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BvcHVwLWNsb3NlcicpO1xyXG4gIGNsb3Nlci5vbmNsaWNrID0gZnVuY3Rpb24oKSB7XHJcbiAgICBpbmZvLnNldFBvc2l0aW9uKHVuZGVmaW5lZCk7XHJcbiAgICBjbG9zZXIuYmx1cigpO1xyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG4gIH07XHJcbiAgdmFyIGluZm8gPSBuZXcgb2wuT3ZlcmxheSggLyoqIEB0eXBlIHtvbHguT3ZlcmxheU9wdGlvbnN9ICovICh7XHJcbiAgICBlbGVtZW50OiBjb250YWluZXIsXHJcbiAgICBhdXRvUGFuOiB0cnVlLFxyXG4gICAgYXV0b1BhbkFuaW1hdGlvbjoge1xyXG4gICAgICBkdXJhdGlvbjogMjUwXHJcbiAgICB9XHJcbiAgfSkpO1xyXG4gIG1hcC5hZGRPdmVybGF5KGluZm8pO1xyXG5cclxuICBmdW5jdGlvbiBoYW5kbGVJbmZvKGV2dCkge1xyXG4gICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB2YXIgY29vcmRpbmF0ZSA9IGV2dC5jb29yZGluYXRlO1xyXG4gICAgdmFyIG9iaiA9IHt9O1xyXG4gICAgdmFyIHRpdGxlID0ge307XHJcbiAgICB2YXIgZmVhdHVyZXMgPSBbXTtcclxuICAgIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQubGFuZyA9PT0gJ2VsJykge1xyXG4gICAgICB0aXRsZS50eXBlID0gJ86kz43PgM6/z4InO1xyXG4gICAgICB0aXRsZS5hcmVhID0gJ86VzrzOss6xzrTPjCc7XHJcbiAgICAgIHRpdGxlLmFkZHJlc3MgPSAnzpTOuc61z4XOuM+Fzr3Pg863JztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRpdGxlLnR5cGUgPSAnVHlwZSc7XHJcbiAgICAgIHRpdGxlLmFyZWEgPSAnU2l6ZSc7XHJcbiAgICAgIHRpdGxlLmFkZHJlc3MgPSAnQWRkcmVzcyc7XHJcbiAgICB9XHJcbiAgICBvYmoudGl0bGUgPSB0aXRsZTtcclxuICAgIGNsaWNrZWRGZWF0dXJlID0gbWFwLmZvckVhY2hGZWF0dXJlQXRQaXhlbChldnQucGl4ZWwsIGZ1bmN0aW9uKGZlYXR1cmUsIGxheWVyKSB7XHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgZmVhdHVyZTogZmVhdHVyZSxcclxuICAgICAgICBsYXllcjogbGF5ZXJcclxuICAgICAgfTtcclxuICAgIH0sIHRoaXMsIGZ1bmN0aW9uKGxheWVyKSB7XHJcbiAgICAgIGlmIChsYXllci5nZXQoJ2lkJykgPT09ICdlc3RhdGVzJykge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9LCB0aGlzKTtcclxuICAgIGlmIChjbGlja2VkRmVhdHVyZSkge1xyXG4gICAgICBjbGlja2VkRmVhdHVyZS5mZWF0dXJlLmdldCgnZmVhdHVyZXMnKS5mb3JFYWNoKGZ1bmN0aW9uKGYpIHtcclxuICAgICAgICB2YXIgZmVhdHVyZSA9IHt9O1xyXG4gICAgICAgIHZhciBnaWQgPSBmLmdldCgnZ2lkJyk7XHJcbiAgICAgICAgZmVhdHVyZS50eXBlID0gZi5nZXQoJ2VzdGF0ZXR5cGUnKTtcclxuICAgICAgICBmZWF0dXJlLmFyZWEgPSBmLmdldCgnZXN0YXRlYXJlYScpO1xyXG4gICAgICAgIGZlYXR1cmUuYWRkcmVzcyA9IGYuZ2V0KCdzdHJlZXQnKSArICcgJyArIGYuZ2V0KCdoX251bScpO1xyXG4gICAgICAgIGZlYXR1cmVzLnB1c2goe1xyXG4gICAgICAgICAgZmVhdHVyZTogZmVhdHVyZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIG9iai5mZWF0dXJlcy5naWQgPSBmLmdldCgnZ2lkJyk7XHJcbiAgICAgICAgb2JqLmZlYXR1cmVzID0gZmVhdHVyZXM7XHJcbiAgICAgIH0pO1xyXG4gICAgICBkdXN0LnJlbmRlcignZXN0YXRlSW5mby5kdXN0Jywgb2JqLCBmdW5jdGlvbihlcnIsIG91dCkge1xyXG4gICAgICAgICQoXCIjcG9wdXAtY29udGVudFwiKS5odG1sKG91dCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBkdXN0LnJlbmRlcignZXN0YXRlQ2FyZHMuZHVzdCcsIG9iaiwgZnVuY3Rpb24oZXJyLCBvdXQpIHtcclxuICAgICAgICAkKCcuZXN0YXRlLWNhcmRzJykuaHRtbChvdXQpO1xyXG4gICAgICAgICQoJy5lc3RhdGUtY2FyZHMnKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBpbmZvLnNldFBvc2l0aW9uKGNvb3JkaW5hdGUpO1xyXG4gICAgfVxyXG4gIH1cclxuICAkKCcuaW5mbycpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbihlKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBpZiAoJCh0aGlzKS5wcm9wKCdjaGVja2VkJykgPT09IHRydWUpIHtcclxuICAgICAgbWFwLm9uKCdzaW5nbGVjbGljaycsIGhhbmRsZUluZm8pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbWFwLnVuKCdzaW5nbGVjbGljaycsIGhhbmRsZUluZm8pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59KCkpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgdmFyIG1hcmtlciA9IG5ldyBvbC5GZWF0dXJlKCk7XHJcbiAgdmFyIGljb25TdHlsZSA9IG5ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICBpbWFnZTogbmV3IG9sLnN0eWxlLkljb24oIC8qKiBAdHlwZSB7b2x4LnN0eWxlLkljb25PcHRpb25zfSAqLyAoe1xyXG4gICAgICBhbmNob3I6IFswLjUsIDFdLFxyXG4gICAgICBhbmNob3JYVW5pdHM6ICdmcmFjdGlvbicsXHJcbiAgICAgIGFuY2hvcllVbml0czogJ2ZyYWN0aW9uJyxcclxuICAgICAgb3BhY2l0eTogMSxcclxuICAgICAgc2NhbGU6IDEsXHJcbiAgICAgIHNyYzogJy4uL2ltYWdlcy9tYXAtaWNvbnMvcGlucy8yNC9waW4xLnBuZycsXHJcbiAgICAgIHNuYXBUb1BpeGVsOiBmYWxzZVxyXG4gICAgfSkpLFxyXG4gICAgekluZGV4OiAxMDBcclxuICB9KTtcclxuICBtYXJrZXIuc2V0U3R5bGUoaWNvblN0eWxlKTtcclxuICB2YXIgZmVhdHVyZXNPdmVybGF5U3R5bGUgPSBuZXcgb2wuc3R5bGUuU3R5bGUoe1xyXG4gICAgc3Ryb2tlOiBuZXcgb2wuc3R5bGUuU3Ryb2tlKHtcclxuICAgICAgY29sb3I6ICcjNDA4MDgwJyxcclxuICAgICAgd2lkdGg6IDUsXHJcbiAgICAgIGxpbmVEYXNoOiBbNCwgNF1cclxuICAgIH0pXHJcbiAgfSk7XHJcbiAgdmFyIGZlYXR1cmVzT3ZlcmxheSA9IG5ldyBvbC5sYXllci5WZWN0b3Ioe1xyXG4gICAgbWFwOiBtYXAsXHJcbiAgICBzb3VyY2U6IG5ldyBvbC5zb3VyY2UuVmVjdG9yKCksXHJcbiAgICBzdHlsZTogZmVhdHVyZXNPdmVybGF5U3R5bGUsXHJcbiAgICBpZDogJ3JvdXRlJyxcclxuICAgIG5hbWVFbDogJ86UzrnOsc60z4HOv868zq4nLFxyXG4gICAgTmFtZUVuOiAnUm91dGUnXHJcbiAgfSk7XHJcbiAgdmFyIHJvdXRlQ29vcmRzID0gW107XHJcblxyXG4gIGZ1bmN0aW9uIGhhbmRsZU1hcmtlcihldmVudCkge1xyXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIHZhciBmZWF0dXJlQ291bnQgPSBmZWF0dXJlc092ZXJsYXkuZ2V0U291cmNlKCkuZ2V0RmVhdHVyZXMoKS5sZW5ndGg7XHJcbiAgICB2YXIgY29vcmRpbmF0ZXMgPSBldmVudC5jb29yZGluYXRlO1xyXG4gICAgaWYgKGZlYXR1cmVDb3VudCA9PT0gMCkge1xyXG4gICAgICBtYXJrZXIuc2V0R2VvbWV0cnkobmV3IG9sLmdlb20uUG9pbnQoY29vcmRpbmF0ZXMpKTtcclxuICAgICAgbWFya2VyLnNldElkKCdmaXJzdCcpO1xyXG4gICAgICBmZWF0dXJlc092ZXJsYXkuZ2V0U291cmNlKCkuYWRkRmVhdHVyZShtYXJrZXIpO1xyXG4gICAgICByb3V0ZUNvb3Jkc1swXSA9IGNvb3JkaW5hdGVzWzBdO1xyXG4gICAgICByb3V0ZUNvb3Jkc1sxXSA9IGNvb3JkaW5hdGVzWzFdO1xyXG4gICAgfSBlbHNlIGlmIChmZWF0dXJlQ291bnQgPT09IDEpIHtcclxuICAgICAgdmFyIGNsb25lID0gbWFya2VyLmNsb25lKCk7XHJcbiAgICAgIGNsb25lLnNldEdlb21ldHJ5KG5ldyBvbC5nZW9tLlBvaW50KGNvb3JkaW5hdGVzKSk7XHJcbiAgICAgIGNsb25lLnNldElkKCdzZWNvbmQnKTtcclxuICAgICAgZmVhdHVyZXNPdmVybGF5LmdldFNvdXJjZSgpLmFkZEZlYXR1cmUoY2xvbmUpO1xyXG4gICAgICByb3V0ZUNvb3Jkc1syXSA9IGNvb3JkaW5hdGVzWzBdO1xyXG4gICAgICByb3V0ZUNvb3Jkc1szXSA9IGNvb3JkaW5hdGVzWzFdO1xyXG4gICAgICBjYWxsUm91dGUocm91dGVDb29yZHMpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZmVhdHVyZXNPdmVybGF5LmdldFNvdXJjZSgpLmNsZWFyKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZW9KU09ORm9ybWF0ID0gbmV3IG9sLmZvcm1hdC5HZW9KU09OKHtcclxuICAgIGRlZmF1bHREYXRhUHJvamVjdGlvbjogJ0VQU0c6NDMyNicsXHJcbiAgICBnZW9tZXRyeU5hbWU6ICdnZW9tZXRyeSdcclxuICB9KTtcclxuXHJcbiAgZnVuY3Rpb24gY2FsbFJvdXRlKHJvdXRlQ29vcmRzKSB7XHJcbiAgICB2YXIgZmlyc3QgPSBvbC5wcm9qLnRyYW5zZm9ybShbcm91dGVDb29yZHNbMF0sIHJvdXRlQ29vcmRzWzFdXSwgJ0VQU0c6Mzg1NycsICdFUFNHOjQzMjYnKTtcclxuICAgIHZhciBzZWNvbmQgPSBvbC5wcm9qLnRyYW5zZm9ybShbcm91dGVDb29yZHNbMl0sIHJvdXRlQ29vcmRzWzNdXSwgJ0VQU0c6Mzg1NycsICdFUFNHOjQzMjYnKTtcclxuICAgIHZhciB4MSA9IGZpcnN0WzBdO1xyXG4gICAgdmFyIHkxID0gZmlyc3RbMV07XHJcbiAgICB2YXIgeDIgPSBzZWNvbmRbMF07XHJcbiAgICB2YXIgeTIgPSBzZWNvbmRbMV07XHJcbiAgICAkLmFqYXgoe1xyXG4gICAgICB1cmw6ICdodHRwczovL2FwaS5tYXBib3guY29tL3Y0L2RpcmVjdGlvbnMvbWFwYm94LmRyaXZpbmcvJyArIHgxICsgJywnICsgeTEgKyAnOycgKyB4MiArICcsJyArIHkyICsgJy5qc29uP2FsdGVybmF0aXZlcz1mYWxzZSZhY2Nlc3NfdG9rZW49cGsuZXlKMUlqb2labWx5ZG1GcGJpSXNJbUVpT2lKbE9XWXlZVE0wTlRoaU5XTTBZakpqT0RKak5ERTRPRFF6TnpBMk1HUXlOaUo5Li1OVkRPMjdIenQtd19uUW9zVVBmTEEnLFxyXG4gICAgICB0eXBlOiAnR0VUJyxcclxuICAgICAgZGF0YVR5cGU6ICdqc29uJ1xyXG4gICAgfSkuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgIHZhciByb3V0ZT17fTtcclxuICAgICAgcm91dGUudHlwZSA9XCJGZWF0dXJlXCI7XHJcbiAgICAgIHJvdXRlLmdlb21ldHJ5ID0gZGF0YS5yb3V0ZXNbMF0uZ2VvbWV0cnk7XHJcbiAgICAgIGZlYXR1cmVzT3ZlcmxheS5nZXRTb3VyY2UoKS5hZGRGZWF0dXJlcyhnZW9KU09ORm9ybWF0LnJlYWRGZWF0dXJlcyhyb3V0ZSwge1xyXG4gICAgICAgIGRhdGFQcm9qZWN0aW9uOiAnRVBTRzo0MzI2JyxcclxuICAgICAgICBmZWF0dXJlUHJvamVjdGlvbjogJ0VQU0c6Mzg1NydcclxuICAgICAgfSkpO1xyXG4gICAgICBtYXAuZ2V0VmlldygpLmZpdChmZWF0dXJlc092ZXJsYXkuZ2V0U291cmNlKCkuZ2V0RXh0ZW50KCksIG1hcC5nZXRTaXplKCkpO1xyXG4gICAgfSkuZmFpbChmdW5jdGlvbigpIHtcclxuICAgICAgY29uc29sZS5sb2coXCJlcnJvclwiKTtcclxuICAgIH0pLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuICAgICAgY29uc29sZS5sb2coXCJjb21wbGV0ZVwiKTtcclxuICAgIH0pO1xyXG4gIH1cclxuICAkKCcubWFya2VyJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgLyogQWN0IG9uIHRoZSBldmVudCAqL1xyXG4gICAgaWYgKCQodGhpcykucHJvcCgnY2hlY2tlZCcpID09PSB0cnVlKSB7XHJcbiAgICAgIG1hcC5vbignc2luZ2xlY2xpY2snLCBoYW5kbGVNYXJrZXIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbWFwLnVuKCdzaW5nbGVjbGljaycsIGhhbmRsZU1hcmtlcik7XHJcbiAgICAgIGZlYXR1cmVzT3ZlcmxheS5nZXRTb3VyY2UoKS5jbGVhcigpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59KCkpO1xyXG4iLCIoZnVuY3Rpb24oKSB7XHJcbiAgJCgnLndlYXRoZXInKS5jaGFuZ2UoZnVuY3Rpb24oKSB7XHJcbiAgICBpZiAoJCh0aGlzKS5wcm9wKCdjaGVja2VkJykgPT09IHRydWUpIHtcclxuICAgICAgICBtYXAuZ2V0T3ZlcmxheXMoKS5mb3JFYWNoKGZ1bmN0aW9uKG92bCkge1xyXG4gICAgICAgIGlmIChvdmwuZ2V0KCduYW1lJykgPT09ICd3ZWF0aGVyJykge1xyXG4gICAgICAgICAgKCQob3ZsLmdldEVsZW1lbnQoKSkucGFyZW50KCkpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgJChvdmwuZ2V0RWxlbWVudCgpKS5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICB2YXIgY2VudGVyID0gb2wucHJvai50cmFuc2Zvcm0obWFwLmdldFZpZXcoKS5nZXRDZW50ZXIoKSwgJ0VQU0c6Mzg1NycsICdFUFNHOjQzMjYnKTtcclxuICAgICAgdmFyIGxhdCA9IGNlbnRlclsxXTtcclxuICAgICAgdmFyIGxvbiA9IGNlbnRlclswXTtcclxuICAgICAgJC5hamF4KHtcclxuICAgICAgICB1cmw6ICdodHRwOi8vYXBpLm9wZW53ZWF0aGVybWFwLm9yZy9kYXRhLzIuNS9maW5kP2xhdD0nICsgbGF0ICsgJyZsb249JyArIGxvbiArICcmY250PTUmY2x1c3Rlcj1ubyZ1bml0cz1tZXRyaWMmdHlwZT1hY2N1cmF0ZSZBUFBJRD1mOWNkOWZhMmM0MjdjM2IxMTVlODdlNDg2MjYxOWM1YycsXHJcbiAgICAgICAgdHlwZTogJ0dFVCcsXHJcbiAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgfSkuZG9uZShmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlV2VhdGhlck92ZXJsYXkocG9zaXRpb24sIGluZGV4KSB7XHJcbiAgICAgICAgICB2YXIgZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3dlYXRoZXItcG9wdXAgZGVmYXVsdC1wcmltYXJ5LWNvbG9yIG1kbC1zaGFkb3ctLTZkcCcpO1xyXG4gICAgICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoJ2lkJywgaW5kZXgpO1xyXG4gICAgICAgICAgZWxlbS5zZXRBdHRyaWJ1dGUoJ2RhdGEtbmFtZScsICd3ZWF0aGVyJyk7XHJcbiAgICAgICAgICByZXR1cm4gbmV3IG9sLk92ZXJsYXkoe1xyXG4gICAgICAgICAgICBlbGVtZW50OiBlbGVtLFxyXG4gICAgICAgICAgICBwb3NpdGlvbjogcG9zaXRpb24sXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIG9ianMgPSBkYXRhLmxpc3Q7XHJcbiAgICAgICAgdmFyIG92ZXJsYXksIGNvb3JkaW5hdGVzO1xyXG4gICAgICAgICQuZWFjaChvYmpzLCBmdW5jdGlvbihpbmRleCwgdmFsKSB7XHJcbiAgICAgICAgICBjb29yZGluYXRlcyA9IG9sLnByb2oudHJhbnNmb3JtKFt2YWwuY29vcmQubG9uLCB2YWwuY29vcmQubGF0XSwgJ0VQU0c6NDMyNicsICdFUFNHOjM4NTcnKTtcclxuICAgICAgICAgIG92ZXJsYXkgPSBjcmVhdGVXZWF0aGVyT3ZlcmxheShjb29yZGluYXRlcywgaW5kZXgpO1xyXG4gICAgICAgICAgbWFwLmFkZE92ZXJsYXkob3ZlcmxheSk7XHJcbiAgICAgICAgICBvdmVybGF5LnNldCgnbmFtZScsICd3ZWF0aGVyJyk7XHJcbiAgICAgICAgICB3ZWF0aGVyRGF0YSA9IHtcclxuICAgICAgICAgICAgJ25hbWUnOiB2YWwubmFtZSxcclxuICAgICAgICAgICAgJ3RlbXAnOiB2YWwubWFpbi50ZW1wLFxyXG4gICAgICAgICAgICAncHJlc3N1cmUnOiB2YWwubWFpbi5wcmVzc3VyZSxcclxuICAgICAgICAgICAgJ2h1bWlkaXR5JzogdmFsLm1haW4uaHVtaWRpdHlcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgICBkdXN0LnJlbmRlcignd2VhdGhlclBvcHVwLmR1c3QnLCB3ZWF0aGVyRGF0YSwgZnVuY3Rpb24oZXJyLCBvdXQpIHtcclxuICAgICAgICAgICAgJChcIiNcIiArIGluZGV4KS5odG1sKG91dCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSkuZmFpbChmdW5jdGlvbigpIHtcclxuICAgICAgICAvLyB0b2FzdHIuZXJyb3IoXCLOlM61zr0gzrLPgc6tzrjOt866zrHOvSDPgM67zrfPgc6/z4bOv8+Bzq/Otc+CIM6zzrnOsSDPhM65z4IgzrrOsc65z4HOuc66zq3PgiDPg8+Fzr3OuM6uzrrOtc+CIVwiKTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2UgaWYgKCQodGhpcykucHJvcCgnY2hlY2tlZCcpID09PSBmYWxzZSkge1xyXG4gICAgICBtYXAuZ2V0T3ZlcmxheXMoKS5mb3JFYWNoKGZ1bmN0aW9uKG92bCkge1xyXG4gICAgICAgIGlmIChvdmwuZ2V0KCduYW1lJykgPT09ICd3ZWF0aGVyJykge1xyXG4gICAgICAgICAgKCQob3ZsLmdldEVsZW1lbnQoKSkucGFyZW50KCkpLnJlbW92ZSgpO1xyXG4gICAgICAgICAgJChvdmwuZ2V0RWxlbWVudCgpKS5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59KCkpO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=