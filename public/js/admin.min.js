function PropertyStyle(){var e;return e="../images/map-icons/pins/48/pin1.png",new ol.style.Style({image:new ol.style.Icon({src:e,anchor:[.5,1],scale:.7})})}function clickInfo(e){e.preventDefault();var t={},o=map.forEachFeatureAtPixel(e.pixel,function(e,t){return{feature:e,layer:t}},this,function(e){return"property"===e.get("id")?!0:void 0},this);console.log(o),o?(t.feature={},o.feature.getKeys().forEach(function(e){t.feature[e]=o.feature.get(e)}),console.log(t),dust.render("adminEstateInfo.dust",t,function(e,t){console.log(t),$(".property-info").html(t),$(".property-info").removeClass("visuallyhidden")})):$(".property-info").addClass("visuallyhidden")}var center=[3677385,4120949],extent=[3590094,4102833,3855483,4261211],lang=document.documentElement.lang,styleCache={},geoJSONFormat=new ol.format.GeoJSON({defaultDataProjection:"EPSG:4326"}),bing=new ol.layer.Tile({visible:!0,source:new ol.source.BingMaps({key:"Ak2Gq8VUfICsPpuf7LRANXmXt2sHWmSLPhohmVLFtFIEwYjs_5MCyAhAFwRSVpLj",imagerySet:"Aerial"}),maxZoom:19,crossOrigin:"anonymous",preload:1/0,id:"bing"}),mapbox=new ol.layer.Tile({source:new ol.source.XYZ({attributions:[new ol.Attribution({html:'<a href="https://www.mapbox.com/about/maps/" target="_blank">&copy; Mapbox &copy; OpenStreetMap</a>'})],url:"https://api.mapbox.com/v4/mapbox.streets/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiZmlydmFpbiIsImEiOiJlOWYyYTM0NThiNWM0YjJjODJjNDE4ODQzNzA2MGQyNiJ9.-NVDO27Hzt-w_nQosUPfLA"}),id:"mapbox"}),propertySource=new ol.source.Vector({format:geoJSONFormat,loader:function(e,t,o){var l="http://localhost:3000/db/admin",r=this;this.clear(),$.ajax({url:l,type:"POST",beforeSend:function(e){localStorage.getItem("userToken")&&e.setRequestHeader("Authorization","Bearer "+localStorage.getItem("userToken"))},dataType:"json",data:{id:id}}).done(function(e){var t=geoJSONFormat.readFeatures(e,{featureProjection:"EPSG:3857"});r.addFeatures(t)}).fail(function(){console.log("error")})},strategy:ol.loadingstrategy.all}),property=new ol.layer.Vector({source:propertySource,id:"property",visible:!0,style:PropertyStyle()});property.setZIndex(2);var map=new ol.Map({target:"adminMap",layers:[mapbox,property],loadTilesWhileAnimating:!0,loadTilesWhileInteracting:!0,renderer:"canvas",controls:ol.control.defaults({attributionOptions:{collapsible:!1,collapsed:!1}}).extend([new ol.control.ScaleLine({units:"metric"}),new ol.control.OverviewMap({className:"ol-overviewmap ol-custom-overviewmap",collapsible:!0,collapsed:!0,layers:[bing]}),new ol.control.ZoomToExtent({extent:extent})]),view:new ol.View({center:center,projection:"EPSG:3857",zoom:14,maxZoom:19,minZoom:10})});"el"===lang?(bing.set("name","Δορυφορική εικόνα"),mapbox.set("name","Χάρτης"),property.set("name","Ακίνητα")):(bing.set("name","Sattelite Image"),mapbox.set("name","Map"),property.set("name","Properties"));var features=new ol.Collection,drawnProperties=new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})}),id:"drawnProperties"});map.addLayer(drawnProperties);var draw=new ol.interaction.Draw({source:drawnProperties.getSource(),type:"Point",style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})})});map.addInteraction(draw),draw.setActive(!1);var select=new ol.interaction.Select({layers:[property],features:features,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 0, 0, 0.2)"}),stroke:new ol.style.Stroke({color:"#FF00003",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#FF0000"})})})});map.addInteraction(select),select.setActive(!1);var translate=new ol.interaction.Translate({features:select.getFeatures()});map.on("click",clickInfo),$("#insertProperty").click(function(){$(".property-info").addClass("visuallyhidden"),toastr.options={positionClass:"toast-top-center"},toastr.info("Add New Property"),map.un("click",clickInfo),select.setActive(!1),draw.setActive(!0),draw.on("drawend",function(e){draw.setActive(!1)})}),$("#deleteProperty").click(function(e){$(".property-info").addClass("visuallyhidden"),toastr.options={positionClass:"toast-top-center"},toastr.info("Delete Property"),map.un("click",clickInfo),draw.setActive(!1),features.clear(),select.setActive(!0),select.on("select",function(e){if(1===e.target.getFeatures().getLength()){toastr.options.newestOnTop=!0,toastr.options.preventDuplicates=!0,toastr.options.extendedTimeOut=0,toastr.options.timeOut=0,toastr.options.closeButton=!0;var t=toastr.warning('<p>Are you sure?</p><div class="toastr-btns"><button id="yesDelete" class="mdl-button mdl-js-button ">Yes</button><button id="noDelete" class="mdl-button mdl-js-button">No</button></div>');t.find("#yesDelete").length&&t.on("click","#yesDelete",function(){alert("you clicked ok"),t.remove()}),t.find("#noDelete").length&&t.on("click","#noDelete",function(){alert("Surprise! you clicked me.")})}})}),$("#logout").click(function(){location.href="/map/logout"});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluLmpzIl0sIm5hbWVzIjpbIlByb3BlcnR5U3R5bGUiLCJzcmMiLCJvbCIsInN0eWxlIiwiU3R5bGUiLCJpbWFnZSIsIkljb24iLCJhbmNob3IiLCJzY2FsZSIsImNsaWNrSW5mbyIsImV2dCIsInByZXZlbnREZWZhdWx0Iiwib2JqIiwiY2xpY2tlZEZlYXR1cmUiLCJtYXAiLCJmb3JFYWNoRmVhdHVyZUF0UGl4ZWwiLCJwaXhlbCIsImZlYXR1cmUiLCJsYXllciIsInRoaXMiLCJnZXQiLCJjb25zb2xlIiwibG9nIiwiZ2V0S2V5cyIsImZvckVhY2giLCJrZXkiLCJkdXN0IiwicmVuZGVyIiwiZXJyIiwib3V0IiwiJCIsImh0bWwiLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwiY2VudGVyIiwiZXh0ZW50IiwibGFuZyIsImRvY3VtZW50IiwiZG9jdW1lbnRFbGVtZW50Iiwic3R5bGVDYWNoZSIsImdlb0pTT05Gb3JtYXQiLCJmb3JtYXQiLCJHZW9KU09OIiwiZGVmYXVsdERhdGFQcm9qZWN0aW9uIiwiYmluZyIsIlRpbGUiLCJ2aXNpYmxlIiwic291cmNlIiwiQmluZ01hcHMiLCJpbWFnZXJ5U2V0IiwibWF4Wm9vbSIsImNyb3NzT3JpZ2luIiwicHJlbG9hZCIsIkluZmluaXR5IiwiaWQiLCJtYXBib3giLCJYWVoiLCJhdHRyaWJ1dGlvbnMiLCJBdHRyaWJ1dGlvbiIsInVybCIsInByb3BlcnR5U291cmNlIiwiVmVjdG9yIiwibG9hZGVyIiwicmVzb2x1dGlvbiIsInByb2plY3Rpb24iLCJ0aGF0IiwiY2xlYXIiLCJhamF4IiwidHlwZSIsImJlZm9yZVNlbmQiLCJ4aHIiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwic2V0UmVxdWVzdEhlYWRlciIsImRhdGFUeXBlIiwiZGF0YSIsImRvbmUiLCJyZXNwb25zZSIsImZlYXR1cmVzIiwicmVhZEZlYXR1cmVzIiwiZmVhdHVyZVByb2plY3Rpb24iLCJhZGRGZWF0dXJlcyIsImZhaWwiLCJzdHJhdGVneSIsImxvYWRpbmdzdHJhdGVneSIsImFsbCIsInByb3BlcnR5Iiwic2V0WkluZGV4IiwiTWFwIiwidGFyZ2V0IiwibGF5ZXJzIiwibG9hZFRpbGVzV2hpbGVBbmltYXRpbmciLCJsb2FkVGlsZXNXaGlsZUludGVyYWN0aW5nIiwicmVuZGVyZXIiLCJjb250cm9scyIsImNvbnRyb2wiLCJkZWZhdWx0cyIsImF0dHJpYnV0aW9uT3B0aW9ucyIsImNvbGxhcHNpYmxlIiwiY29sbGFwc2VkIiwiZXh0ZW5kIiwiU2NhbGVMaW5lIiwidW5pdHMiLCJPdmVydmlld01hcCIsImNsYXNzTmFtZSIsIlpvb21Ub0V4dGVudCIsInZpZXciLCJWaWV3Iiwiem9vbSIsIm1pblpvb20iLCJzZXQiLCJDb2xsZWN0aW9uIiwiZHJhd25Qcm9wZXJ0aWVzIiwiZmlsbCIsIkZpbGwiLCJjb2xvciIsInN0cm9rZSIsIlN0cm9rZSIsIndpZHRoIiwiQ2lyY2xlIiwicmFkaXVzIiwiYWRkTGF5ZXIiLCJkcmF3IiwiaW50ZXJhY3Rpb24iLCJEcmF3IiwiZ2V0U291cmNlIiwiYWRkSW50ZXJhY3Rpb24iLCJzZXRBY3RpdmUiLCJzZWxlY3QiLCJTZWxlY3QiLCJ0cmFuc2xhdGUiLCJUcmFuc2xhdGUiLCJnZXRGZWF0dXJlcyIsIm9uIiwiY2xpY2siLCJ0b2FzdHIiLCJvcHRpb25zIiwicG9zaXRpb25DbGFzcyIsImluZm8iLCJ1biIsImV2ZW50IiwiZSIsImdldExlbmd0aCIsIm5ld2VzdE9uVG9wIiwicHJldmVudER1cGxpY2F0ZXMiLCJleHRlbmRlZFRpbWVPdXQiLCJ0aW1lT3V0IiwiY2xvc2VCdXR0b24iLCIkdG9hc3QiLCJ3YXJuaW5nIiwiZmluZCIsImxlbmd0aCIsImFsZXJ0IiwicmVtb3ZlIiwibG9jYXRpb24iLCJocmVmIl0sIm1hcHBpbmdzIjoiQUE0QkEsUUFBQUEsaUJBQ0EsR0FBQUMsRUFFQSxPQURBQSxHQUFBLHVDQUNBLEdBQUFDLElBQUFDLE1BQUFDLE9BQ0FDLE1BQUEsR0FBQUgsSUFBQUMsTUFBQUcsTUFDQUwsSUFBQUEsRUFDQU0sUUFBQSxHQUFBLEdBQ0FDLE1BQUEsT0E4SkEsUUFBQUMsV0FBQUMsR0FDQUEsRUFBQUMsZ0JBQ0EsSUFBQUMsTUFDQUMsRUFBQUMsSUFBQUMsc0JBQUFMLEVBQUFNLE1BQUEsU0FBQUMsRUFBQUMsR0FDQSxPQUNBRCxRQUFBQSxFQUNBQyxNQUFBQSxJQUVBQyxLQUFBLFNBQUFELEdBQ0EsTUFBQSxhQUFBQSxFQUFBRSxJQUFBLE9BQ0EsRUFEQSxRQUdBRCxLQUNBRSxTQUFBQyxJQUFBVCxHQUNBQSxHQUNBRCxFQUFBSyxXQUNBSixFQUFBSSxRQUFBTSxVQUFBQyxRQUFBLFNBQUFDLEdBQ0FiLEVBQUFLLFFBQUFRLEdBQUFaLEVBQUFJLFFBQUFHLElBQUFLLEtBRUFKLFFBQUFDLElBQUFWLEdBQ0FjLEtBQUFDLE9BQUEsdUJBQUFmLEVBQUEsU0FBQWdCLEVBQUFDLEdBQ0FSLFFBQUFDLElBQUFPLEdBQ0FDLEVBQUEsa0JBQUFDLEtBQUFGLEdBQ0FDLEVBQUEsa0JBQUFFLFlBQUEscUJBR0FGLEVBQUEsa0JBQUFHLFNBQUEsa0JBM05BLEdBQUFDLFNBQUEsUUFBQSxTQUNBQyxRQUFBLFFBQUEsUUFBQSxRQUFBLFNBQ0FDLEtBQUFDLFNBQUFDLGdCQUFBRixLQUNBRyxjQUNBQyxjQUFBLEdBQUF0QyxJQUFBdUMsT0FBQUMsU0FDQUMsc0JBQUEsY0FFQUMsS0FBQSxHQUFBMUMsSUFBQWdCLE1BQUEyQixNQUNBQyxTQUFBLEVBQ0FDLE9BQUEsR0FBQTdDLElBQUE2QyxPQUFBQyxVQUNBdkIsSUFBQSxtRUFDQXdCLFdBQUEsV0FFQUMsUUFBQSxHQUNBQyxZQUFBLFlBQ0FDLFFBQUFDLEVBQUFBLEVBQ0FDLEdBQUEsU0FFQUMsT0FBQSxHQUFBckQsSUFBQWdCLE1BQUEyQixNQUNBRSxPQUFBLEdBQUE3QyxJQUFBNkMsT0FBQVMsS0FDQUMsY0FBQSxHQUFBdkQsSUFBQXdELGFBQ0EzQixLQUFBLHlHQUVBNEIsSUFBQSw2S0FFQUwsR0FBQSxXQWNBTSxlQUFBLEdBQUExRCxJQUFBNkMsT0FBQWMsUUFDQXBCLE9BQUFELGNBQ0FzQixPQUFBLFNBQUEzQixFQUFBNEIsRUFBQUMsR0FDQSxHQUFBTCxHQUFBLGlDQUNBTSxFQUFBOUMsSUFDQUEsTUFBQStDLFFBQ0FwQyxFQUFBcUMsTUFDQVIsSUFBQUEsRUFDQVMsS0FBQSxPQUNBQyxXQUFBLFNBQUFDLEdBQ0FDLGFBQUFDLFFBQUEsY0FDQUYsRUFBQUcsaUJBQUEsZ0JBQUEsVUFBQUYsYUFBQUMsUUFBQSxlQUdBRSxTQUFBLE9BQ0FDLE1BQ0FyQixHQUFBQSxNQUVBc0IsS0FBQSxTQUFBQyxHQUNBLEdBQUFDLEdBQUF0QyxjQUFBdUMsYUFBQUYsR0FDQUcsa0JBQUEsYUFFQWYsR0FBQWdCLFlBQUFILEtBQ0FJLEtBQUEsV0FDQTdELFFBQUFDLElBQUEsWUFHQTZELFNBQUFqRixHQUFBa0YsZ0JBQUFDLE1BRUFDLFNBQUEsR0FBQXBGLElBQUFnQixNQUFBMkMsUUFDQWQsT0FBQWEsZUFDQU4sR0FBQSxXQUNBUixTQUFBLEVBQ0EzQyxNQUFBSCxpQkFFQXNGLFVBQUFDLFVBQUEsRUFDQSxJQUFBekUsS0FBQSxHQUFBWixJQUFBc0YsS0FDQUMsT0FBQSxXQUNBQyxRQUFBbkMsT0FBQStCLFVBQ0FLLHlCQUFBLEVBQ0FDLDJCQUFBLEVBQ0FDLFNBQUEsU0FDQUMsU0FBQTVGLEdBQUE2RixRQUFBQyxVQUNBQyxvQkFDQUMsYUFBQSxFQUNBQyxXQUFBLEtBRUFDLFFBQ0EsR0FBQWxHLElBQUE2RixRQUFBTSxXQUNBQyxNQUFBLFdBQ0EsR0FBQXBHLElBQUE2RixRQUFBUSxhQUNBQyxVQUFBLHVDQUNBTixhQUFBLEVBQ0FDLFdBQUEsRUFDQVQsUUFBQTlDLFFBRUEsR0FBQTFDLElBQUE2RixRQUFBVSxjQUNBdEUsT0FBQUEsV0FHQXVFLEtBQUEsR0FBQXhHLElBQUF5RyxNQUNBekUsT0FBQUEsT0FFQThCLFdBQUEsWUFDQTRDLEtBQUEsR0FDQTFELFFBQUEsR0FDQTJELFFBQUEsTUFHQSxRQUFBekUsTUFDQVEsS0FBQWtFLElBQUEsT0FBQSxxQkFDQXZELE9BQUF1RCxJQUFBLE9BQUEsVUFDQXhCLFNBQUF3QixJQUFBLE9BQUEsYUFFQWxFLEtBQUFrRSxJQUFBLE9BQUEsbUJBQ0F2RCxPQUFBdUQsSUFBQSxPQUFBLE9BQ0F4QixTQUFBd0IsSUFBQSxPQUFBLGNBR0EsSUFBQWhDLFVBQUEsR0FBQTVFLElBQUE2RyxXQUNBQyxnQkFBQSxHQUFBOUcsSUFBQWdCLE1BQUEyQyxRQUNBZCxPQUFBLEdBQUE3QyxJQUFBNkMsT0FBQWMsT0FDQTFELE1BQUEsR0FBQUQsSUFBQUMsTUFBQUMsT0FDQTZHLEtBQUEsR0FBQS9HLElBQUFDLE1BQUErRyxNQUNBQyxNQUFBLDZCQUVBQyxPQUFBLEdBQUFsSCxJQUFBQyxNQUFBa0gsUUFDQUYsTUFBQSxVQUNBRyxNQUFBLElBRUFqSCxNQUFBLEdBQUFILElBQUFDLE1BQUFvSCxRQUNBQyxPQUFBLEVBQ0FQLEtBQUEsR0FBQS9HLElBQUFDLE1BQUErRyxNQUNBQyxNQUFBLGdCQUlBN0QsR0FBQSxtQkFFQXhDLEtBQUEyRyxTQUFBVCxnQkFFQSxJQUFBVSxNQUFBLEdBQUF4SCxJQUFBeUgsWUFBQUMsTUFFQTdFLE9BQUFpRSxnQkFBQWEsWUFDQXpELEtBQUEsUUFDQWpFLE1BQUEsR0FBQUQsSUFBQUMsTUFBQUMsT0FDQTZHLEtBQUEsR0FBQS9HLElBQUFDLE1BQUErRyxNQUNBQyxNQUFBLDZCQUVBQyxPQUFBLEdBQUFsSCxJQUFBQyxNQUFBa0gsUUFDQUYsTUFBQSxVQUNBRyxNQUFBLElBRUFqSCxNQUFBLEdBQUFILElBQUFDLE1BQUFvSCxRQUNBQyxPQUFBLEVBQ0FQLEtBQUEsR0FBQS9HLElBQUFDLE1BQUErRyxNQUNBQyxNQUFBLGlCQUtBckcsS0FBQWdILGVBQUFKLE1BQ0FBLEtBQUFLLFdBQUEsRUFFQSxJQUFBQyxRQUFBLEdBQUE5SCxJQUFBeUgsWUFBQU0sUUFDQXZDLFFBQ0FKLFVBRUFSLFNBQUFBLFNBQ0EzRSxNQUFBLEdBQUFELElBQUFDLE1BQUFDLE9BQ0E2RyxLQUFBLEdBQUEvRyxJQUFBQyxNQUFBK0csTUFDQUMsTUFBQSx5QkFFQUMsT0FBQSxHQUFBbEgsSUFBQUMsTUFBQWtILFFBQ0FGLE1BQUEsV0FDQUcsTUFBQSxJQUVBakgsTUFBQSxHQUFBSCxJQUFBQyxNQUFBb0gsUUFDQUMsT0FBQSxFQUNBUCxLQUFBLEdBQUEvRyxJQUFBQyxNQUFBK0csTUFDQUMsTUFBQSxpQkFLQXJHLEtBQUFnSCxlQUFBRSxRQUNBQSxPQUFBRCxXQUFBLEVBRUEsSUFBQUcsV0FBQSxHQUFBaEksSUFBQXlILFlBQUFRLFdBQ0FyRCxTQUFBa0QsT0FBQUksZUFHQXRILEtBQUF1SCxHQUFBLFFBQUE1SCxXQWdDQXFCLEVBQUEsbUJBQUF3RyxNQUFBLFdBQ0F4RyxFQUFBLGtCQUFBRyxTQUFBLGtCQUNBc0csT0FBQUMsU0FDQUMsY0FBQSxvQkFFQUYsT0FBQUcsS0FBQSxvQkFDQTVILElBQUE2SCxHQUFBLFFBQUFsSSxXQUNBdUgsT0FBQUQsV0FBQSxHQUNBTCxLQUFBSyxXQUFBLEdBQ0FMLEtBQUFXLEdBQUEsVUFBQSxTQUFBM0gsR0FDQWdILEtBQUFLLFdBQUEsT0FJQWpHLEVBQUEsbUJBQUF3RyxNQUFBLFNBQUFNLEdBQ0E5RyxFQUFBLGtCQUFBRyxTQUFBLGtCQUNBc0csT0FBQUMsU0FDQUMsY0FBQSxvQkFFQUYsT0FBQUcsS0FBQSxtQkFDQTVILElBQUE2SCxHQUFBLFFBQUFsSSxXQUNBaUgsS0FBQUssV0FBQSxHQUNBakQsU0FBQVosUUFDQThELE9BQUFELFdBQUEsR0FDQUMsT0FBQUssR0FBQSxTQUFBLFNBQUFRLEdBQ0EsR0FBQSxJQUFBQSxFQUFBcEQsT0FBQTJDLGNBQUFVLFlBQUEsQ0FDQVAsT0FBQUMsUUFBQU8sYUFBQSxFQUNBUixPQUFBQyxRQUFBUSxtQkFBQSxFQUNBVCxPQUFBQyxRQUFBUyxnQkFBQSxFQUNBVixPQUFBQyxRQUFBVSxRQUFBLEVBQ0FYLE9BQUFDLFFBQUFXLGFBQUEsQ0FDQSxJQUFBQyxHQUFBYixPQUFBYyxRQUFBLDZMQUNBRCxHQUFBRSxLQUFBLGNBQUFDLFFBQ0FILEVBQUFmLEdBQUEsUUFBQSxhQUFBLFdBQ0FtQixNQUFBLGtCQUNBSixFQUFBSyxXQUdBTCxFQUFBRSxLQUFBLGFBQUFDLFFBQ0FILEVBQUFmLEdBQUEsUUFBQSxZQUFBLFdBQ0FtQixNQUFBLG9DQU1BMUgsRUFBQSxXQUFBd0csTUFBQSxXQUNBb0IsU0FBQUMsS0FBQSIsImZpbGUiOiJhZG1pbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIgdmFyIGNlbnRlciA9IFszNjc3Mzg1LCA0MTIwOTQ5XSxcclxuICAgZXh0ZW50ID0gWzM1OTAwOTQsIDQxMDI4MzMsIDM4NTU0ODMsIDQyNjEyMTFdLFxyXG4gICBsYW5nID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmxhbmcsXHJcbiAgIHN0eWxlQ2FjaGUgPSB7fSxcclxuICAgZ2VvSlNPTkZvcm1hdCA9IG5ldyBvbC5mb3JtYXQuR2VvSlNPTih7XHJcbiAgICAgZGVmYXVsdERhdGFQcm9qZWN0aW9uOiAnRVBTRzo0MzI2J1xyXG4gICB9KTtcclxuIHZhciBiaW5nID0gbmV3IG9sLmxheWVyLlRpbGUoe1xyXG4gICB2aXNpYmxlOiB0cnVlLFxyXG4gICBzb3VyY2U6IG5ldyBvbC5zb3VyY2UuQmluZ01hcHMoe1xyXG4gICAgIGtleTogJ0FrMkdxOFZVZklDc1BwdWY3TFJBTlhtWHQyc0hXbVNMUGhvaG1WTEZ0RklFd1lqc181TUN5QWhBRndSU1ZwTGonLFxyXG4gICAgIGltYWdlcnlTZXQ6ICdBZXJpYWwnXHJcbiAgIH0pLFxyXG4gICBtYXhab29tOiAxOSxcclxuICAgY3Jvc3NPcmlnaW46ICdhbm9ueW1vdXMnLFxyXG4gICBwcmVsb2FkOiBJbmZpbml0eSxcclxuICAgaWQ6ICdiaW5nJ1xyXG4gfSk7XHJcbiB2YXIgbWFwYm94ID0gbmV3IG9sLmxheWVyLlRpbGUoe1xyXG4gICBzb3VyY2U6IG5ldyBvbC5zb3VyY2UuWFlaKHtcclxuICAgICBhdHRyaWJ1dGlvbnM6IFtuZXcgb2wuQXR0cmlidXRpb24oe1xyXG4gICAgICAgaHRtbDogJzxhIGhyZWY9XFxcImh0dHBzOi8vd3d3Lm1hcGJveC5jb20vYWJvdXQvbWFwcy9cXFwiIHRhcmdldD1cXFwiX2JsYW5rXFxcIj4mY29weTsgTWFwYm94ICZjb3B5OyBPcGVuU3RyZWV0TWFwPC9hPidcclxuICAgICB9KV0sXHJcbiAgICAgdXJsOiAnaHR0cHM6Ly9hcGkubWFwYm94LmNvbS92NC9tYXBib3guc3RyZWV0cy97en0ve3h9L3t5fS5wbmc/YWNjZXNzX3Rva2VuPXBrLmV5SjFJam9pWm1seWRtRnBiaUlzSW1FaU9pSmxPV1l5WVRNME5UaGlOV00wWWpKak9ESmpOREU0T0RRek56QTJNR1F5TmlKOS4tTlZETzI3SHp0LXdfblFvc1VQZkxBJ1xyXG4gICB9KSxcclxuICAgaWQ6ICdtYXBib3gnXHJcbiB9KTtcclxuXHJcbiBmdW5jdGlvbiBQcm9wZXJ0eVN0eWxlKCkge1xyXG4gICB2YXIgc3JjO1xyXG4gICBzcmMgPSAnLi4vaW1hZ2VzL21hcC1pY29ucy9waW5zLzQ4L3BpbjEucG5nJztcclxuICAgcmV0dXJuIG5ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICAgaW1hZ2U6IG5ldyBvbC5zdHlsZS5JY29uKCh7XHJcbiAgICAgICBzcmM6IHNyYyxcclxuICAgICAgIGFuY2hvcjogWzAuNSwgMV0sXHJcbiAgICAgICBzY2FsZTogMC43LFxyXG4gICAgIH0pKVxyXG4gICB9KTtcclxuIH1cclxuIHZhciBwcm9wZXJ0eVNvdXJjZSA9IG5ldyBvbC5zb3VyY2UuVmVjdG9yKHtcclxuICAgZm9ybWF0OiBnZW9KU09ORm9ybWF0LFxyXG4gICBsb2FkZXI6IGZ1bmN0aW9uKGV4dGVudCwgcmVzb2x1dGlvbiwgcHJvamVjdGlvbikge1xyXG4gICAgIHZhciB1cmwgPSAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2RiL2FkbWluJztcclxuICAgICB2YXIgdGhhdCA9IHRoaXM7XHJcbiAgICAgdGhpcy5jbGVhcigpO1xyXG4gICAgICQuYWpheCh7XHJcbiAgICAgICB1cmw6IHVybCxcclxuICAgICAgIHR5cGU6ICdQT1NUJyxcclxuICAgICAgICdiZWZvcmVTZW5kJzogZnVuY3Rpb24oeGhyKSB7XHJcbiAgICAgICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlclRva2VuJykpIHtcclxuICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQXV0aG9yaXphdGlvbicsICdCZWFyZXIgJyArIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyVG9rZW4nKSk7XHJcbiAgICAgICAgIH1cclxuICAgICAgIH0sXHJcbiAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxyXG4gICAgICAgZGF0YToge1xyXG4gICAgICAgICBpZDogaWRcclxuICAgICAgIH0sXHJcbiAgICAgfSkuZG9uZShmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgdmFyIGZlYXR1cmVzID0gZ2VvSlNPTkZvcm1hdC5yZWFkRmVhdHVyZXMocmVzcG9uc2UsIHtcclxuICAgICAgICAgZmVhdHVyZVByb2plY3Rpb246ICdFUFNHOjM4NTcnXHJcbiAgICAgICB9KTtcclxuICAgICAgIHRoYXQuYWRkRmVhdHVyZXMoZmVhdHVyZXMpO1xyXG4gICAgIH0pLmZhaWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICBjb25zb2xlLmxvZyhcImVycm9yXCIpO1xyXG4gICAgIH0pO1xyXG4gICB9LFxyXG4gICBzdHJhdGVneTogb2wubG9hZGluZ3N0cmF0ZWd5LmFsbFxyXG4gfSk7XHJcbiB2YXIgcHJvcGVydHkgPSBuZXcgb2wubGF5ZXIuVmVjdG9yKHtcclxuICAgc291cmNlOiBwcm9wZXJ0eVNvdXJjZSxcclxuICAgaWQ6ICdwcm9wZXJ0eScsXHJcbiAgIHZpc2libGU6IHRydWUsXHJcbiAgIHN0eWxlOiBQcm9wZXJ0eVN0eWxlKClcclxuIH0pO1xyXG4gcHJvcGVydHkuc2V0WkluZGV4KDIpO1xyXG4gdmFyIG1hcCA9IG5ldyBvbC5NYXAoe1xyXG4gICB0YXJnZXQ6ICdhZG1pbk1hcCcsXHJcbiAgIGxheWVyczogW21hcGJveCwgcHJvcGVydHldLFxyXG4gICBsb2FkVGlsZXNXaGlsZUFuaW1hdGluZzogdHJ1ZSxcclxuICAgbG9hZFRpbGVzV2hpbGVJbnRlcmFjdGluZzogdHJ1ZSxcclxuICAgcmVuZGVyZXI6ICdjYW52YXMnLFxyXG4gICBjb250cm9sczogb2wuY29udHJvbC5kZWZhdWx0cyh7XHJcbiAgICAgYXR0cmlidXRpb25PcHRpb25zOiB7XHJcbiAgICAgICBjb2xsYXBzaWJsZTogZmFsc2UsXHJcbiAgICAgICBjb2xsYXBzZWQ6IGZhbHNlXHJcbiAgICAgfVxyXG4gICB9KS5leHRlbmQoW1xyXG4gICAgIG5ldyBvbC5jb250cm9sLlNjYWxlTGluZSh7XHJcbiAgICAgICB1bml0czogJ21ldHJpYydcclxuICAgICB9KSwgbmV3IG9sLmNvbnRyb2wuT3ZlcnZpZXdNYXAoe1xyXG4gICAgICAgY2xhc3NOYW1lOiAnb2wtb3ZlcnZpZXdtYXAgb2wtY3VzdG9tLW92ZXJ2aWV3bWFwJyxcclxuICAgICAgIGNvbGxhcHNpYmxlOiB0cnVlLFxyXG4gICAgICAgY29sbGFwc2VkOiB0cnVlLFxyXG4gICAgICAgbGF5ZXJzOiBbYmluZ11cclxuICAgICB9KSxcclxuICAgICBuZXcgb2wuY29udHJvbC5ab29tVG9FeHRlbnQoe1xyXG4gICAgICAgZXh0ZW50OiBleHRlbnRcclxuICAgICB9KVxyXG4gICBdKSxcclxuICAgdmlldzogbmV3IG9sLlZpZXcoe1xyXG4gICAgIGNlbnRlcjogY2VudGVyLFxyXG4gICAgIC8vIGV4dGVudDogZXh0ZW50LFxyXG4gICAgIHByb2plY3Rpb246ICdFUFNHOjM4NTcnLFxyXG4gICAgIHpvb206IDE0LFxyXG4gICAgIG1heFpvb206IDE5LFxyXG4gICAgIG1pblpvb206IDEwXHJcbiAgIH0pXHJcbiB9KTtcclxuIGlmIChsYW5nID09PSAnZWwnKSB7XHJcbiAgIGJpbmcuc2V0KCduYW1lJywgJ86Uzr/Pgc+Fz4bOv8+BzrnOus6uIM61zrnOus+Mzr3OsScpO1xyXG4gICBtYXBib3guc2V0KCduYW1lJywgJ86nzqzPgc+EzrfPgicpO1xyXG4gICBwcm9wZXJ0eS5zZXQoJ25hbWUnLCAnzpHOus6vzr3Ot8+EzrEnKTtcclxuIH0gZWxzZSB7XHJcbiAgIGJpbmcuc2V0KCduYW1lJywgJ1NhdHRlbGl0ZSBJbWFnZScpO1xyXG4gICBtYXBib3guc2V0KCduYW1lJywgJ01hcCcpO1xyXG4gICBwcm9wZXJ0eS5zZXQoJ25hbWUnLCAnUHJvcGVydGllcycpO1xyXG4gfVxyXG4gLy89PT09PT0gaW50ZXJhY3Rpb25zID09PT09PVxyXG4gdmFyIGZlYXR1cmVzID0gbmV3IG9sLkNvbGxlY3Rpb24oKTtcclxuIHZhciBkcmF3blByb3BlcnRpZXMgPSBuZXcgb2wubGF5ZXIuVmVjdG9yKHtcclxuICAgc291cmNlOiBuZXcgb2wuc291cmNlLlZlY3RvcigpLFxyXG4gICBzdHlsZTogbmV3IG9sLnN0eWxlLlN0eWxlKHtcclxuICAgICBmaWxsOiBuZXcgb2wuc3R5bGUuRmlsbCh7XHJcbiAgICAgICBjb2xvcjogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKSdcclxuICAgICB9KSxcclxuICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgY29sb3I6ICcjZmZjYzMzJyxcclxuICAgICAgIHdpZHRoOiAyXHJcbiAgICAgfSksXHJcbiAgICAgaW1hZ2U6IG5ldyBvbC5zdHlsZS5DaXJjbGUoe1xyXG4gICAgICAgcmFkaXVzOiA3LFxyXG4gICAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xyXG4gICAgICAgICBjb2xvcjogJyNmZmNjMzMnXHJcbiAgICAgICB9KVxyXG4gICAgIH0pXHJcbiAgIH0pLFxyXG4gICBpZDogJ2RyYXduUHJvcGVydGllcydcclxuIH0pO1xyXG4gbWFwLmFkZExheWVyKGRyYXduUHJvcGVydGllcyk7XHJcbiAvL2RyYXdcclxuIHZhciBkcmF3ID0gbmV3IG9sLmludGVyYWN0aW9uLkRyYXcoe1xyXG4gICAvLyBmZWF0dXJlczogZmVhdHVyZXMsXHJcbiAgIHNvdXJjZTogZHJhd25Qcm9wZXJ0aWVzLmdldFNvdXJjZSgpLFxyXG4gICB0eXBlOiAnUG9pbnQnLFxyXG4gICBzdHlsZTogbmV3IG9sLnN0eWxlLlN0eWxlKHtcclxuICAgICBmaWxsOiBuZXcgb2wuc3R5bGUuRmlsbCh7XHJcbiAgICAgICBjb2xvcjogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKSdcclxuICAgICB9KSxcclxuICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgY29sb3I6ICcjZmZjYzMzJyxcclxuICAgICAgIHdpZHRoOiAyXHJcbiAgICAgfSksXHJcbiAgICAgaW1hZ2U6IG5ldyBvbC5zdHlsZS5DaXJjbGUoe1xyXG4gICAgICAgcmFkaXVzOiA3LFxyXG4gICAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xyXG4gICAgICAgICBjb2xvcjogJyNmZmNjMzMnXHJcbiAgICAgICB9KVxyXG4gICAgIH0pXHJcbiAgIH0pXHJcbiB9KTtcclxuIG1hcC5hZGRJbnRlcmFjdGlvbihkcmF3KTtcclxuIGRyYXcuc2V0QWN0aXZlKGZhbHNlKTtcclxuIC8vc2VsZWN0XHJcbiB2YXIgc2VsZWN0ID0gbmV3IG9sLmludGVyYWN0aW9uLlNlbGVjdCh7XHJcbiAgIGxheWVyczogW1xyXG4gICAgIHByb3BlcnR5XHJcbiAgIF0sXHJcbiAgIGZlYXR1cmVzOiBmZWF0dXJlcyxcclxuICAgc3R5bGU6IG5ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xyXG4gICAgICAgY29sb3I6ICdyZ2JhKDI1NSwgMCwgMCwgMC4yKSdcclxuICAgICB9KSxcclxuICAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xyXG4gICAgICAgY29sb3I6ICcjRkYwMDAwMycsXHJcbiAgICAgICB3aWR0aDogMlxyXG4gICAgIH0pLFxyXG4gICAgIGltYWdlOiBuZXcgb2wuc3R5bGUuQ2lyY2xlKHtcclxuICAgICAgIHJhZGl1czogNyxcclxuICAgICAgIGZpbGw6IG5ldyBvbC5zdHlsZS5GaWxsKHtcclxuICAgICAgICAgY29sb3I6ICcjRkYwMDAwJ1xyXG4gICAgICAgfSlcclxuICAgICB9KVxyXG4gICB9KVxyXG4gfSk7XHJcbiBtYXAuYWRkSW50ZXJhY3Rpb24oc2VsZWN0KTtcclxuIHNlbGVjdC5zZXRBY3RpdmUoZmFsc2UpO1xyXG4gLy90cmFuc2xhdGUobW92ZSlcclxuIHZhciB0cmFuc2xhdGUgPSBuZXcgb2wuaW50ZXJhY3Rpb24uVHJhbnNsYXRlKHtcclxuICAgZmVhdHVyZXM6IHNlbGVjdC5nZXRGZWF0dXJlcygpXHJcbiB9KTtcclxuIC8vPT09PT09IGluZm8gPT09PT09XHJcbiBtYXAub24oJ2NsaWNrJywgY2xpY2tJbmZvKTtcclxuXHJcbiBmdW5jdGlvbiBjbGlja0luZm8oZXZ0KSB7XHJcbiAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICB2YXIgb2JqID0ge307XHJcbiAgIHZhciBjbGlja2VkRmVhdHVyZSA9IG1hcC5mb3JFYWNoRmVhdHVyZUF0UGl4ZWwoZXZ0LnBpeGVsLCBmdW5jdGlvbihmZWF0dXJlLCBsYXllcikge1xyXG4gICAgIHJldHVybiB7XHJcbiAgICAgICBmZWF0dXJlOiBmZWF0dXJlLFxyXG4gICAgICAgbGF5ZXI6IGxheWVyXHJcbiAgICAgfTtcclxuICAgfSwgdGhpcywgZnVuY3Rpb24obGF5ZXIpIHtcclxuICAgICBpZiAobGF5ZXIuZ2V0KCdpZCcpID09PSAncHJvcGVydHknKSB7XHJcbiAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICB9XHJcbiAgIH0sIHRoaXMpO1xyXG4gICBjb25zb2xlLmxvZyhjbGlja2VkRmVhdHVyZSk7XHJcbiAgIGlmIChjbGlja2VkRmVhdHVyZSkge1xyXG4gICAgIG9iai5mZWF0dXJlID0ge307XHJcbiAgICAgY2xpY2tlZEZlYXR1cmUuZmVhdHVyZS5nZXRLZXlzKCkuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcclxuICAgICAgIG9iai5mZWF0dXJlW2tleV0gPSBjbGlja2VkRmVhdHVyZS5mZWF0dXJlLmdldChrZXkpO1xyXG4gICAgIH0pO1xyXG4gICAgIGNvbnNvbGUubG9nKG9iaik7XHJcbiAgICAgZHVzdC5yZW5kZXIoJ2FkbWluRXN0YXRlSW5mby5kdXN0Jywgb2JqLCBmdW5jdGlvbihlcnIsIG91dCkge1xyXG4gICAgICAgY29uc29sZS5sb2cob3V0KTtcclxuICAgICAgICQoJy5wcm9wZXJ0eS1pbmZvJykuaHRtbChvdXQpO1xyXG4gICAgICAgJCgnLnByb3BlcnR5LWluZm8nKS5yZW1vdmVDbGFzcygndmlzdWFsbHloaWRkZW4nKTtcclxuICAgICB9KTtcclxuICAgfSBlbHNlIHtcclxuICAgICAkKCcucHJvcGVydHktaW5mbycpLmFkZENsYXNzKCd2aXN1YWxseWhpZGRlbicpO1xyXG4gICB9XHJcbiB9XHJcbiAvLz09PT09PSBpbnNlcnQgPT09PT09XHJcbiAkKCcjaW5zZXJ0UHJvcGVydHknKS5jbGljayhmdW5jdGlvbigpIHtcclxuICAgJCgnLnByb3BlcnR5LWluZm8nKS5hZGRDbGFzcygndmlzdWFsbHloaWRkZW4nKTtcclxuICAgdG9hc3RyLm9wdGlvbnMgPSB7XHJcbiAgICAgXCJwb3NpdGlvbkNsYXNzXCI6IFwidG9hc3QtdG9wLWNlbnRlclwiXHJcbiAgIH07XHJcbiAgIHRvYXN0ci5pbmZvKCdBZGQgTmV3IFByb3BlcnR5Jyk7XHJcbiAgIG1hcC51bignY2xpY2snLCBjbGlja0luZm8pO1xyXG4gICBzZWxlY3Quc2V0QWN0aXZlKGZhbHNlKTtcclxuICAgZHJhdy5zZXRBY3RpdmUodHJ1ZSk7XHJcbiAgIGRyYXcub24oJ2RyYXdlbmQnLCBmdW5jdGlvbihldnQpIHtcclxuICAgICBkcmF3LnNldEFjdGl2ZShmYWxzZSk7XHJcbiAgIH0pO1xyXG4gfSk7XHJcbiAvLz09PT09PSBkZWxldGUgPT09PT09XHJcbiAkKCcjZGVsZXRlUHJvcGVydHknKS5jbGljayhmdW5jdGlvbihldmVudCkge1xyXG4gICAkKCcucHJvcGVydHktaW5mbycpLmFkZENsYXNzKCd2aXN1YWxseWhpZGRlbicpO1xyXG4gICB0b2FzdHIub3B0aW9ucyA9IHtcclxuICAgICBcInBvc2l0aW9uQ2xhc3NcIjogXCJ0b2FzdC10b3AtY2VudGVyXCJcclxuICAgfTtcclxuICAgdG9hc3RyLmluZm8oJ0RlbGV0ZSBQcm9wZXJ0eScpO1xyXG4gICBtYXAudW4oJ2NsaWNrJywgY2xpY2tJbmZvKTtcclxuICAgZHJhdy5zZXRBY3RpdmUoZmFsc2UpO1xyXG4gICBmZWF0dXJlcy5jbGVhcigpO1xyXG4gICBzZWxlY3Quc2V0QWN0aXZlKHRydWUpO1xyXG4gICBzZWxlY3Qub24oJ3NlbGVjdCcsIGZ1bmN0aW9uKGUpIHtcclxuICAgICBpZiAoZS50YXJnZXQuZ2V0RmVhdHVyZXMoKS5nZXRMZW5ndGgoKSA9PT0gMSkge1xyXG4gICAgICAgdG9hc3RyLm9wdGlvbnMubmV3ZXN0T25Ub3AgPSB0cnVlO1xyXG4gICAgICAgdG9hc3RyLm9wdGlvbnMucHJldmVudER1cGxpY2F0ZXMgPSB0cnVlO1xyXG4gICAgICAgdG9hc3RyLm9wdGlvbnMuZXh0ZW5kZWRUaW1lT3V0ID0gMDtcclxuICAgICAgIHRvYXN0ci5vcHRpb25zLnRpbWVPdXQgPSAwO1xyXG4gICAgICAgdG9hc3RyLm9wdGlvbnMuY2xvc2VCdXR0b24gPSB0cnVlO1xyXG4gICAgICAgdmFyICR0b2FzdCA9IHRvYXN0ci53YXJuaW5nKCc8cD5BcmUgeW91IHN1cmU/PC9wPjxkaXYgY2xhc3M9XCJ0b2FzdHItYnRuc1wiPjxidXR0b24gaWQ9XCJ5ZXNEZWxldGVcIiBjbGFzcz1cIm1kbC1idXR0b24gbWRsLWpzLWJ1dHRvbiBcIj5ZZXM8L2J1dHRvbj48YnV0dG9uIGlkPVwibm9EZWxldGVcIiBjbGFzcz1cIm1kbC1idXR0b24gbWRsLWpzLWJ1dHRvblwiPk5vPC9idXR0b24+PC9kaXY+Jyk7XHJcbiAgICAgICBpZiAoJHRvYXN0LmZpbmQoJyN5ZXNEZWxldGUnKS5sZW5ndGgpIHtcclxuICAgICAgICAgJHRvYXN0Lm9uKCdjbGljaycsICcjeWVzRGVsZXRlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgYWxlcnQoJ3lvdSBjbGlja2VkIG9rJyk7XHJcbiAgICAgICAgICAgJHRvYXN0LnJlbW92ZSgpO1xyXG4gICAgICAgICB9KTtcclxuICAgICAgIH1cclxuICAgICAgIGlmICgkdG9hc3QuZmluZCgnI25vRGVsZXRlJykubGVuZ3RoKSB7XHJcbiAgICAgICAgICR0b2FzdC5vbignY2xpY2snLCAnI25vRGVsZXRlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgYWxlcnQoJ1N1cnByaXNlISB5b3UgY2xpY2tlZCBtZS4nKTtcclxuICAgICAgICAgfSk7XHJcbiAgICAgICB9XHJcbiAgICAgfVxyXG4gICB9KTtcclxuIH0pO1xyXG4gJCgnI2xvZ291dCcpLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICBsb2NhdGlvbi5ocmVmID0gXCIvbWFwL2xvZ291dFwiO1xyXG4gfSk7XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
