function PropertyStyle(){var e;return e="../images/map-icons/pins/48/pin1.png",new ol.style.Style({image:new ol.style.Icon({src:e,anchor:[.5,1],scale:.7})})}function clickInfo(e){e.preventDefault();var t={},o=map.forEachFeatureAtPixel(e.pixel,function(e,t){return{feature:e,layer:t}},this,function(e){return"property"===e.get("id")?!0:void 0},this);o?(t.feature={},o.feature.getKeys().forEach(function(e){t.feature[e]=o.feature.get(e)}),dust.render("adminPropertyInfo.dust",t,function(e,t){$(".property-info").html(t),$(".property-info").removeClass("visuallyhidden")})):($(".property-info").addClass("visuallyhidden"),toastr.error("Cant Find Any Property There..."))}var center=[3677385,4120949],extent=[3590094,4102833,3855483,4261211],lang=document.documentElement.lang,geoJSONFormat=new ol.format.GeoJSON({defaultDataProjection:"EPSG:4326"}),bing=new ol.layer.Tile({visible:!0,source:new ol.source.BingMaps({key:"Ak2Gq8VUfICsPpuf7LRANXmXt2sHWmSLPhohmVLFtFIEwYjs_5MCyAhAFwRSVpLj",imagerySet:"Aerial"}),maxZoom:19,crossOrigin:"anonymous",preload:1/0,id:"bing"}),mapbox=new ol.layer.Tile({source:new ol.source.XYZ({attributions:[new ol.Attribution({html:'<a href="https://www.mapbox.com/about/maps/" target="_blank">&copy; Mapbox &copy; OpenStreetMap</a>'})],url:"https://api.mapbox.com/v4/mapbox.streets/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiZmlydmFpbiIsImEiOiJlOWYyYTM0NThiNWM0YjJjODJjNDE4ODQzNzA2MGQyNiJ9.-NVDO27Hzt-w_nQosUPfLA"}),id:"mapbox"}),propertySource=new ol.source.Vector({format:geoJSONFormat,loader:function(e,t,o){var r="http://127.0.0.1:3000/db/admin",n=this;n.clear(),$.ajax({url:r,type:"POST",beforeSend:function(e){localStorage.getItem("userToken")&&e.setRequestHeader("Authorization","Bearer "+localStorage.getItem("userToken"))},dataType:"json",data:{id:id}}).done(function(e){var t=geoJSONFormat.readFeatures(e,{featureProjection:"EPSG:3857"});n.addFeatures(t)}).fail(function(){})},strategy:ol.loadingstrategy.all}),property=new ol.layer.Vector({source:propertySource,id:"property",visible:!0,style:PropertyStyle()});property.setZIndex(2);var map=new ol.Map({target:"adminMap",layers:[mapbox,property],loadTilesWhileAnimating:!0,loadTilesWhileInteracting:!0,renderer:"canvas",controls:ol.control.defaults({attributionOptions:{collapsible:!1,collapsed:!1}}).extend([new ol.control.ScaleLine({units:"metric"}),new ol.control.OverviewMap({className:"ol-overviewmap ol-custom-overviewmap",collapsible:!0,collapsed:!0,layers:[bing]}),new ol.control.ZoomToExtent({extent:extent})]),view:new ol.View({center:center,projection:"EPSG:3857",zoom:14,maxZoom:19,minZoom:10})});"el"===lang?(bing.set("name","Δορυφορική εικόνα"),mapbox.set("name","Χάρτης"),property.set("name","Ακίνητα")):(bing.set("name","Sattelite Image"),mapbox.set("name","Map"),property.set("name","Properties"));var features=new ol.Collection,drawnProperties=new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})}),id:"drawnProperties"});map.addLayer(drawnProperties);var draw=new ol.interaction.Draw({source:drawnProperties.getSource(),type:"Point",style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})})});map.addInteraction(draw),draw.setActive(!1);var select=new ol.interaction.Select({layers:[property],features:features,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 0, 0, 0.2)"}),stroke:new ol.style.Stroke({color:"#FF00003",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#FF0000"})})})});map.addInteraction(select),select.setActive(!1),map.on("click",clickInfo),$("#insertProperty").click(function(){$(".property-info").addClass("visuallyhidden"),toastr.options={positionClass:"toast-top-center",preventDuplicates:!0,timeOut:30},map.un("click",clickInfo),select.setActive(!1),draw.setActive(!0),draw.on("drawend",function(e){e.preventDefault(),draw.setActive(!1);var t={};$(".modal-dialog").removeClass("visuallyhidden"),dust.render("propertyInsert.dust",t,function(e,t){$(".modal-content").html(t),componentHandler.upgradeDom(),handleForm.set({name:"insertProperty",submitBtnId:"insert"}),$("#cancelInsert").on("click",function(e){e.preventDefault(),handleForm.clear(),drawnProperties.getSource().clear(),$(".modal-dialog").addClass("visuallyhidden"),map.on("click",clickInfo)}),$("#insert").on("click",function(e){e.preventDefault();var t,o;t=handleForm.get(),null!==t&&(handleCoords.setLayer("drawnProperties"),o=handleCoords.coords(),t.x=o[0],t.y=o[1],t.adminId=id,$.ajax({url:"http://127.0.0.1:3000/db/insert",type:"POST",data:t}).done(function(e,t,o){toastr.options={positionClass:"toast-bottom-full-width",preventDuplicates:!0,timeOut:30},201===o.status?toastr.success("Property Recorded In Database"):toastr.error("Oops Something Went Wrong!!!")}).fail(function(e,t,o){toastr.error("Oops Something Went Wrong!!!")}).always(function(){e.preventDefault(),drawnProperties.getSource().clear(),propertySource.clear(),handleForm.clear(),$(".modal-dialog").addClass("visuallyhidden"),map.on("click",clickInfo)}))})})})}),$("#deleteProperty").click(function(e){e.preventDefault(),$(".property-info").addClass("visuallyhidden"),toastr.options={positionClass:"toast-top-center",preventDuplicates:!0,timeOut:20},toastr.info("Delete Property"),map.un("click",clickInfo),draw.setActive(!1),features.clear(),select.setActive(!0),select.on("select",function(e){if(1===e.target.getFeatures().getLength()){toastr.options.newestOnTop=!0,toastr.options.preventDuplicates=!0,toastr.options.extendedTimeOut=0,toastr.options.timeOut=0,toastr.options.closeButton=!0;var t=toastr.warning('<p>Are you sure?</p><div class="toastr-btns"><button id="yesDelete" class="mdl-button mdl-js-button ">Yes</button><button id="noDelete" class="mdl-button mdl-js-button">No</button></div>');t.on("click","#yesDelete",function(){var e;e=select.getFeatures().item(0).get("gid"),$.ajax({url:"http://127.0.0.1:3000/db/delete",type:"POST",dataType:"text",data:{gid:e}}).done(function(e,t,o){toastr.options={positionClass:"toast-bottom-full-width",preventDuplicates:!0,timeOut:30},toastr.success("Property Deleted From Database")}).fail(function(e,t,o){toastr.options={positionClass:"toast-bottom-full-width",preventDuplicates:!0,timeOut:30},toastr.success("Oops Something Went Wrong!!!")}).always(function(){propertySource.clear(),select.getFeatures().clear(),select.setActive(!1),map.on("click",clickInfo)}),t.remove()}),t.on("click","#noDelete",function(){t.remove(),select.getFeatures().clear(),select.setActive(!1)})}})}),$("#logout").click(function(){location.href="/map/logout"});var handleCoords=function(e){"use strict";function t(e){for(var t=map.getLayers(),o=t.getLength(),r=0;o>r;r++)if(e===t.item(r).get("id"))return t.item(r);return null}function o(e){a=t(e)}function r(){var t;return t=a.getSource().getFeatures()[0].getGeometry().getCoordinates(),n=e.proj.transform(t,"EPSG:3857","EPSG:4326")}var n,a;return{coords:r,setLayer:o}}(ol),handleForm=function(e,t){"use strict";function o(e){s=e.name,c=e.submitBtnId}function r(){return u=e('form[name="'+s+'"').parsley(),!0}function n(){u.destroy()}function a(){return u.validate()}function l(){var t={};return r(),a()===!0?(e('form[name="'+s+'"').find(".mdl-textfield__input").each(function(o,r){t[e(this).attr("id")]=e(this).val()}),e('form[name="'+s+'"').find(".mdl-checkbox__input").each(function(o,r){t[e(this).attr("id")]=e(this).prop("checked")}),t):null}function i(){1==r()&&n(),e('form[name="'+s+'"').find(".mdl-textfield__input").each(function(t,o){e(this).val(""),e(this).parent().eq(0).removeClass("is-dirty"),e(this).parent().eq(0).removeClass("is-invalid")}),e('form[name="'+s+'"').find(".mdl-checkbox__input").each(function(t,o){e(this).prop("checked",!1)}),e('form[name="'+s+'"').find(".mdl-checkbox").each(function(t,o){e(this).removeClass("is-checked")})}var s,c,u;return{set:o,get:l,clear:i}}(jQuery,parsley);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluLmpzIiwiaGFuZGxlQ29vcmRzLmpzIiwiaGFuZGxlRm9ybS5qcyJdLCJuYW1lcyI6WyJQcm9wZXJ0eVN0eWxlIiwic3JjIiwib2wiLCJzdHlsZSIsIlN0eWxlIiwiaW1hZ2UiLCJJY29uIiwiYW5jaG9yIiwic2NhbGUiLCJjbGlja0luZm8iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIm9iaiIsImNsaWNrZWRGZWF0dXJlIiwibWFwIiwiZm9yRWFjaEZlYXR1cmVBdFBpeGVsIiwicGl4ZWwiLCJmZWF0dXJlIiwibGF5ZXIiLCJ0aGlzIiwiZ2V0IiwiZ2V0S2V5cyIsImZvckVhY2giLCJrZXkiLCJkdXN0IiwicmVuZGVyIiwiZXJyIiwib3V0IiwiJCIsImh0bWwiLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwidG9hc3RyIiwiZXJyb3IiLCJjZW50ZXIiLCJleHRlbnQiLCJsYW5nIiwiZG9jdW1lbnQiLCJkb2N1bWVudEVsZW1lbnQiLCJnZW9KU09ORm9ybWF0IiwiZm9ybWF0IiwiR2VvSlNPTiIsImRlZmF1bHREYXRhUHJvamVjdGlvbiIsImJpbmciLCJUaWxlIiwidmlzaWJsZSIsInNvdXJjZSIsIkJpbmdNYXBzIiwiaW1hZ2VyeVNldCIsIm1heFpvb20iLCJjcm9zc09yaWdpbiIsInByZWxvYWQiLCJJbmZpbml0eSIsImlkIiwibWFwYm94IiwiWFlaIiwiYXR0cmlidXRpb25zIiwiQXR0cmlidXRpb24iLCJ1cmwiLCJwcm9wZXJ0eVNvdXJjZSIsIlZlY3RvciIsImxvYWRlciIsInJlc29sdXRpb24iLCJwcm9qZWN0aW9uIiwic2VsZiIsImNsZWFyIiwiYWpheCIsInR5cGUiLCJiZWZvcmVTZW5kIiwieGhyIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsInNldFJlcXVlc3RIZWFkZXIiLCJkYXRhVHlwZSIsImRhdGEiLCJkb25lIiwicmVzcG9uc2UiLCJmZWF0dXJlcyIsInJlYWRGZWF0dXJlcyIsImZlYXR1cmVQcm9qZWN0aW9uIiwiYWRkRmVhdHVyZXMiLCJmYWlsIiwic3RyYXRlZ3kiLCJsb2FkaW5nc3RyYXRlZ3kiLCJhbGwiLCJwcm9wZXJ0eSIsInNldFpJbmRleCIsIk1hcCIsInRhcmdldCIsImxheWVycyIsImxvYWRUaWxlc1doaWxlQW5pbWF0aW5nIiwibG9hZFRpbGVzV2hpbGVJbnRlcmFjdGluZyIsInJlbmRlcmVyIiwiY29udHJvbHMiLCJjb250cm9sIiwiZGVmYXVsdHMiLCJhdHRyaWJ1dGlvbk9wdGlvbnMiLCJjb2xsYXBzaWJsZSIsImNvbGxhcHNlZCIsImV4dGVuZCIsIlNjYWxlTGluZSIsInVuaXRzIiwiT3ZlcnZpZXdNYXAiLCJjbGFzc05hbWUiLCJab29tVG9FeHRlbnQiLCJ2aWV3IiwiVmlldyIsInpvb20iLCJtaW5ab29tIiwic2V0IiwiQ29sbGVjdGlvbiIsImRyYXduUHJvcGVydGllcyIsImZpbGwiLCJGaWxsIiwiY29sb3IiLCJzdHJva2UiLCJTdHJva2UiLCJ3aWR0aCIsIkNpcmNsZSIsInJhZGl1cyIsImFkZExheWVyIiwiZHJhdyIsImludGVyYWN0aW9uIiwiRHJhdyIsImdldFNvdXJjZSIsImFkZEludGVyYWN0aW9uIiwic2V0QWN0aXZlIiwic2VsZWN0IiwiU2VsZWN0Iiwib24iLCJjbGljayIsIm9wdGlvbnMiLCJwb3NpdGlvbkNsYXNzIiwicHJldmVudER1cGxpY2F0ZXMiLCJ0aW1lT3V0IiwidW4iLCJjb21wb25lbnRIYW5kbGVyIiwidXBncmFkZURvbSIsImhhbmRsZUZvcm0iLCJuYW1lIiwic3VibWl0QnRuSWQiLCJldmVudCIsImMiLCJoYW5kbGVDb29yZHMiLCJzZXRMYXllciIsImNvb3JkcyIsIngiLCJ5IiwiYWRtaW5JZCIsInRleHRTdGF0dXMiLCJqcVhIUiIsInN0YXR1cyIsInN1Y2Nlc3MiLCJlcnJvclRocm93biIsImFsd2F5cyIsImluZm8iLCJlIiwiZ2V0RmVhdHVyZXMiLCJnZXRMZW5ndGgiLCJuZXdlc3RPblRvcCIsImV4dGVuZGVkVGltZU91dCIsImNsb3NlQnV0dG9uIiwiJHRvYXN0Iiwid2FybmluZyIsImdpZCIsIml0ZW0iLCJyZW1vdmUiLCJsb2NhdGlvbiIsImhyZWYiLCJmaW5kQnlJZCIsImdldExheWVycyIsImxlbmd0aCIsImkiLCJsIiwiZ2V0Q29vcmRzIiwiY29vcmRFUFNHMzg1NyIsImdldEdlb21ldHJ5IiwiZ2V0Q29vcmRpbmF0ZXMiLCJwcm9qIiwidHJhbnNmb3JtIiwicGFyc2xleSIsInNldE9wdGlvbnMiLCJmb3JtTmFtZSIsImNyZWF0ZVZhbGlkYXRvciIsInAiLCJkZXN0cm95VmFsaWRhdG9yIiwiZGVzdHJveSIsInZhbGlkYXRlRm9ybSIsInZhbGlkYXRlIiwiZ2V0QXR0cmlidXRlcyIsImZpbmQiLCJlYWNoIiwiaW5kZXgiLCJlbGVtZW50IiwiYXR0ciIsInZhbCIsInByb3AiLCJyZXNldEZvcm0iLCJwYXJlbnQiLCJlcSIsImpRdWVyeSJdLCJtYXBwaW5ncyI6IkFBK0JBLFFBQUFBLGlCQUNBLEdBQUFDLEVBRUEsT0FEQUEsR0FBQSx1Q0FDQSxHQUFBQyxJQUFBQyxNQUFBQyxPQUNBQyxNQUFBLEdBQUFILElBQUFDLE1BQUFHLE1BQ0FMLElBQUFBLEVBQ0FNLFFBQ0EsR0FBQSxHQUVBQyxNQUFBLE9BK0pBLFFBQUFDLFdBQUFDLEdBQ0FBLEVBQUFDLGdCQUNBLElBQUFDLE1BQ0FDLEVBQUFDLElBQUFDLHNCQUFBTCxFQUFBTSxNQUFBLFNBQUFDLEVBQUFDLEdBQ0EsT0FDQUQsUUFBQUEsRUFDQUMsTUFBQUEsSUFFQUMsS0FBQSxTQUFBRCxHQUNBLE1BQUEsYUFBQUEsRUFBQUUsSUFBQSxPQUNBLEVBREEsUUFHQUQsS0FDQU4sSUFDQUQsRUFBQUssV0FDQUosRUFBQUksUUFBQUksVUFBQUMsUUFBQSxTQUFBQyxHQUNBWCxFQUFBSyxRQUFBTSxHQUFBVixFQUFBSSxRQUFBRyxJQUFBRyxLQUVBQyxLQUFBQyxPQUFBLHlCQUFBYixFQUFBLFNBQUFjLEVBQUFDLEdBQ0FDLEVBQUEsa0JBQUFDLEtBQUFGLEdBQ0FDLEVBQUEsa0JBQUFFLFlBQUEsc0JBR0FGLEVB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K0ssS0FBQSxPQUFBdEssRUFBQVQsTUFBQWlMLEtBQUEsYUFFQXhMLEdBRUEsS0FHQSxRQUFBeUwsS0FDQSxHQUFBZCxLQUNBRSxJQUVBN0osRUFBQSxjQUFBMEosRUFBQSxLQUFBUSxLQUFBLHlCQUFBQyxLQUFBLFNBQUFDLEVBQUFDLEdBQ0FySyxFQUFBVCxNQUFBZ0wsSUFBQSxJQUNBdkssRUFBQVQsTUFBQW1MLFNBQUFDLEdBQUEsR0FBQXpLLFlBQUEsWUFDQUYsRUFBQVQsTUFBQW1MLFNBQUFDLEdBQUEsR0FBQXpLLFlBQUEsZ0JBRUFGLEVBQUEsY0FBQTBKLEVBQUEsS0FBQVEsS0FBQSx3QkFBQUMsS0FBQSxTQUFBQyxFQUFBQyxHQUNBckssRUFBQVQsTUFBQWlMLEtBQUEsV0FBQSxLQUVBeEssRUFBQSxjQUFBMEosRUFBQSxLQUFBUSxLQUFBLGlCQUFBQyxLQUFBLFNBQUFDLEVBQUFDLEdBQ0FySyxFQUFBVCxNQUFBVyxZQUFBLGdCQXhEQSxHQUFBd0osR0FBQTFDLEVBQUE0QyxDQTJEQSxRQUNBM0UsSUFBQXdFLEVBQ0FqSyxJQUFBeUssRUFDQTVILE1BQUFvSSxJQU9BRyxPQUFBcEIiLCJmaWxlIjoiYWRtaW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGNlbnRlciA9IFtcbiAgICAzNjc3Mzg1LCA0MTIwOTQ5XG4gIF0sXG4gIGV4dGVudCA9IFtcbiAgICAzNTkwMDk0LCA0MTAyODMzLCAzODU1NDgzLCA0MjYxMjExXG4gIF0sXG4gIGxhbmcgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQubGFuZyxcbiAgZ2VvSlNPTkZvcm1hdCA9IG5ldyBvbC5mb3JtYXQuR2VvSlNPTih7XG4gICAgZGVmYXVsdERhdGFQcm9qZWN0aW9uOiBcIkVQU0c6NDMyNlwiXG4gIH0pO1xudmFyIGJpbmcgPSBuZXcgb2wubGF5ZXIuVGlsZSh7XG4gIHZpc2libGU6IHRydWUsXG4gIHNvdXJjZTogbmV3IG9sLnNvdXJjZS5CaW5nTWFwcyh7XG4gICAga2V5OiBcIkFrMkdxOFZVZklDc1BwdWY3TFJBTlhtWHQyc0hXbVNMUGhvaG1WTEZ0RklFd1lqc181TUN5QWhBRndSU1ZwTGpcIixcbiAgICBpbWFnZXJ5U2V0OiBcIkFlcmlhbFwiXG4gIH0pLFxuICBtYXhab29tOiAxOSxcbiAgY3Jvc3NPcmlnaW46IFwiYW5vbnltb3VzXCIsXG4gIHByZWxvYWQ6IEluZmluaXR5LFxuICBpZDogXCJiaW5nXCJcbn0pO1xudmFyIG1hcGJveCA9IG5ldyBvbC5sYXllci5UaWxlKHtcbiAgc291cmNlOiBuZXcgb2wuc291cmNlLlhZWih7XG4gICAgYXR0cmlidXRpb25zOiBbbmV3IG9sLkF0dHJpYnV0aW9uKHtcbiAgICAgIGh0bWw6IFwiPGEgaHJlZj1cXFwiaHR0cHM6Ly93d3cubWFwYm94LmNvbS9hYm91dC9tYXBzL1xcXCIgdGFyZ2V0PVxcXCJfYmxhbmtcXFwiPiZjb3B5OyBNYXBib3ggJmNvcHk7IE9wZW5TdHJlZXRNYXA8L2E+XCJcbiAgICB9KV0sXG4gICAgdXJsOiBcImh0dHBzOi8vYXBpLm1hcGJveC5jb20vdjQvbWFwYm94LnN0cmVldHMve3p9L3t4fS97eX0ucG5nP2FjY2Vzc190b2tlbj1way5leUoxSWpvaVptbHlkbUZwYmlJc0ltRWlPaUpsT1dZeVlUTTBOVGhpTldNMFlqSmpPREpqTkRFNE9EUXpOekEyTUdReU5pSjkuLU5WRE8yN0h6dC13X25Rb3NVUGZMQVwiXG4gIH0pLFxuICBpZDogXCJtYXBib3hcIlxufSk7XG5cbmZ1bmN0aW9uIFByb3BlcnR5U3R5bGUoKSB7XG4gIHZhciBzcmM7XG4gIHNyYyA9IFwiLi4vaW1hZ2VzL21hcC1pY29ucy9waW5zLzQ4L3BpbjEucG5nXCI7XG4gIHJldHVybiBuZXcgb2wuc3R5bGUuU3R5bGUoe1xuICAgIGltYWdlOiBuZXcgb2wuc3R5bGUuSWNvbigoe1xuICAgICAgc3JjOiBzcmMsXG4gICAgICBhbmNob3I6IFtcbiAgICAgICAgMC41LCAxXG4gICAgICBdLFxuICAgICAgc2NhbGU6IDAuN1xuICAgIH0pKVxuICB9KTtcbn1cbnZhciBwcm9wZXJ0eVNvdXJjZSA9IG5ldyBvbC5zb3VyY2UuVmVjdG9yKHtcbiAgZm9ybWF0OiBnZW9KU09ORm9ybWF0LFxuICBsb2FkZXI6IGZ1bmN0aW9uKGV4dGVudCwgcmVzb2x1dGlvbiwgcHJvamVjdGlvbikge1xuICAgIHZhciB1cmwgPSBcImh0dHA6Ly8xMjcuMC4wLjE6MzAwMC9kYi9hZG1pblwiO1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBzZWxmLmNsZWFyKCk7XG4gICAgJC5hamF4KHtcbiAgICAgIHVybDogdXJsLFxuICAgICAgdHlwZTogXCJQT1NUXCIsXG4gICAgICBcImJlZm9yZVNlbmRcIjogZnVuY3Rpb24oeGhyKSB7XG4gICAgICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInVzZXJUb2tlblwiKSkge1xuICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiQXV0aG9yaXphdGlvblwiLCBcIkJlYXJlciBcIiArIGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwidXNlclRva2VuXCIpKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgaWQ6IGlkXG4gICAgICB9XG4gICAgfSkuZG9uZShmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgdmFyIGZlYXR1cmVzID0gZ2VvSlNPTkZvcm1hdC5yZWFkRmVhdHVyZXMocmVzcG9uc2UsIHtcbiAgICAgICAgZmVhdHVyZVByb2plY3Rpb246IFwiRVBTRzozODU3XCJcbiAgICAgIH0pO1xuICAgICAgc2VsZi5hZGRGZWF0dXJlcyhmZWF0dXJlcyk7XG4gICAgfSkuZmFpbChmdW5jdGlvbigpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3JcIik7XG4gICAgfSk7XG4gIH0sXG4gIHN0cmF0ZWd5OiBvbC5sb2FkaW5nc3RyYXRlZ3kuYWxsXG59KTtcbnZhciBwcm9wZXJ0eSA9IG5ldyBvbC5sYXllci5WZWN0b3Ioe1xuICBzb3VyY2U6IHByb3BlcnR5U291cmNlLFxuICBpZDogXCJwcm9wZXJ0eVwiLFxuICB2aXNpYmxlOiB0cnVlLFxuICBzdHlsZTogUHJvcGVydHlTdHlsZSgpXG59KTtcbnByb3BlcnR5LnNldFpJbmRleCgyKTtcbnZhciBtYXAgPSBuZXcgb2wuTWFwKHtcbiAgdGFyZ2V0OiBcImFkbWluTWFwXCIsXG4gIGxheWVyczogW1xuICAgIG1hcGJveCwgcHJvcGVydHlcbiAgXSxcbiAgbG9hZFRpbGVzV2hpbGVBbmltYXRpbmc6IHRydWUsXG4gIGxvYWRUaWxlc1doaWxlSW50ZXJhY3Rpbmc6IHRydWUsXG4gIHJlbmRlcmVyOiBcImNhbnZhc1wiLFxuICBjb250cm9sczogb2wuY29udHJvbC5kZWZhdWx0cyh7XG4gICAgYXR0cmlidXRpb25PcHRpb25zOiB7XG4gICAgICBjb2xsYXBzaWJsZTogZmFsc2UsXG4gICAgICBjb2xsYXBzZWQ6IGZhbHNlXG4gICAgfVxuICB9KS5leHRlbmQoW1xuICAgIG5ldyBvbC5jb250cm9sLlNjYWxlTGluZSh7XG4gICAgICB1bml0czogXCJtZXRyaWNcIlxuICAgIH0pLFxuICAgIG5ldyBvbC5jb250cm9sLk92ZXJ2aWV3TWFwKHtcbiAgICAgIGNsYXNzTmFtZTogXCJvbC1vdmVydmlld21hcCBvbC1jdXN0b20tb3ZlcnZpZXdtYXBcIixcbiAgICAgIGNvbGxhcHNpYmxlOiB0cnVlLFxuICAgICAgY29sbGFwc2VkOiB0cnVlLFxuICAgICAgbGF5ZXJzOiBbYmluZ11cbiAgICB9KSxcbiAgICBuZXcgb2wuY29udHJvbC5ab29tVG9FeHRlbnQoe1xuICAgICAgZXh0ZW50OiBleHRlbnRcbiAgICB9KVxuICBdKSxcbiAgdmlldzogbmV3IG9sLlZpZXcoe1xuICAgIGNlbnRlcjogY2VudGVyLFxuICAgIC8vIGV4dGVudDogZXh0ZW50LFxuICAgIHByb2plY3Rpb246IFwiRVBTRzozODU3XCIsXG4gICAgem9vbTogMTQsXG4gICAgbWF4Wm9vbTogMTksXG4gICAgbWluWm9vbTogMTBcbiAgfSlcbn0pO1xuaWYgKGxhbmcgPT09IFwiZWxcIikge1xuICBiaW5nLnNldChcIm5hbWVcIiwgXCLOlM6/z4HPhc+Gzr/Pgc65zrrOriDOtc65zrrPjM69zrFcIik7XG4gIG1hcGJveC5zZXQoXCJuYW1lXCIsIFwizqfOrM+Bz4TOt8+CXCIpO1xuICBwcm9wZXJ0eS5zZXQoXCJuYW1lXCIsIFwizpHOus6vzr3Ot8+EzrFcIik7XG59IGVsc2Uge1xuICBiaW5nLnNldChcIm5hbWVcIiwgXCJTYXR0ZWxpdGUgSW1hZ2VcIik7XG4gIG1hcGJveC5zZXQoXCJuYW1lXCIsIFwiTWFwXCIpO1xuICBwcm9wZXJ0eS5zZXQoXCJuYW1lXCIsIFwiUHJvcGVydGllc1wiKTtcbn1cbi8vPT09PT09IGludGVyYWN0aW9ucyA9PT09PT1cbnZhciBmZWF0dXJlcyA9IG5ldyBvbC5Db2xsZWN0aW9uKCk7XG52YXIgZHJhd25Qcm9wZXJ0aWVzID0gbmV3IG9sLmxheWVyLlZlY3Rvcih7XG4gIHNvdXJjZTogbmV3IG9sLnNvdXJjZS5WZWN0b3IoKSxcbiAgc3R5bGU6IG5ldyBvbC5zdHlsZS5TdHlsZSh7XG4gICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xuICAgICAgY29sb3I6IFwicmdiYSgyNTUsIDI1NSwgMjU1LCAwLjIpXCJcbiAgICB9KSxcbiAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xuICAgICAgY29sb3I6IFwiI2ZmY2MzM1wiLFxuICAgICAgd2lkdGg6IDJcbiAgICB9KSxcbiAgICBpbWFnZTogbmV3IG9sLnN0eWxlLkNpcmNsZSh7XG4gICAgICByYWRpdXM6IDcsXG4gICAgICBmaWxsOiBuZXcgb2wuc3R5bGUuRmlsbCh7XG4gICAgICAgIGNvbG9yOiBcIiNmZmNjMzNcIlxuICAgICAgfSlcbiAgICB9KVxuICB9KSxcbiAgaWQ6IFwiZHJhd25Qcm9wZXJ0aWVzXCJcbn0pO1xubWFwLmFkZExheWVyKGRyYXduUHJvcGVydGllcyk7XG4vL2RyYXdcbnZhciBkcmF3ID0gbmV3IG9sLmludGVyYWN0aW9uLkRyYXcoe1xuICAvLyBmZWF0dXJlczogZmVhdHVyZXMsXG4gIHNvdXJjZTogZHJhd25Qcm9wZXJ0aWVzLmdldFNvdXJjZSgpLFxuICB0eXBlOiBcIlBvaW50XCIsXG4gIHN0eWxlOiBuZXcgb2wuc3R5bGUuU3R5bGUoe1xuICAgIGZpbGw6IG5ldyBvbC5zdHlsZS5GaWxsKHtcbiAgICAgIGNvbG9yOiBcInJnYmEoMjU1LCAyNTUsIDI1NSwgMC4yKVwiXG4gICAgfSksXG4gICAgc3Ryb2tlOiBuZXcgb2wuc3R5bGUuU3Ryb2tlKHtcbiAgICAgIGNvbG9yOiBcIiNmZmNjMzNcIixcbiAgICAgIHdpZHRoOiAyXG4gICAgfSksXG4gICAgaW1hZ2U6IG5ldyBvbC5zdHlsZS5DaXJjbGUoe1xuICAgICAgcmFkaXVzOiA3LFxuICAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xuICAgICAgICBjb2xvcjogXCIjZmZjYzMzXCJcbiAgICAgIH0pXG4gICAgfSlcbiAgfSlcbn0pO1xubWFwLmFkZEludGVyYWN0aW9uKGRyYXcpO1xuZHJhdy5zZXRBY3RpdmUoZmFsc2UpO1xuLy9zZWxlY3RcbnZhciBzZWxlY3QgPSBuZXcgb2wuaW50ZXJhY3Rpb24uU2VsZWN0KHtcbiAgbGF5ZXJzOiBbcHJvcGVydHldLFxuICBmZWF0dXJlczogZmVhdHVyZXMsXG4gIHN0eWxlOiBuZXcgb2wuc3R5bGUuU3R5bGUoe1xuICAgIGZpbGw6IG5ldyBvbC5zdHlsZS5GaWxsKHtcbiAgICAgIGNvbG9yOiBcInJnYmEoMjU1LCAwLCAwLCAwLjIpXCJcbiAgICB9KSxcbiAgICBzdHJva2U6IG5ldyBvbC5zdHlsZS5TdHJva2Uoe1xuICAgICAgY29sb3I6IFwiI0ZGMDAwMDNcIixcbiAgICAgIHdpZHRoOiAyXG4gICAgfSksXG4gICAgaW1hZ2U6IG5ldyBvbC5zdHlsZS5DaXJjbGUoe1xuICAgICAgcmFkaXVzOiA3LFxuICAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xuICAgICAgICBjb2xvcjogXCIjRkYwMDAwXCJcbiAgICAgIH0pXG4gICAgfSlcbiAgfSlcbn0pO1xubWFwLmFkZEludGVyYWN0aW9uKHNlbGVjdCk7XG5zZWxlY3Quc2V0QWN0aXZlKGZhbHNlKTtcbi8vdHJhbnNsYXRlKG1vdmUpXG4vLyB2YXIgdHJhbnNsYXRlID0gbmV3IG9sLmludGVyYWN0aW9uLlRyYW5zbGF0ZSh7XG4vLyAgIGZlYXR1cmVzOiBzZWxlY3QuZ2V0RmVhdHVyZXMoKVxuLy8gfSk7XG4vLz09PT09PSBpbmZvID09PT09PVxubWFwLm9uKFwiY2xpY2tcIiwgY2xpY2tJbmZvKTtcblxuZnVuY3Rpb24gY2xpY2tJbmZvKGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgdmFyIG9iaiA9IHt9O1xuICB2YXIgY2xpY2tlZEZlYXR1cmUgPSBtYXAuZm9yRWFjaEZlYXR1cmVBdFBpeGVsKGV2dC5waXhlbCwgZnVuY3Rpb24oZmVhdHVyZSwgbGF5ZXIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZmVhdHVyZTogZmVhdHVyZSxcbiAgICAgIGxheWVyOiBsYXllclxuICAgIH07XG4gIH0sIHRoaXMsIGZ1bmN0aW9uKGxheWVyKSB7XG4gICAgaWYgKGxheWVyLmdldChcImlkXCIpID09PSBcInByb3BlcnR5XCIpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfSwgdGhpcyk7XG4gIGlmIChjbGlja2VkRmVhdHVyZSkge1xuICAgIG9iai5mZWF0dXJlID0ge307XG4gICAgY2xpY2tlZEZlYXR1cmUuZmVhdHVyZS5nZXRLZXlzKCkuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcbiAgICAgIG9iai5mZWF0dXJlW2tleV0gPSBjbGlja2VkRmVhdHVyZS5mZWF0dXJlLmdldChrZXkpO1xuICAgIH0pO1xuICAgIGR1c3QucmVuZGVyKFwiYWRtaW5Qcm9wZXJ0eUluZm8uZHVzdFwiLCBvYmosIGZ1bmN0aW9uKGVyciwgb3V0KSB7XG4gICAgICAkKFwiLnByb3BlcnR5LWluZm9cIikuaHRtbChvdXQpO1xuICAgICAgJChcIi5wcm9wZXJ0eS1pbmZvXCIpLnJlbW92ZUNsYXNzKFwidmlzdWFsbHloaWRkZW5cIik7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgJChcIi5wcm9wZXJ0eS1pbmZvXCIpLmFkZENsYXNzKFwidmlzdWFsbHloaWRkZW5cIik7XG4gICAgdG9hc3RyLmVycm9yKFwiQ2FudCBGaW5kIEFueSBQcm9wZXJ0eSBUaGVyZS4uLlwiKTtcbiAgfVxufVxuLy89PT09PT0gaW5zZXJ0ID09PT09PVxuJChcIiNpbnNlcnRQcm9wZXJ0eVwiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgJChcIi5wcm9wZXJ0eS1pbmZvXCIpLmFkZENsYXNzKFwidmlzdWFsbHloaWRkZW5cIik7XG4gIHRvYXN0ci5vcHRpb25zID0ge1xuICAgIFwicG9zaXRpb25DbGFzc1wiOiBcInRvYXN0LXRvcC1jZW50ZXJcIixcbiAgICBcInByZXZlbnREdXBsaWNhdGVzXCI6IHRydWUsXG4gICAgXCJ0aW1lT3V0XCI6IDMwXG4gIH07XG4gIC8vIHRvYXN0ci5pbmZvKFwiQWRkIE5ldyBQcm9wZXJ0eVwiKTtcbiAgbWFwLnVuKFwiY2xpY2tcIiwgY2xpY2tJbmZvKTtcbiAgc2VsZWN0LnNldEFjdGl2ZShmYWxzZSk7XG4gIGRyYXcuc2V0QWN0aXZlKHRydWUpO1xuICBkcmF3Lm9uKFwiZHJhd2VuZFwiLCBmdW5jdGlvbihldnQpIHtcbiAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICBkcmF3LnNldEFjdGl2ZShmYWxzZSk7XG4gICAgdmFyIG9iaiA9IHt9O1xuICAgICQoXCIubW9kYWwtZGlhbG9nXCIpLnJlbW92ZUNsYXNzKFwidmlzdWFsbHloaWRkZW5cIik7XG4gICAgZHVzdC5yZW5kZXIoXCJwcm9wZXJ0eUluc2VydC5kdXN0XCIsIG9iaiwgZnVuY3Rpb24oZXJyLCBvdXQpIHtcbiAgICAgICQoXCIubW9kYWwtY29udGVudFwiKS5odG1sKG91dCk7XG4gICAgICBjb21wb25lbnRIYW5kbGVyLnVwZ3JhZGVEb20oKTtcbiAgICAgIGhhbmRsZUZvcm0uc2V0KHtcbiAgICAgICAgbmFtZTogXCJpbnNlcnRQcm9wZXJ0eVwiLFxuICAgICAgICBzdWJtaXRCdG5JZDogXCJpbnNlcnRcIlxuICAgICAgfSk7XG4gICAgICAkKFwiI2NhbmNlbEluc2VydFwiKS5vbihcImNsaWNrXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGhhbmRsZUZvcm0uY2xlYXIoKTtcbiAgICAgICAgZHJhd25Qcm9wZXJ0aWVzLmdldFNvdXJjZSgpLmNsZWFyKCk7XG5cbiAgICAgICAgJChcIi5tb2RhbC1kaWFsb2dcIikuYWRkQ2xhc3MoXCJ2aXN1YWxseWhpZGRlblwiKTtcbiAgICAgICAgbWFwLm9uKFwiY2xpY2tcIiwgY2xpY2tJbmZvKTtcbiAgICAgIH0pO1xuICAgICAgJChcIiNpbnNlcnRcIikub24oXCJjbGlja1wiLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB2YXIgZGF0YSwgYztcbiAgICAgICAgZGF0YSA9IGhhbmRsZUZvcm0uZ2V0KCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICBpZiAoZGF0YSAhPT0gbnVsbCkge1xuICAgICAgICAgIGhhbmRsZUNvb3Jkcy5zZXRMYXllcihcImRyYXduUHJvcGVydGllc1wiKTtcbiAgICAgICAgICBjID0gaGFuZGxlQ29vcmRzLmNvb3JkcygpO1xuICAgICAgICAgIGRhdGEueCA9IGNbMF07XG4gICAgICAgICAgZGF0YS55ID0gY1sxXTtcbiAgICAgICAgICBkYXRhLmFkbWluSWQgPSBpZDtcbiAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiBcImh0dHA6Ly8xMjcuMC4wLjE6MzAwMC9kYi9pbnNlcnRcIixcbiAgICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxuICAgICAgICAgICAgZGF0YTogZGF0YVxuICAgICAgICAgIH0pLmRvbmUoZnVuY3Rpb24oZGF0YSwgdGV4dFN0YXR1cywganFYSFIpIHtcbiAgICAgICAgICAgIHRvYXN0ci5vcHRpb25zID0ge1xuICAgICAgICAgICAgICBcInBvc2l0aW9uQ2xhc3NcIjogXCJ0b2FzdC1ib3R0b20tZnVsbC13aWR0aFwiLFxuICAgICAgICAgICAgICBcInByZXZlbnREdXBsaWNhdGVzXCI6IHRydWUsXG4gICAgICAgICAgICAgIFwidGltZU91dFwiOiAzMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChqcVhIUi5zdGF0dXMgPT09IDIwMSkge1xuICAgICAgICAgICAgICB0b2FzdHIuc3VjY2VzcyhcIlByb3BlcnR5IFJlY29yZGVkIEluIERhdGFiYXNlXCIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdG9hc3RyLmVycm9yKFwiT29wcyBTb21ldGhpbmcgV2VudCBXcm9uZyEhIVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikge1xuICAgICAgICAgICAgdG9hc3RyLmVycm9yKFwiT29wcyBTb21ldGhpbmcgV2VudCBXcm9uZyEhIVwiKTtcbiAgICAgICAgICB9KS5hbHdheXMoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZHJhd25Qcm9wZXJ0aWVzLmdldFNvdXJjZSgpLmNsZWFyKCk7XG4gICAgICAgICAgICBwcm9wZXJ0eVNvdXJjZS5jbGVhcigpO1xuICAgICAgICAgICAgaGFuZGxlRm9ybS5jbGVhcigpO1xuICAgICAgICAgICAgJChcIi5tb2RhbC1kaWFsb2dcIikuYWRkQ2xhc3MoXCJ2aXN1YWxseWhpZGRlblwiKTtcbiAgICAgICAgICAgIG1hcC5vbihcImNsaWNrXCIsIGNsaWNrSW5mbyk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuLy89PT09PT0gZGVsZXRlID09PT09PVxuJChcIiNkZWxldGVQcm9wZXJ0eVwiKS5jbGljayhmdW5jdGlvbihldmVudCkge1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAkKFwiLnByb3BlcnR5LWluZm9cIikuYWRkQ2xhc3MoXCJ2aXN1YWxseWhpZGRlblwiKTtcbiAgdG9hc3RyLm9wdGlvbnMgPSB7XG4gICAgXCJwb3NpdGlvbkNsYXNzXCI6IFwidG9hc3QtdG9wLWNlbnRlclwiLFxuICAgIFwicHJldmVudER1cGxpY2F0ZXNcIjogdHJ1ZSxcbiAgICBcInRpbWVPdXRcIjogMjBcbiAgfTtcbiAgdG9hc3RyLmluZm8oXCJEZWxldGUgUHJvcGVydHlcIik7XG4gIG1hcC51bihcImNsaWNrXCIsIGNsaWNrSW5mbyk7XG4gIGRyYXcuc2V0QWN0aXZlKGZhbHNlKTtcbiAgZmVhdHVyZXMuY2xlYXIoKTtcbiAgc2VsZWN0LnNldEFjdGl2ZSh0cnVlKTtcbiAgc2VsZWN0Lm9uKFwic2VsZWN0XCIsIGZ1bmN0aW9uKGUpIHtcbiAgICBpZiAoZS50YXJnZXQuZ2V0RmVhdHVyZXMoKS5nZXRMZW5ndGgoKSA9PT0gMSkge1xuICAgICAgdG9hc3RyLm9wdGlvbnMubmV3ZXN0T25Ub3AgPSB0cnVlO1xuICAgICAgdG9hc3RyLm9wdGlvbnMucHJldmVudER1cGxpY2F0ZXMgPSB0cnVlO1xuICAgICAgdG9hc3RyLm9wdGlvbnMuZXh0ZW5kZWRUaW1lT3V0ID0gMDtcbiAgICAgIHRvYXN0ci5vcHRpb25zLnRpbWVPdXQgPSAwO1xuICAgICAgdG9hc3RyLm9wdGlvbnMuY2xvc2VCdXR0b24gPSB0cnVlO1xuICAgICAgdmFyICR0b2FzdCA9IHRvYXN0ci53YXJuaW5nKFwiPHA+QXJlIHlvdSBzdXJlPzwvcD48ZGl2IGNsYXNzPVxcXCJ0b2FzdHItYnRuc1xcXCI+PGJ1dHRvbiBpZD1cXFwieWVzRGVsZXRlXFxcIiBjbGFzcz1cXFwibWRsLWJ1dHRvbiBtZGwtanMtYnV0dG9uIFxcXCI+WWVzPC9idXR0b24+PGJ1dHRvbiBpZD1cXFwibm9EZWxldGVcXFwiIGNsYXNzPVxcXCJtZGwtYnV0dG9uIG1kbC1qcy1idXR0b25cXFwiPk5vPC9idXR0b24+PC9kaXY+XCIpO1xuICAgICAgJHRvYXN0Lm9uKFwiY2xpY2tcIiwgXCIjeWVzRGVsZXRlXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgZ2lkO1xuICAgICAgICBnaWQgPSBzZWxlY3QuZ2V0RmVhdHVyZXMoKS5pdGVtKDApLmdldChcImdpZFwiKTtcbiAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICB1cmw6IFwiaHR0cDovLzEyNy4wLjAuMTozMDAwL2RiL2RlbGV0ZVwiLFxuICAgICAgICAgIHR5cGU6IFwiUE9TVFwiLFxuICAgICAgICAgIGRhdGFUeXBlOiBcInRleHRcIixcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBnaWQ6IGdpZFxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhLCB0ZXh0U3RhdHVzLCBqcVhIUikge1xuXG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhqcVhIUi5zdGF0dXMpO1xuICAgICAgICAgICAgdG9hc3RyLm9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgIFwicG9zaXRpb25DbGFzc1wiOiBcInRvYXN0LWJvdHRvbS1mdWxsLXdpZHRoXCIsXG4gICAgICAgICAgICAgIFwicHJldmVudER1cGxpY2F0ZXNcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgXCJ0aW1lT3V0XCI6IDMwXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoXCJQcm9wZXJ0eSBEZWxldGVkIEZyb20gRGF0YWJhc2VcIik7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZmFpbChmdW5jdGlvbihqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pIHtcbiAgICAgICAgICAgIHRvYXN0ci5vcHRpb25zID0ge1xuICAgICAgICAgICAgICBcInBvc2l0aW9uQ2xhc3NcIjogXCJ0b2FzdC1ib3R0b20tZnVsbC13aWR0aFwiLFxuICAgICAgICAgICAgICBcInByZXZlbnREdXBsaWNhdGVzXCI6IHRydWUsXG4gICAgICAgICAgICAgIFwidGltZU91dFwiOiAzMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKFwiT29wcyBTb21ldGhpbmcgV2VudCBXcm9uZyEhIVwiKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5hbHdheXMoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eVNvdXJjZS5jbGVhcigpO1xuICAgICAgICAgICAgc2VsZWN0LmdldEZlYXR1cmVzKCkuY2xlYXIoKTtcbiAgICAgICAgICAgIHNlbGVjdC5zZXRBY3RpdmUoZmFsc2UpO1xuICAgICAgICAgICAgbWFwLm9uKFwiY2xpY2tcIiwgY2xpY2tJbmZvKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAkdG9hc3QucmVtb3ZlKCk7XG4gICAgICB9KTtcbiAgICAgICR0b2FzdC5vbihcImNsaWNrXCIsIFwiI25vRGVsZXRlXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgICAkdG9hc3QucmVtb3ZlKCk7XG4gICAgICAgIHNlbGVjdC5nZXRGZWF0dXJlcygpLmNsZWFyKCk7XG4gICAgICAgIHNlbGVjdC5zZXRBY3RpdmUoZmFsc2UpO1xuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbn0pO1xuJChcIiNsb2dvdXRcIikuY2xpY2soZnVuY3Rpb24oKSB7XG4gIGxvY2F0aW9uLmhyZWYgPSBcIi9tYXAvbG9nb3V0XCI7XG59KTtcblxuIiwidmFyIGhhbmRsZUNvb3JkcyA9IChmdW5jdGlvbiAob2wpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG4gIHZhciBjb29yZHM7XG4gIHZhciBsO1xuXG4gIGZ1bmN0aW9uIGZpbmRCeUlkKGlkKSB7XG4gICAgdmFyIGxheWVycyA9IG1hcC5nZXRMYXllcnMoKTtcbiAgICB2YXIgbGVuZ3RoID0gbGF5ZXJzLmdldExlbmd0aCgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChpZCA9PT0gbGF5ZXJzLml0ZW0oaSkuZ2V0KFwiaWRcIikpIHtcbiAgICAgICAgcmV0dXJuIGxheWVycy5pdGVtKGkpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGZ1bmN0aW9uIGZpbmRCeU5hbWUobmFtZSkge1xuICAgIHZhciBsYXllcnMgPSBtYXAuZ2V0TGF5ZXJzKCk7XG4gICAgdmFyIGxlbmd0aCA9IGxheWVycy5nZXRMZW5ndGgoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAobmFtZSA9PT0gbGF5ZXJzLml0ZW0oaSkuZ2V0KFwibmFtZUVuXCIpIHx8IG5hbWUgPT09IGxheWVycy5pdGVtKGkpLmdldChcIm5hbWVFbFwiKSkge1xuICAgICAgICByZXR1cm4gbGF5ZXJzLml0ZW0oaSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgZnVuY3Rpb24gc2V0TGF5ZXIoaWQpIHtcbiAgICBsID0gZmluZEJ5SWQoaWQpO1xuICB9XG5cbiAgZnVuY3Rpb24gZ2V0Q29vcmRzKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgdmFyIGNvb3JkRVBTRzM4NTc7XHJcbiAgICBjb29yZEVQU0czODU3ID0gbC5nZXRTb3VyY2UoKS5nZXRGZWF0dXJlcygpWzBdLmdldEdlb21ldHJ5KCkuZ2V0Q29vcmRpbmF0ZXMoKTtcclxuICAgIGNvb3JkcyA9IG9sLnByb2oudHJhbnNmb3JtKGNvb3JkRVBTRzM4NTcsIFwiRVBTRzozODU3XCIsIFwiRVBTRzo0MzI2XCIpO1xyXG4gICAgcmV0dXJuIGNvb3JkcztcbiAgfVxuICByZXR1cm4ge1xuICAgIGNvb3JkczogZ2V0Q29vcmRzLFxuICAgIHNldExheWVyOiBzZXRMYXllclxuICB9O1xufShvbCkpO1xuIiwidmFyIGhhbmRsZUZvcm0gPSAoZnVuY3Rpb24oJCwgcGFyc2xleSkge1xyXG4gIFwidXNlIHN0cmljdFwiO1xyXG4gIHZhciBmb3JtTmFtZSwgc3VibWl0QnRuSWQsIHA7XHJcblxyXG4gIGZ1bmN0aW9uIHNldE9wdGlvbnMob3B0aW9ucykge1xyXG4gICAgZm9ybU5hbWUgPSBvcHRpb25zLm5hbWU7XHJcbiAgICBzdWJtaXRCdG5JZCA9IG9wdGlvbnMuc3VibWl0QnRuSWQ7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBkaXNhYmxlU3VibWl0QnRuKCkge1xyXG4gICAgJChcIiNcIiArIHN1Ym1pdEJ0bklkICsgXCJcIikucHJvcChcImRpc2FibGVkXCIsIHRydWUpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY3JlYXRlVmFsaWRhdG9yKCkge1xyXG4gICAgcCA9ICQoXCJmb3JtW25hbWU9XFxcIlwiICsgZm9ybU5hbWUgKyBcIlxcXCJcIikucGFyc2xleSgpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBkZXN0cm95VmFsaWRhdG9yKCkge1xyXG4gICAgcC5kZXN0cm95KCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiB2YWxpZGF0ZUZvcm0oKSB7XHJcbiAgICByZXR1cm4gcC52YWxpZGF0ZSgpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gb25WYWxpZGF0ZUZvcm1TdWNjZXNzKCkge1xyXG4gICAgcC5vbihcImZvcm06c3VjY2Vzc1wiLCBmdW5jdGlvbigpIHt9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGdldEF0dHJpYnV0ZXMoKSB7XHJcbiAgICB2YXIgb2JqID0ge307XHJcbiAgICBjcmVhdGVWYWxpZGF0b3IoKTtcclxuICAgIGlmICh2YWxpZGF0ZUZvcm0oKSA9PT0gdHJ1ZSkge1xyXG4gICAgICAkKFwiZm9ybVtuYW1lPVxcXCJcIiArIGZvcm1OYW1lICsgXCJcXFwiXCIpLmZpbmQoXCIubWRsLXRleHRmaWVsZF9faW5wdXRcIikuZWFjaChmdW5jdGlvbihpbmRleCwgZWxlbWVudCkge1xyXG4gICAgICAgIG9ialskKHRoaXMpLmF0dHIoXCJpZFwiKV0gPSAkKHRoaXMpLnZhbCgpO1xyXG4gICAgICB9KTtcclxuICAgICAgJChcImZvcm1bbmFtZT1cXFwiXCIgKyBmb3JtTmFtZSArIFwiXFxcIlwiKS5maW5kKFwiLm1kbC1jaGVja2JveF9faW5wdXRcIikuZWFjaChmdW5jdGlvbihpbmRleCwgZWxlbWVudCkge1xyXG4gICAgICAgIG9ialskKHRoaXMpLmF0dHIoXCJpZFwiKV0gPSAkKHRoaXMpLnByb3AoXCJjaGVja2VkXCIpO1xyXG4gICAgICB9KTtcclxuICAgICAgcmV0dXJuIG9iajtcclxuICAgIH1cclxuICAgIGVsc2UgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiByZXNldEZvcm0oKSB7XHJcbiAgICBpZiAoY3JlYXRlVmFsaWRhdG9yKCkgPT0gdHJ1ZSkge1xyXG4gICAgICBkZXN0cm95VmFsaWRhdG9yKCk7XHJcbiAgICB9XHJcbiAgICAkKFwiZm9ybVtuYW1lPVxcXCJcIiArIGZvcm1OYW1lICsgXCJcXFwiXCIpLmZpbmQoXCIubWRsLXRleHRmaWVsZF9faW5wdXRcIikuZWFjaChmdW5jdGlvbihpbmRleCwgZWxlbWVudCkge1xyXG4gICAgICAkKHRoaXMpLnZhbChcIlwiKTtcclxuICAgICAgJCh0aGlzKS5wYXJlbnQoKS5lcSgwKS5yZW1vdmVDbGFzcyhcImlzLWRpcnR5XCIpO1xyXG4gICAgICAkKHRoaXMpLnBhcmVudCgpLmVxKDApLnJlbW92ZUNsYXNzKFwiaXMtaW52YWxpZFwiKTtcclxuICAgIH0pO1xyXG4gICAgJChcImZvcm1bbmFtZT1cXFwiXCIgKyBmb3JtTmFtZSArIFwiXFxcIlwiKS5maW5kKFwiLm1kbC1jaGVja2JveF9faW5wdXRcIikuZWFjaChmdW5jdGlvbihpbmRleCwgZWxlbWVudCkge1xyXG4gICAgICAkKHRoaXMpLnByb3AoXCJjaGVja2VkXCIsIGZhbHNlKTtcclxuICAgIH0pO1xyXG4gICAgJChcImZvcm1bbmFtZT1cXFwiXCIgKyBmb3JtTmFtZSArIFwiXFxcIlwiKS5maW5kKFwiLm1kbC1jaGVja2JveFwiKS5lYWNoKGZ1bmN0aW9uKGluZGV4LCBlbGVtZW50KSB7XHJcbiAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoXCJpcy1jaGVja2VkXCIpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIHJldHVybiB7XHJcbiAgICBzZXQ6IHNldE9wdGlvbnMsXHJcbiAgICBnZXQ6IGdldEF0dHJpYnV0ZXMsXHJcbiAgICBjbGVhcjogcmVzZXRGb3JtXHJcbiAgLy8gY3JlYXRlVmFsaWRhdG9yOiBjcmVhdGVWYWxpZGF0b3IsXHJcbiAgLy8gZGVzdHJveVZhbGlkYXRvcjogZGVzdHJveVZhbGlkYXRvcixcclxuICAvLyB2YWxpZGF0ZUZvcm06IHZhbGlkYXRlRm9ybSxcclxuICAvLyBvblZhbGlkYXRlRm9ybVN1Y2Nlc3M6IG9uVmFsaWRhdGVGb3JtU3VjY2VzcyxcclxuICAvLyBkaXNhYmxlU3VibWl0QnRuOiBkaXNhYmxlU3VibWl0QnRuXHJcbiAgfTtcclxufShqUXVlcnksIHBhcnNsZXkpKTtcclxuXHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
