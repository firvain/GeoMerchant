function PropertyStyle(){var e;return e="../images/map-icons/pins/48/pin1.png",new ol.style.Style({image:new ol.style.Icon({src:e,anchor:[.5,1],scale:.7})})}function clickInfo(e){e.preventDefault();var t={},o=map.forEachFeatureAtPixel(e.pixel,function(e,t){return{feature:e,layer:t}},this,function(e){return"property"===e.get("id")?!0:void 0},this);console.log(o),o?(t.feature={},o.feature.getKeys().forEach(function(e){t.feature[e]=o.feature.get(e)}),console.log(t),dust.render("adminEstateInfo.dust",t,function(e,t){console.log(t),$(".property-info").html(t),$(".property-info").removeClass("visuallyhidden")})):$(".property-info").addClass("visuallyhidden")}var center=[3677385,4120949],extent=[3590094,4102833,3855483,4261211],lang=document.documentElement.lang,styleCache={},geoJSONFormat=new ol.format.GeoJSON({defaultDataProjection:"EPSG:4326"}),bing=new ol.layer.Tile({visible:!0,source:new ol.source.BingMaps({key:"Ak2Gq8VUfICsPpuf7LRANXmXt2sHWmSLPhohmVLFtFIEwYjs_5MCyAhAFwRSVpLj",imagerySet:"Aerial"}),maxZoom:19,crossOrigin:"anonymous",preload:1/0,id:"bing"}),mapbox=new ol.layer.Tile({source:new ol.source.XYZ({attributions:[new ol.Attribution({html:'<a href="https://www.mapbox.com/about/maps/" target="_blank">&copy; Mapbox &copy; OpenStreetMap</a>'})],url:"https://api.mapbox.com/v4/mapbox.streets/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiZmlydmFpbiIsImEiOiJlOWYyYTM0NThiNWM0YjJjODJjNDE4ODQzNzA2MGQyNiJ9.-NVDO27Hzt-w_nQosUPfLA"}),id:"mapbox"}),propertySource=new ol.source.Vector({format:geoJSONFormat,loader:function(e,t,o){var l="http://localhost:3000/db/admin",r=this;this.clear(),$.ajax({url:l,type:"GET",dataType:"json",data:{id:1}}).done(function(e){var t=geoJSONFormat.readFeatures(e,{featureProjection:"EPSG:3857"});r.addFeatures(t)}).fail(function(){console.log("error")})},strategy:ol.loadingstrategy.all}),property=new ol.layer.Vector({source:propertySource,id:"property",visible:!0,style:PropertyStyle()});property.setZIndex(2);var map=new ol.Map({target:"adminMap",layers:[mapbox,property],loadTilesWhileAnimating:!0,loadTilesWhileInteracting:!0,renderer:"canvas",controls:ol.control.defaults({attributionOptions:{collapsible:!1,collapsed:!1}}).extend([new ol.control.ScaleLine({units:"metric"}),new ol.control.OverviewMap({className:"ol-overviewmap ol-custom-overviewmap",collapsible:!0,collapsed:!0,layers:[bing]}),new ol.control.ZoomToExtent({extent:extent})]),view:new ol.View({center:center,projection:"EPSG:3857",zoom:14,maxZoom:19,minZoom:10})});"el"===lang?(bing.set("name","Δορυφορική εικόνα"),mapbox.set("name","Χάρτης"),property.set("name","Ακίνητα")):(bing.set("name","Sattelite Image"),mapbox.set("name","Map"),property.set("name","Properties"));var features=new ol.Collection,drawnProperties=new ol.layer.Vector({source:new ol.source.Vector,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})}),id:"drawnProperties"});map.addLayer(drawnProperties);var draw=new ol.interaction.Draw({source:drawnProperties.getSource(),type:"Point",style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})})});map.addInteraction(draw),draw.setActive(!1);var select=new ol.interaction.Select({layers:[property],features:features,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 0, 0, 0.2)"}),stroke:new ol.style.Stroke({color:"#FF00003",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#FF0000"})})})});map.addInteraction(select),select.setActive(!1);var translate=new ol.interaction.Translate({features:select.getFeatures()});map.on("click",clickInfo),$("#insertProperty").click(function(){$(".property-info").addClass("visuallyhidden"),toastr.options={positionClass:"toast-top-center"},toastr.info("Add New Property"),map.un("click",clickInfo),select.setActive(!1),draw.setActive(!0),draw.on("drawend",function(e){draw.setActive(!1)})}),$("#deleteProperty").click(function(e){$(".property-info").addClass("visuallyhidden"),toastr.options={positionClass:"toast-top-center"},toastr.info("Delete Property"),map.un("click",clickInfo),draw.setActive(!1),features.clear(),select.setActive(!0),select.on("select",function(e){if(1===e.target.getFeatures().getLength()){toastr.options.newestOnTop=!0,toastr.options.preventDuplicates=!0,toastr.options.extendedTimeOut=0,toastr.options.timeOut=0,toastr.options.closeButton=!0;var t=toastr.warning('<p>Are you sure?</p><div class="toastr-btns"><button id="yesDelete" class="mdl-button mdl-js-button ">Yes</button><button id="noDelete" class="mdl-button mdl-js-button">No</button></div>');t.find("#yesDelete").length&&t.on("click","#yesDelete",function(){alert("you clicked ok"),t.remove()}),t.find("#noDelete").length&&t.on("click","#noDelete",function(){alert("Surprise! you clicked me.")})}})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkbWluLmpzIl0sIm5hbWVzIjpbIlByb3BlcnR5U3R5bGUiLCJzcmMiLCJvbCIsInN0eWxlIiwiU3R5bGUiLCJpbWFnZSIsIkljb24iLCJhbmNob3IiLCJzY2FsZSIsImNsaWNrSW5mbyIsImV2dCIsInByZXZlbnREZWZhdWx0Iiwib2JqIiwiY2xpY2tlZEZlYXR1cmUiLCJtYXAiLCJmb3JFYWNoRmVhdHVyZUF0UGl4ZWwiLCJwaXhlbCIsImZlYXR1cmUiLCJsYXllciIsInRoaXMiLCJnZXQiLCJjb25zb2xlIiwibG9nIiwiZ2V0S2V5cyIsImZvckVhY2giLCJrZXkiLCJkdXN0IiwicmVuZGVyIiwiZXJyIiwib3V0IiwiJCIsImh0bWwiLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwiY2VudGVyIiwiZXh0ZW50IiwibGFuZyIsImRvY3VtZW50IiwiZG9jdW1lbnRFbGVtZW50Iiwic3R5bGVDYWNoZSIsImdlb0pTT05Gb3JtYXQiLCJmb3JtYXQiLCJHZW9KU09OIiwiZGVmYXVsdERhdGFQcm9qZWN0aW9uIiwiYmluZyIsIlRpbGUiLCJ2aXNpYmxlIiwic291cmNlIiwiQmluZ01hcHMiLCJpbWFnZXJ5U2V0IiwibWF4Wm9vbSIsImNyb3NzT3JpZ2luIiwicHJlbG9hZCIsIkluZmluaXR5IiwiaWQiLCJtYXBib3giLCJYWVoiLCJhdHRyaWJ1dGlvbnMiLCJBdHRyaWJ1dGlvbiIsInVybCIsInByb3BlcnR5U291cmNlIiwiVmVjdG9yIiwibG9hZGVyIiwicmVzb2x1dGlvbiIsInByb2plY3Rpb24iLCJ0aGF0IiwiY2xlYXIiLCJhamF4IiwidHlwZSIsImRhdGFUeXBlIiwiZGF0YSIsImRvbmUiLCJyZXNwb25zZSIsImZlYXR1cmVzIiwicmVhZEZlYXR1cmVzIiwiZmVhdHVyZVByb2plY3Rpb24iLCJhZGRGZWF0dXJlcyIsImZhaWwiLCJzdHJhdGVneSIsImxvYWRpbmdzdHJhdGVneSIsImFsbCIsInByb3BlcnR5Iiwic2V0WkluZGV4IiwiTWFwIiwidGFyZ2V0IiwibGF5ZXJzIiwibG9hZFRpbGVzV2hpbGVBbmltYXRpbmciLCJsb2FkVGlsZXNXaGlsZUludGVyYWN0aW5nIiwicmVuZGVyZXIiLCJjb250cm9scyIsImNvbnRyb2wiLCJkZWZhdWx0cyIsImF0dHJpYnV0aW9uT3B0aW9ucyIsImNvbGxhcHNpYmxlIiwiY29sbGFwc2VkIiwiZXh0ZW5kIiwiU2NhbGVMaW5lIiwidW5pdHMiLCJPdmVydmlld01hcCIsImNsYXNzTmFtZSIsIlpvb21Ub0V4dGVudCIsInZpZXciLCJWaWV3Iiwiem9vbSIsIm1pblpvb20iLCJzZXQiLCJDb2xsZWN0aW9uIiwiZHJhd25Qcm9wZXJ0aWVzIiwiZmlsbCIsIkZpbGwiLCJjb2xvciIsInN0cm9rZSIsIlN0cm9rZSIsIndpZHRoIiwiQ2lyY2xlIiwicmFkaXVzIiwiYWRkTGF5ZXIiLCJkcmF3IiwiaW50ZXJhY3Rpb24iLCJEcmF3IiwiZ2V0U291cmNlIiwiYWRkSW50ZXJhY3Rpb24iLCJzZXRBY3RpdmUiLCJzZWxlY3QiLCJTZWxlY3QiLCJ0cmFuc2xhdGUiLCJUcmFuc2xhdGUiLCJnZXRGZWF0dXJlcyIsIm9uIiwiY2xpY2siLCJ0b2FzdHIiLCJvcHRpb25zIiwicG9zaXRpb25DbGFzcyIsImluZm8iLCJ1biIsImV2ZW50IiwiZSIsImdldExlbmd0aCIsIm5ld2VzdE9uVG9wIiwicHJldmVudER1cGxpY2F0ZXMiLCJleHRlbmRlZFRpbWVPdXQiLCJ0aW1lT3V0IiwiY2xvc2VCdXR0b24iLCIkdG9hc3QiLCJ3YXJuaW5nIiwiZmluZCIsImxlbmd0aCIsImFsZXJ0IiwicmVtb3ZlIl0sIm1hcHBpbmdzIjoiQUE4QkEsUUFBQUEsaUJBQ0EsR0FBQUMsRUFFQSxPQURBQSxHQUFBLHVDQUNBLEdBQUFDLElBQUFDLE1BQUFDLE9BQ0FDLE1BQUEsR0FBQUgsSUFBQUMsTUFBQUcsTUFDQUwsSUFBQUEsRUFDQU0sUUFBQSxHQUFBLEdBQ0FDLE1BQUEsT0F5SkEsUUFBQUMsV0FBQUMsR0FDQUEsRUFBQUMsZ0JBQ0EsSUFBQUMsTUFDQUMs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NSwgNDEyMDk0OV0sXHJcbiAgIGV4dGVudCA9IFszNTkwMDk0LCA0MTAyODMzLCAzODU1NDgzLCA0MjYxMjExXSxcclxuICAgbGFuZyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5sYW5nLFxyXG4gICBzdHlsZUNhY2hlID0ge30sXHJcbiAgIGdlb0pTT05Gb3JtYXQgPSBuZXcgb2wuZm9ybWF0Lkdlb0pTT04oe1xyXG4gICAgIGRlZmF1bHREYXRhUHJvamVjdGlvbjogJ0VQU0c6NDMyNidcclxuICAgfSk7XHJcbiB2YXIgYmluZyA9IG5ldyBvbC5sYXllci5UaWxlKHtcclxuICAgdmlzaWJsZTogdHJ1ZSxcclxuICAgc291cmNlOiBuZXcgb2wuc291cmNlLkJpbmdNYXBzKHtcclxuICAgICBrZXk6ICdBazJHcThWVWZJQ3NQcHVmN0xSQU5YbVh0MnNIV21TTFBob2htVkxGdEZJRXdZanNfNU1DeUFoQUZ3UlNWcExqJyxcclxuICAgICBpbWFnZXJ5U2V0OiAnQWVyaWFsJ1xyXG4gICB9KSxcclxuICAgbWF4Wm9vbTogMTksXHJcbiAgIGNyb3NzT3JpZ2luOiAnYW5vbnltb3VzJyxcclxuICAgcHJlbG9hZDogSW5maW5pdHksXHJcbiAgIGlkOiAnYmluZydcclxuIH0pO1xyXG4gdmFyIG1hcGJveCA9IG5ldyBvbC5sYXllci5UaWxlKHtcclxuICAgc291cmNlOiBuZXcgb2wuc291cmNlLlhZWih7XHJcbiAgICAgYXR0cmlidXRpb25zOiBbbmV3IG9sLkF0dHJpYnV0aW9uKHtcclxuICAgICAgIGh0bWw6ICc8YSBocmVmPVxcXCJodHRwczovL3d3dy5tYXBib3guY29tL2Fib3V0L21hcHMvXFxcIiB0YXJnZXQ9XFxcIl9ibGFua1xcXCI+JmNvcHk7IE1hcGJveCAmY29weTsgT3BlblN0cmVldE1hcDwvYT4nXHJcbiAgICAgfSldLFxyXG4gICAgIHVybDogJ2h0dHBzOi8vYXBpLm1hcGJveC5jb20vdjQvbWFwYm94LnN0cmVldHMve3p9L3t4fS97eX0ucG5nP2FjY2Vzc190b2tlbj1way5leUoxSWpvaVptbHlkbUZwYmlJc0ltRWlPaUpsT1dZeVlUTTBOVGhpTldNMFlqSmpPREpqTkRFNE9EUXpOekEyTUdReU5pSjkuLU5WRE8yN0h6dC13X25Rb3NVUGZMQSdcclxuICAgfSksXHJcbiAgIGlkOiAnbWFwYm94J1xyXG4gfSk7XHJcblxyXG5cclxuXHJcbiBmdW5jdGlvbiBQcm9wZXJ0eVN0eWxlKCkge1xyXG4gICB2YXIgc3JjO1xyXG4gICBzcmMgPSAnLi4vaW1hZ2VzL21hcC1pY29ucy9waW5zLzQ4L3BpbjEucG5nJztcclxuICAgcmV0dXJuIG5ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICAgaW1hZ2U6IG5ldyBvbC5zdHlsZS5JY29uKCh7XHJcbiAgICAgICBzcmM6IHNyYyxcclxuICAgICAgIGFuY2hvcjogWzAuNSwgMV0sXHJcbiAgICAgICBzY2FsZTogMC43LFxyXG4gICAgIH0pKVxyXG4gICB9KTtcclxuIH1cclxuIHZhciBwcm9wZXJ0eVNvdXJjZSA9IG5ldyBvbC5zb3VyY2UuVmVjdG9yKHtcclxuICAgZm9ybWF0OiBnZW9KU09ORm9ybWF0LFxyXG4gICBsb2FkZXI6IGZ1bmN0aW9uKGV4dGVudCwgcmVzb2x1dGlvbiwgcHJvamVjdGlvbikge1xyXG4gICAgIHZhciB1cmwgPSAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2RiL2FkbWluJztcclxuICAgICB2YXIgdGhhdCA9IHRoaXM7XHJcbiAgICAgdGhpcy5jbGVhcigpO1xyXG4gICAgICQuYWpheCh7XHJcbiAgICAgICB1cmw6IHVybCxcclxuICAgICAgIHR5cGU6ICdHRVQnLFxyXG4gICAgICAgZGF0YVR5cGU6ICdqc29uJyxcclxuICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgaWQ6IDFcclxuICAgICAgIH0sXHJcbiAgICAgfSkuZG9uZShmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgdmFyIGZlYXR1cmVzID0gZ2VvSlNPTkZvcm1hdC5yZWFkRmVhdHVyZXMocmVzcG9uc2UsIHtcclxuICAgICAgICAgZmVhdHVyZVByb2plY3Rpb246ICdFUFNHOjM4NTcnXHJcbiAgICAgICB9KTtcclxuICAgICAgIHRoYXQuYWRkRmVhdHVyZXMoZmVhdHVyZXMpO1xyXG4gICAgIH0pLmZhaWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICBjb25zb2xlLmxvZyhcImVycm9yXCIpO1xyXG4gICAgIH0pO1xyXG4gICB9LFxyXG4gICBzdHJhdGVneTogb2wubG9hZGluZ3N0cmF0ZWd5LmFsbFxyXG4gfSk7XHJcbiB2YXIgcHJvcGVydHkgPSBuZXcgb2wubGF5ZXIuVmVjdG9yKHtcclxuICAgc291cmNlOiBwcm9wZXJ0eVNvdXJjZSxcclxuICAgaWQ6ICdwcm9wZXJ0eScsXHJcbiAgIHZpc2libGU6IHRydWUsXHJcbiAgIHN0eWxlOiBQcm9wZXJ0eVN0eWxlKClcclxuIH0pO1xyXG4gcHJvcGVydHkuc2V0WkluZGV4KDIpO1xyXG4gdmFyIG1hcCA9IG5ldyBvbC5NYXAoe1xyXG4gICB0YXJnZXQ6ICdhZG1pbk1hcCcsXHJcbiAgIGxheWVyczogW21hcGJveCwgcHJvcGVydHldLFxyXG4gICBsb2FkVGlsZXNXaGlsZUFuaW1hdGluZzogdHJ1ZSxcclxuICAgbG9hZFRpbGVzV2hpbGVJbnRlcmFjdGluZzogdHJ1ZSxcclxuICAgcmVuZGVyZXI6ICdjYW52YXMnLFxyXG4gICBjb250cm9sczogb2wuY29udHJvbC5kZWZhdWx0cyh7XHJcbiAgICAgYXR0cmlidXRpb25PcHRpb25zOiB7XHJcbiAgICAgICBjb2xsYXBzaWJsZTogZmFsc2UsXHJcbiAgICAgICBjb2xsYXBzZWQ6IGZhbHNlXHJcbiAgICAgfVxyXG4gICB9KS5leHRlbmQoW1xyXG4gICAgIG5ldyBvbC5jb250cm9sLlNjYWxlTGluZSh7XHJcbiAgICAgICB1bml0czogJ21ldHJpYydcclxuICAgICB9KSwgbmV3IG9sLmNvbnRyb2wuT3ZlcnZpZXdNYXAoe1xyXG4gICAgICAgY2xhc3NOYW1lOiAnb2wtb3ZlcnZpZXdtYXAgb2wtY3VzdG9tLW92ZXJ2aWV3bWFwJyxcclxuICAgICAgIGNvbGxhcHNpYmxlOiB0cnVlLFxyXG4gICAgICAgY29sbGFwc2VkOiB0cnVlLFxyXG4gICAgICAgbGF5ZXJzOiBbYmluZ11cclxuICAgICB9KSxcclxuICAgICBuZXcgb2wuY29udHJvbC5ab29tVG9FeHRlbnQoe1xyXG4gICAgICAgZXh0ZW50OiBleHRlbnRcclxuICAgICB9KVxyXG4gICBdKSxcclxuICAgdmlldzogbmV3IG9sLlZpZXcoe1xyXG4gICAgIGNlbnRlcjogY2VudGVyLFxyXG4gICAgIC8vIGV4dGVudDogZXh0ZW50LFxyXG4gICAgIHByb2plY3Rpb246ICdFUFNHOjM4NTcnLFxyXG4gICAgIHpvb206IDE0LFxyXG4gICAgIG1heFpvb206IDE5LFxyXG4gICAgIG1pblpvb206IDEwXHJcbiAgIH0pLFxyXG4gfSk7XHJcbiBpZiAobGFuZyA9PT0gJ2VsJykge1xyXG4gICBiaW5nLnNldCgnbmFtZScsICfOlM6/z4HPhc+Gzr/Pgc65zrrOriDOtc65zrrPjM69zrEnKTtcclxuICAgbWFwYm94LnNldCgnbmFtZScsICfOp86sz4HPhM63z4InKTtcclxuICAgcHJvcGVydHkuc2V0KCduYW1lJywgJ86RzrrOr869zrfPhM6xJyk7XHJcbiB9IGVsc2Uge1xyXG4gICBiaW5nLnNldCgnbmFtZScsICdTYXR0ZWxpdGUgSW1hZ2UnKTtcclxuICAgbWFwYm94LnNldCgnbmFtZScsICdNYXAnKTtcclxuICAgcHJvcGVydHkuc2V0KCduYW1lJywgJ1Byb3BlcnRpZXMnKTtcclxuIH1cclxuIC8vPT09PT09IGludGVyYWN0aW9ucyA9PT09PT1cclxuIHZhciBmZWF0dXJlcyA9IG5ldyBvbC5Db2xsZWN0aW9uKCk7XHJcbiB2YXIgZHJhd25Qcm9wZXJ0aWVzID0gbmV3IG9sLmxheWVyLlZlY3Rvcih7XHJcbiAgIHNvdXJjZTogbmV3IG9sLnNvdXJjZS5WZWN0b3IoKSxcclxuICAgc3R5bGU6IG5ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xyXG4gICAgICAgY29sb3I6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMiknXHJcbiAgICAgfSksXHJcbiAgICAgc3Ryb2tlOiBuZXcgb2wuc3R5bGUuU3Ryb2tlKHtcclxuICAgICAgIGNvbG9yOiAnI2ZmY2MzMycsXHJcbiAgICAgICB3aWR0aDogMlxyXG4gICAgIH0pLFxyXG4gICAgIGltYWdlOiBuZXcgb2wuc3R5bGUuQ2lyY2xlKHtcclxuICAgICAgIHJhZGl1czogNyxcclxuICAgICAgIGZpbGw6IG5ldyBvbC5zdHlsZS5GaWxsKHtcclxuICAgICAgICAgY29sb3I6ICcjZmZjYzMzJ1xyXG4gICAgICAgfSlcclxuICAgICB9KVxyXG4gICB9KSxcclxuICAgaWQ6ICdkcmF3blByb3BlcnRpZXMnXHJcbiB9KTtcclxuIG1hcC5hZGRMYXllcihkcmF3blByb3BlcnRpZXMpO1xyXG4gLy9kcmF3XHJcbiB2YXIgZHJhdyA9IG5ldyBvbC5pbnRlcmFjdGlvbi5EcmF3KHtcclxuICAgLy8gZmVhdHVyZXM6IGZlYXR1cmVzLFxyXG4gICBzb3VyY2U6IGRyYXduUHJvcGVydGllcy5nZXRTb3VyY2UoKSxcclxuICAgdHlwZTogJ1BvaW50JyxcclxuICAgc3R5bGU6IG5ldyBvbC5zdHlsZS5TdHlsZSh7XHJcbiAgICAgZmlsbDogbmV3IG9sLnN0eWxlLkZpbGwoe1xyXG4gICAgICAgY29sb3I6ICdyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuMiknXHJcbiAgICAgfSksXHJcbiAgICAgc3Ryb2tlOiBuZXcgb2wuc3R5bGUuU3Ryb2tlKHtcclxuICAgICAgIGNvbG9yOiAnI2ZmY2MzMycsXHJcbiAgICAgICB3aWR0aDogMlxyXG4gICAgIH0pLFxyXG4gICAgIGltYWdlOiBuZXcgb2wuc3R5bGUuQ2lyY2xlKHtcclxuICAgICAgIHJhZGl1czogNyxcclxuICAgICAgIGZpbGw6IG5ldyBvbC5zdHlsZS5GaWxsKHtcclxuICAgICAgICAgY29sb3I6ICcjZmZjYzMzJ1xyXG4gICAgICAgfSlcclxuICAgICB9KVxyXG4gICB9KVxyXG4gfSk7XHJcbiBtYXAuYWRkSW50ZXJhY3Rpb24oZHJhdyk7XHJcbiBkcmF3LnNldEFjdGl2ZShmYWxzZSk7XHJcbiAvL3NlbGVjdFxyXG4gdmFyIHNlbGVjdCA9IG5ldyBvbC5pbnRlcmFjdGlvbi5TZWxlY3Qoe1xyXG4gICBsYXllcnM6IFtcclxuICAgICBwcm9wZXJ0eVxyXG4gICBdLFxyXG4gICBmZWF0dXJlczogZmVhdHVyZXMsXHJcbiAgIHN0eWxlOiBuZXcgb2wuc3R5bGUuU3R5bGUoe1xyXG4gICAgIGZpbGw6IG5ldyBvbC5zdHlsZS5GaWxsKHtcclxuICAgICAgIGNvbG9yOiAncmdiYSgyNTUsIDAsIDAsIDAuMiknXHJcbiAgICAgfSksXHJcbiAgICAgc3Ryb2tlOiBuZXcgb2wuc3R5bGUuU3Ryb2tlKHtcclxuICAgICAgIGNvbG9yOiAnI0ZGMDAwMDMnLFxyXG4gICAgICAgd2lkdGg6IDJcclxuICAgICB9KSxcclxuICAgICBpbWFnZTogbmV3IG9sLnN0eWxlLkNpcmNsZSh7XHJcbiAgICAgICByYWRpdXM6IDcsXHJcbiAgICAgICBmaWxsOiBuZXcgb2wuc3R5bGUuRmlsbCh7XHJcbiAgICAgICAgIGNvbG9yOiAnI0ZGMDAwMCdcclxuICAgICAgIH0pXHJcbiAgICAgfSlcclxuICAgfSlcclxuIH0pO1xyXG4gbWFwLmFkZEludGVyYWN0aW9uKHNlbGVjdCk7XHJcbiBzZWxlY3Quc2V0QWN0aXZlKGZhbHNlKTtcclxuIC8vdHJhbnNsYXRlKG1vdmUpXHJcbiB2YXIgdHJhbnNsYXRlID0gbmV3IG9sLmludGVyYWN0aW9uLlRyYW5zbGF0ZSh7XHJcbiAgZmVhdHVyZXM6IHNlbGVjdC5nZXRGZWF0dXJlcygpXHJcbn0pO1xyXG4gLy89PT09PT0gaW5mbyA9PT09PT1cclxuIG1hcC5vbignY2xpY2snLCBjbGlja0luZm8pO1xyXG5cclxuIGZ1bmN0aW9uIGNsaWNrSW5mbyhldnQpIHtcclxuICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgIHZhciBvYmogPSB7fTtcclxuICAgdmFyIGNsaWNrZWRGZWF0dXJlID0gbWFwLmZvckVhY2hGZWF0dXJlQXRQaXhlbChldnQucGl4ZWwsIGZ1bmN0aW9uKGZlYXR1cmUsIGxheWVyKSB7XHJcbiAgICAgcmV0dXJuIHtcclxuICAgICAgIGZlYXR1cmU6IGZlYXR1cmUsXHJcbiAgICAgICBsYXllcjogbGF5ZXJcclxuICAgICB9O1xyXG4gICB9LCB0aGlzLCBmdW5jdGlvbihsYXllcikge1xyXG4gICAgIGlmIChsYXllci5nZXQoJ2lkJykgPT09ICdwcm9wZXJ0eScpIHtcclxuICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgIH1cclxuICAgfSwgdGhpcyk7XHJcbiAgIGNvbnNvbGUubG9nKGNsaWNrZWRGZWF0dXJlKTtcclxuICAgaWYgKGNsaWNrZWRGZWF0dXJlKSB7XHJcbiAgICAgb2JqLmZlYXR1cmUgPSB7fTtcclxuICAgICBjbGlja2VkRmVhdHVyZS5mZWF0dXJlLmdldEtleXMoKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xyXG4gICAgICAgb2JqLmZlYXR1cmVba2V5XSA9IGNsaWNrZWRGZWF0dXJlLmZlYXR1cmUuZ2V0KGtleSk7XHJcbiAgICAgfSk7XHJcbiAgICAgY29uc29sZS5sb2cob2JqKTtcclxuICAgICBkdXN0LnJlbmRlcignYWRtaW5Fc3RhdGVJbmZvLmR1c3QnLCBvYmosIGZ1bmN0aW9uKGVyciwgb3V0KSB7XHJcbiAgICAgICBjb25zb2xlLmxvZyhvdXQpO1xyXG4gICAgICAgJCgnLnByb3BlcnR5LWluZm8nKS5odG1sKG91dCk7XHJcbiAgICAgICAkKCcucHJvcGVydHktaW5mbycpLnJlbW92ZUNsYXNzKCd2aXN1YWxseWhpZGRlbicpO1xyXG4gICAgIH0pO1xyXG4gICB9IGVsc2Uge1xyXG4gICAgICQoJy5wcm9wZXJ0eS1pbmZvJykuYWRkQ2xhc3MoJ3Zpc3VhbGx5aGlkZGVuJyk7XHJcbiAgIH1cclxuIH1cclxuIC8vPT09PT09IGluc2VydCA9PT09PT1cclxuICQoJyNpbnNlcnRQcm9wZXJ0eScpLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAkKCcucHJvcGVydHktaW5mbycpLmFkZENsYXNzKCd2aXN1YWxseWhpZGRlbicpO1xyXG4gICB0b2FzdHIub3B0aW9ucyA9IHtcclxuICAgICBcInBvc2l0aW9uQ2xhc3NcIjogXCJ0b2FzdC10b3AtY2VudGVyXCJcclxuICAgfTtcclxuICAgdG9hc3RyLmluZm8oJ0FkZCBOZXcgUHJvcGVydHknKTtcclxuICAgbWFwLnVuKCdjbGljaycsIGNsaWNrSW5mbyk7XHJcbiAgIHNlbGVjdC5zZXRBY3RpdmUoZmFsc2UpO1xyXG4gICBkcmF3LnNldEFjdGl2ZSh0cnVlKTtcclxuICAgZHJhdy5vbignZHJhd2VuZCcsIGZ1bmN0aW9uKGV2dCkge1xyXG4gICAgIGRyYXcuc2V0QWN0aXZlKGZhbHNlKTtcclxuICAgfSk7XHJcbiB9KTtcclxuIC8vPT09PT09IGRlbGV0ZSA9PT09PT1cclxuICQoJyNkZWxldGVQcm9wZXJ0eScpLmNsaWNrKGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICQoJy5wcm9wZXJ0eS1pbmZvJykuYWRkQ2xhc3MoJ3Zpc3VhbGx5aGlkZGVuJyk7XHJcbiAgIHRvYXN0ci5vcHRpb25zID0ge1xyXG4gICAgIFwicG9zaXRpb25DbGFzc1wiOiBcInRvYXN0LXRvcC1jZW50ZXJcIlxyXG4gICB9O1xyXG4gICB0b2FzdHIuaW5mbygnRGVsZXRlIFByb3BlcnR5Jyk7XHJcbiAgIG1hcC51bignY2xpY2snLCBjbGlja0luZm8pO1xyXG4gICBkcmF3LnNldEFjdGl2ZShmYWxzZSk7XHJcbiAgIGZlYXR1cmVzLmNsZWFyKCk7XHJcbiAgIHNlbGVjdC5zZXRBY3RpdmUodHJ1ZSk7XHJcbiAgIHNlbGVjdC5vbignc2VsZWN0JywgZnVuY3Rpb24oZSkge1xyXG4gICAgIGlmIChlLnRhcmdldC5nZXRGZWF0dXJlcygpLmdldExlbmd0aCgpID09PSAxKSB7XHJcbiAgICAgICB0b2FzdHIub3B0aW9ucy5uZXdlc3RPblRvcCA9IHRydWU7XHJcbiAgICAgICB0b2FzdHIub3B0aW9ucy5wcmV2ZW50RHVwbGljYXRlcyA9IHRydWU7XHJcbiAgICAgICB0b2FzdHIub3B0aW9ucy5leHRlbmRlZFRpbWVPdXQgPSAwO1xyXG4gICAgICAgdG9hc3RyLm9wdGlvbnMudGltZU91dCA9IDA7XHJcbiAgICAgICB0b2FzdHIub3B0aW9ucy5jbG9zZUJ1dHRvbiA9IHRydWU7XHJcbiAgICAgICB2YXIgJHRvYXN0ID0gdG9hc3RyLndhcm5pbmcoJzxwPkFyZSB5b3Ugc3VyZT88L3A+PGRpdiBjbGFzcz1cInRvYXN0ci1idG5zXCI+PGJ1dHRvbiBpZD1cInllc0RlbGV0ZVwiIGNsYXNzPVwibWRsLWJ1dHRvbiBtZGwtanMtYnV0dG9uIFwiPlllczwvYnV0dG9uPjxidXR0b24gaWQ9XCJub0RlbGV0ZVwiIGNsYXNzPVwibWRsLWJ1dHRvbiBtZGwtanMtYnV0dG9uXCI+Tm88L2J1dHRvbj48L2Rpdj4nKTtcclxuICAgICAgIGlmICgkdG9hc3QuZmluZCgnI3llc0RlbGV0ZScpLmxlbmd0aCkge1xyXG4gICAgICAgICAkdG9hc3Qub24oICdjbGljaycsJyN5ZXNEZWxldGUnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICBhbGVydCgneW91IGNsaWNrZWQgb2snKTtcclxuICAgICAgICAgICAkdG9hc3QucmVtb3ZlKCk7XHJcbiAgICAgICAgIH0pO1xyXG4gICAgICAgfVxyXG4gICAgICAgaWYgKCR0b2FzdC5maW5kKCcjbm9EZWxldGUnKS5sZW5ndGgpIHtcclxuICAgICAgICAgJHRvYXN0Lm9uKCAnY2xpY2snLCcjbm9EZWxldGUnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICBhbGVydCgnU3VycHJpc2UhIHlvdSBjbGlja2VkIG1lLicpO1xyXG4gICAgICAgICB9KTtcclxuICAgICAgIH1cclxuICAgICB9XHJcbiAgIH0pO1xyXG4gfSk7XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
